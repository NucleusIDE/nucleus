<!DOCTYPE html><html lang="en"><head><title>client/lib/jstree/jstree</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="client/lib/jstree/jstree"><meta name="groc-project-path" content="client/lib/jstree/jstree.js"><meta name="groc-github-url" content="https://github.com/channikhabra/meteor-nucleus"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/channikhabra/meteor-nucleus/blob/master/client/lib/jstree/jstree.js">client/lib/jstree/jstree.js</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>globals jQuery, define, exports, require, window, document </p></div></div><div class="code"><div class="wrapper">(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(factory)</span> {</span>
<span class="hljs-pi">	"use strict"</span>;
	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
		define([<span class="hljs-string">'jquery'</span>], factory);
	}
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> exports === <span class="hljs-string">'object'</span>) {
		factory(<span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>));
	}
	<span class="hljs-keyword">else</span> {
		factory(jQuery);
	}
}(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($, undefined)</span> {</span>
<span class="hljs-pi">	"use strict"</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>!
jsTree 3.0.2
<a href="http://jstree.com/">http://jstree.com/</a></p>
<p>Copyright (c) 2014 Ivan Bozhanov (<a href="http://vakata.com">http://vakata.com</a>)</p>
<p>Licensed same as jquery - under the terms of the MIT License
  <a href="http://www.opensource.org/licenses/mit-license.php">http://www.opensource.org/licenses/mit-license.php</a>
!
if using jslint please allow for the jQuery global and use following options: 
jslint: browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>prevent another load? maybe there is a better way?</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">if</span>($.jstree) {
		<span class="hljs-keyword">return</span>;
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="jstree-core-functionality">jsTree core functionality</h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>internal variables</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">var</span> instance_counter = <span class="hljs-number">0</span>,
		ccp_node = <span class="hljs-literal">false</span>,
		ccp_mode = <span class="hljs-literal">false</span>,
		ccp_inst = <span class="hljs-literal">false</span>,
		themes_loaded = [],
		src = $(<span class="hljs-string">'script:last'</span>).attr(<span class="hljs-string">'src'</span>),
		_d = document, _node = _d.createElement(<span class="hljs-string">'LI'</span>), _temp1, _temp2;

	_node.setAttribute(<span class="hljs-string">'role'</span>, <span class="hljs-string">'treeitem'</span>);
	_temp1 = _d.createElement(<span class="hljs-string">'I'</span>);
	_temp1.className = <span class="hljs-string">'jstree-icon jstree-ocl'</span>;
	_node.appendChild(_temp1);
	_temp1 = _d.createElement(<span class="hljs-string">'A'</span>);
	_temp1.className = <span class="hljs-string">'jstree-anchor'</span>;
	_temp1.setAttribute(<span class="hljs-string">'href'</span>,<span class="hljs-string">'#'</span>);
	_temp2 = _d.createElement(<span class="hljs-string">'I'</span>);
	_temp2.className = <span class="hljs-string">'jstree-icon jstree-themeicon'</span>;
	_temp1.appendChild(_temp2);
	_node.appendChild(_temp1);
	_temp1 = _temp2 = <span class="hljs-literal">null</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree</span></p>
<p>holds all jstree related functions and variables, including the actual class and methods to create, access and manipulate instances.</p></div></div><div class="code"><div class="wrapper">	$.jstree = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.version</span></p>
<p>specifies the jstree version in use</p></div></div><div class="code"><div class="wrapper">		version : <span class="hljs-string">'3.0.2'</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults</span></p>
<p>holds all the default options used when creating new instances</p></div></div><div class="code"><div class="wrapper">		defaults : {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.plugins</span></p>
<p>configure which plugins will be active on an instance. Should be an array of strings, where each element is a plugin name. The default is <code>[]</code></p></div></div><div class="code"><div class="wrapper">			plugins : []
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.plugins</span></p>
<p>stores all loaded jstree plugins (used internally)</p></div></div><div class="code"><div class="wrapper">		plugins : {},
		path : src &amp;&amp; src.indexOf(<span class="hljs-string">'/'</span>) !== -<span class="hljs-number">1</span> ? src.replace(<span class="hljs-regexp">/\/[^\/]+$/</span>,<span class="hljs-string">''</span>) : <span class="hljs-string">''</span>,
		idregex : <span class="hljs-regexp">/[\\:&amp;!^|()\[\]&lt;&gt;@*'+~#";.,=\- \/${}%]/g</span>
	};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.create(el [, options])</span></p>
<p>creates a jstree instance</p>
<p>Parameters:</p>
<ul>
<li><p><strong>el can be a DOMElement, a jQuery, or a String.</strong><br/>(the element to create the instance on, can be jQuery extended or a selector)</p>
</li>
<li><p><strong>options must be an Object.</strong><br/>(options for this instance (extends <code>$.jstree.defaults</code>))</p>
</li>
</ul>
<p><strong>Returns a jsTree</strong><br/>(the new instance)</p></div></div><div class="code"><div class="wrapper">	$.jstree.create = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(el, options)</span> {</span>
		<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">new</span> $.jstree.core(++instance_counter),
			opt = options;
		options = $.extend(<span class="hljs-literal">true</span>, {}, $.jstree.defaults, options);
		<span class="hljs-keyword">if</span>(opt &amp;&amp; opt.plugins) {
			options.plugins = opt.plugins;
		}
		$.each(options.plugins, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, k)</span> {</span>
			<span class="hljs-keyword">if</span>(i !== <span class="hljs-string">'core'</span>) {
				tmp = tmp.plugin(k, options[k]);
			}
		});
		tmp.init(el, options);
		<span class="hljs-keyword">return</span> tmp;
	};</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name $.jstree.core(id)</span></p>
<p>the jstree class constructor, used only internally</p>
<p>Parameters:</p>
<ul>
<li><strong>id must be a Number.</strong><br/>(this instance&#39;s index)</li>
</ul></div></div><div class="code"><div class="wrapper">	$.jstree.core = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(id)</span> {</span>
		<span class="hljs-keyword">this</span>._id = id;
		<span class="hljs-keyword">this</span>._cnt = <span class="hljs-number">0</span>;
		<span class="hljs-keyword">this</span>._wrk = <span class="hljs-literal">null</span>;
		<span class="hljs-keyword">this</span>._data = {
			core : {
				themes : {
					name : <span class="hljs-literal">false</span>,
					dots : <span class="hljs-literal">false</span>,
					icons : <span class="hljs-literal">false</span>
				},
				selected : [],
				last_error : {},
				working : <span class="hljs-literal">false</span>,
				worker_queue : []
			}
		};
	};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.reference(needle)</span></p>
<p>get a reference to an existing instance</p>
<p><strong>Examples</strong></p>
<p>// provided a container with an ID of &quot;tree&quot;, and a nested node with an ID of &quot;branch&quot;
// all of there will return the same instance
$.jstree.reference(&#39;tree&#39;);
$.jstree.reference(&#39;#tree&#39;);
$.jstree.reference($(&#39;#tree&#39;));
$.jstree.reference(document.getElementByID(&#39;tree&#39;));
$.jstree.reference(&#39;branch&#39;);
$.jstree.reference(&#39;#branch&#39;);
$.jstree.reference($(&#39;#branch&#39;));
$.jstree.reference(document.getElementByID(&#39;branch&#39;));</p>
<p>Parameters:</p>
<ul>
<li><strong>needle can be a DOMElement, a jQuery, or a String.</strong></li>
</ul>
<p><strong>Returns a jsTree or a null</strong><br/>(the instance or <code>null</code> if not found)</p></div></div><div class="code"><div class="wrapper">	$.jstree.reference = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(needle)</span> {</span>
		<span class="hljs-keyword">var</span> tmp = <span class="hljs-literal">null</span>,
			obj = <span class="hljs-literal">null</span>;
		<span class="hljs-keyword">if</span>(needle &amp;&amp; needle.id) { needle = needle.id; }

		<span class="hljs-keyword">if</span>(!obj || !obj.length) {
			<span class="hljs-keyword">try</span> { obj = $(needle); } <span class="hljs-keyword">catch</span> (ignore) { }
		}
		<span class="hljs-keyword">if</span>(!obj || !obj.length) {
			<span class="hljs-keyword">try</span> { obj = $(<span class="hljs-string">'#'</span> + needle.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>)); } <span class="hljs-keyword">catch</span> (ignore) { }
		}
		<span class="hljs-keyword">if</span>(obj &amp;&amp; obj.length &amp;&amp; (obj = obj.closest(<span class="hljs-string">'.jstree'</span>)).length &amp;&amp; (obj = obj.data(<span class="hljs-string">'jstree'</span>))) {
			tmp = obj;
		}
		<span class="hljs-keyword">else</span> {
			$(<span class="hljs-string">'.jstree'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">var</span> inst = $(<span class="hljs-keyword">this</span>).data(<span class="hljs-string">'jstree'</span>);
				<span class="hljs-keyword">if</span>(inst &amp;&amp; inst._model.data[needle]) {
					tmp = inst;
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
			});
		}
		<span class="hljs-keyword">return</span> tmp;
	};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $().jstree([arg])</span></p>
<p>Create an instance, get an instance or invoke a command on a instance. </p>
<p>If there is no instance associated with the current node a new one is created and <code>arg</code> is used to extend <code>$.jstree.defaults</code> for this new instance. There would be no return value (chaining is not broken).</p>
<p>If there is an existing instance and <code>arg</code> is a string the command specified by <code>arg</code> is executed on the instance, with any additional arguments passed to the function. If the function returns a value it will be returned (chaining could break depending on function).</p>
<p>If there is an existing instance and <code>arg</code> is not a string the instance itself is returned (similar to <code>$.jstree.reference</code>).</p>
<p>In any other case - nothing is returned and chaining is not broken.</p>
<p><strong>Examples</strong></p>
<p>$(&#39;#tree1&#39;).jstree(); // creates an instance
$(&#39;#tree2&#39;).jstree({ plugins : [] }); // create an instance with some options
$(&#39;#tree1&#39;).jstree(&#39;open_node&#39;, &#39;#branch_1&#39;); // call a method on an existing instance, passing additional arguments
$(&#39;#tree2&#39;).jstree(); // get an existing instance (or create an instance)
$(&#39;#tree2&#39;).jstree(true); // get an existing instance (will not create new instance)
$(&#39;#branch_1&#39;).jstree().select_node(&#39;#branch_1&#39;); // get an instance (using a nested element and call a method)</p>
<p>Parameters:</p>
<ul>
<li><strong>arg can be a String or an Object.</strong></li>
</ul>
<p><strong>Returns a Mixed</strong></p></div></div><div class="code"><div class="wrapper">	$.fn.jstree = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(arg)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>check for string argument</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">var</span> is_method	= (<span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">'string'</span>),
			args		= <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>),
			result		= <span class="hljs-literal">null</span>;
		<span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>get the instance (if there is one) and method (if it exists)</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">var</span> instance = $.jstree.reference(<span class="hljs-keyword">this</span>),
				method = is_method &amp;&amp; instance ? instance[arg] : <span class="hljs-literal">null</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if calling a method, and method is available - execute on the instance</p></div></div><div class="code"><div class="wrapper">			result = is_method &amp;&amp; method ?
				method.apply(instance, args) :
				<span class="hljs-literal">null</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if there is no instance and no method is being called - create one</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>(!instance &amp;&amp; !is_method &amp;&amp; (arg === <span class="hljs-literal">undefined</span> || $.isPlainObject(arg))) {
				$(<span class="hljs-keyword">this</span>).data(<span class="hljs-string">'jstree'</span>, <span class="hljs-keyword">new</span> $.jstree.create(<span class="hljs-keyword">this</span>, arg));
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if there is an instance and no method is called - return the instance</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>( (instance &amp;&amp; !is_method) || arg === <span class="hljs-literal">true</span> ) {
				result = instance || <span class="hljs-literal">false</span>;
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if there was a method call which returned a result - break and return the value</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>(result !== <span class="hljs-literal">null</span> &amp;&amp; result !== <span class="hljs-literal">undefined</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		});</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if there was a method call with a valid return value - return that, otherwise continue the chain</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">return</span> result !== <span class="hljs-literal">null</span> &amp;&amp; result !== <span class="hljs-literal">undefined</span> ?
			result : <span class="hljs-keyword">this</span>;
	};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $(&#39;:jstree&#39;)</span></p>
<p>used to find elements containing an instance</p>
<p><strong>Examples</strong></p>
<p>$(&#39;div:jstree&#39;).each(function () {
    $(this).jstree(&#39;destroy&#39;);
});</p>
<p><strong>Returns a jQuery</strong></p></div></div><div class="code"><div class="wrapper">	$.expr[<span class="hljs-string">':'</span>].jstree = $.expr.createPseudo(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(search)</span> {</span>
		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(a)</span> {</span>
			<span class="hljs-keyword">return</span> $(a).hasClass(<span class="hljs-string">'jstree'</span>) &amp;&amp;
				$(a).data(<span class="hljs-string">'jstree'</span>) !== <span class="hljs-literal">undefined</span>;
		};
	});</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core</span></p>
<p>stores all defaults for the core</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.core = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.data</span></p>
<p>data configuration</p>
<p>If left as <code>false</code> the HTML inside the jstree container element is used to populate the tree (that should be an unordered list with list items).</p>
<p>You can also pass in a HTML string or a JSON array here.</p>
<p>It is possible to pass in a standard jQuery-like AJAX config and jstree will automatically determine if the response is JSON or HTML and use that to populate the tree. 
In addition to the standard jQuery ajax options here you can suppy functions for <code>data</code> and <code>url</code>, the functions will be run in the current instance&#39;s scope and a param will be passed indicating which node is being loaded, the return value of those functions will be used.</p>
<p>The last option is to specify a function, that function will receive the node being loaded as argument and a second param which is a function which should be called with the result.</p>
<p><strong>Examples</strong></p>
<p>// AJAX
$(&#39;#tree&#39;).jstree({
    &#39;core&#39; : {
        &#39;data&#39; : {
            &#39;url&#39; : &#39;/get/children/&#39;,
            &#39;data&#39; : function (node) {
                return { &#39;id&#39; : node.id };
            }
        }
    });</p>
<p>// direct data
$(&#39;#tree&#39;).jstree({
    &#39;core&#39; : {
        &#39;data&#39; : [
            &#39;Simple root node&#39;,
            {
                &#39;id&#39; : &#39;node_2&#39;,
                &#39;text&#39; : &#39;Root node with options&#39;,
                &#39;state&#39; : { &#39;opened&#39; : true, &#39;selected&#39; : true },
                &#39;children&#39; : [ { &#39;text&#39; : &#39;Child 1&#39; }, &#39;Child 2&#39;]
            }
        ]
    });</p>
<p>// function
$(&#39;#tree&#39;).jstree({
    &#39;core&#39; : {
        &#39;data&#39; : function (obj, callback) {
            callback.call(this, [&#39;Root 1&#39;, &#39;Root 2&#39;]);
        }
    });</p></div></div><div class="code"><div class="wrapper">		data			: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.strings</span></p>
<p>configure the various strings used throughout the tree</p>
<p>You can use an object where the key is the string you need to replace and the value is your replacement.
Another option is to specify a function which will be called with an argument of the needed string and should return the replacement.
If left as <code>false</code> no replacement is made.</p>
<p><strong>Examples</strong></p>
<p>$(&#39;#tree&#39;).jstree({
    &#39;core&#39; : {
        &#39;strings&#39; : {
            &#39;Loading ...&#39; : &#39;Please wait ...&#39;
        }
    }
});</p></div></div><div class="code"><div class="wrapper">		strings			: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.check_callback</span></p>
<p>determines what happens when a user tries to modify the structure of the tree
If left as <code>false</code> all operations like create, rename, delete, move or copy are prevented.
You can set this to <code>true</code> to allow all interactions or use a function to have better control.</p>
<p><strong>Examples</strong></p>
<p>$(&#39;#tree&#39;).jstree({
    &#39;core&#39; : {
        &#39;check_callback&#39; : function (operation, node, node_parent, node_position, more) {
            // operation can be &#39;create_node&#39;, &#39;rename_node&#39;, &#39;delete_node&#39;, &#39;move_node&#39; or &#39;copy_node&#39;
            // in case of &#39;rename_node&#39; node_position is filled with the new node name
            return operation === &#39;rename_node&#39; ? true : false;
        }
    }
});</p></div></div><div class="code"><div class="wrapper">		check_callback	: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.error</span></p>
<p>a callback called with a single object parameter in the instance&#39;s scope when something goes wrong (operation prevented, ajax failed, etc)</p></div></div><div class="code"><div class="wrapper">		error			: $.noop,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.animation</span></p>
<p>the open / close animation duration in milliseconds - set this to <code>false</code> to disable the animation (default is <code>200</code>)</p></div></div><div class="code"><div class="wrapper">		animation		: <span class="hljs-number">200</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.multiple</span></p>
<p>a boolean indicating if multiple nodes can be selected</p></div></div><div class="code"><div class="wrapper">		multiple		: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes</span></p>
<p>theme configuration object</p></div></div><div class="code"><div class="wrapper">		themes			: {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.name</span></p>
<p>the name of the theme to use (if left as <code>false</code> the default theme is used)</p></div></div><div class="code"><div class="wrapper">			name			: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.url</span></p>
<p>the URL of the theme&#39;s CSS file, leave this as <code>false</code> if you have manually included the theme CSS (recommended). You can set this to <code>true</code> too which will try to autoload the theme.</p></div></div><div class="code"><div class="wrapper">			url				: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.dir</span></p>
<p>the location of all jstree themes - only used if <code>url</code> is set to <code>true</code></p></div></div><div class="code"><div class="wrapper">			dir				: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.dots</span></p>
<p>a boolean indicating if connecting dots are shown</p></div></div><div class="code"><div class="wrapper">			dots			: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.icons</span></p>
<p>a boolean indicating if node icons are shown</p></div></div><div class="code"><div class="wrapper">			icons			: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.stripes</span></p>
<p>a boolean indicating if the tree background is striped</p></div></div><div class="code"><div class="wrapper">			stripes			: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.variant</span></p>
<p>a string (or boolean <code>false</code>) specifying the theme variant to use (if the theme supports variants)</p></div></div><div class="code"><div class="wrapper">			variant			: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.themes.responsive</span></p>
<p>a boolean specifying if a reponsive version of the theme should kick in on smaller screens (if the theme supports it). Defaults to <code>false</code>.</p></div></div><div class="code"><div class="wrapper">			responsive		: <span class="hljs-literal">false</span>
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.expand_selected_onload</span></p>
<p>if left as <code>true</code> all parents of all selected nodes will be opened once the tree loads (so that all selected nodes are visible to the user)</p></div></div><div class="code"><div class="wrapper">		expand_selected_onload : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.worker</span></p>
<p>if left as <code>true</code> web workers will be used to parse incoming JSON data where possible, so that the UI will not be blocked by large requests. Workers are however about 30% slower. Defaults to <code>true</code></p></div></div><div class="code"><div class="wrapper">		worker : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.core.force_text</span></p>
<p>Force node text to plain text (and escape HTML). Defaults to <code>false</code></p></div></div><div class="code"><div class="wrapper">		force_text : <span class="hljs-literal">false</span>
	};
	$.jstree.core.prototype = {</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name plugin(deco [, opts])</span></p>
<p>used to decorate an instance with a plugin. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>deco must be a String.</strong><br/>(the plugin to decorate with)</p>
</li>
<li><p><strong>opts must be an Object.</strong><br/>(options for the plugin)</p>
</li>
</ul>
<p><strong>Returns a jsTree</strong></p></div></div><div class="code"><div class="wrapper">		plugin : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(deco, opts)</span> {</span>
			<span class="hljs-keyword">var</span> Child = $.jstree.plugins[deco];
			<span class="hljs-keyword">if</span>(Child) {
				<span class="hljs-keyword">this</span>._data[deco] = {};
				Child.prototype = <span class="hljs-keyword">this</span>;
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Child(opts, <span class="hljs-keyword">this</span>);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name init(el, optons) and trigger init.jstree, loading.jstree, loaded.jstree, ready.jstree, changed.jstree</span></p>
<p>used to decorate an instance with a plugin. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>el can be a DOMElement, a jQuery, or a String.</strong><br/>(the element we are transforming)</p>
</li>
<li><p><strong>options must be an Object.</strong><br/>(options for this instance)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		init : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(el, options)</span> {</span>
			<span class="hljs-keyword">this</span>._model = {
				data : {
					<span class="hljs-string">'#'</span> : {
						id : <span class="hljs-string">'#'</span>,
						parent : <span class="hljs-literal">null</span>,
						parents : [],
						children : [],
						children_d : [],
						state : { loaded : <span class="hljs-literal">false</span> }
					}
				},
				changed : [],
				force_full_redraw : <span class="hljs-literal">false</span>,
				redraw_timeout : <span class="hljs-literal">false</span>,
				default_state : {
					loaded : <span class="hljs-literal">true</span>,
					opened : <span class="hljs-literal">false</span>,
					selected : <span class="hljs-literal">false</span>,
					disabled : <span class="hljs-literal">false</span>
				}
			};

			<span class="hljs-keyword">this</span>.element = $(el).addClass(<span class="hljs-string">'jstree jstree-'</span> + <span class="hljs-keyword">this</span>._id);
			<span class="hljs-keyword">this</span>.settings = options;
			<span class="hljs-keyword">this</span>.element.bind(<span class="hljs-string">"destroyed"</span>, $.proxy(<span class="hljs-keyword">this</span>.teardown, <span class="hljs-keyword">this</span>));

			<span class="hljs-keyword">this</span>._data.core.ready = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>._data.core.loaded = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>._data.core.rtl = (<span class="hljs-keyword">this</span>.element.css(<span class="hljs-string">"direction"</span>) === <span class="hljs-string">"rtl"</span>);
			<span class="hljs-keyword">this</span>.element[<span class="hljs-keyword">this</span>._data.core.rtl ? <span class="hljs-string">'addClass'</span> : <span class="hljs-string">'removeClass'</span>](<span class="hljs-string">"jstree-rtl"</span>);
			<span class="hljs-keyword">this</span>.element.attr(<span class="hljs-string">'role'</span>,<span class="hljs-string">'tree'</span>);

			<span class="hljs-keyword">this</span>.bind();</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name init.jstree</span></p>
<p>triggered after all events are bound</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"init"</span>);

			<span class="hljs-keyword">this</span>._data.core.original_container_html = <span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">" &gt; ul &gt; li"</span>).clone(<span class="hljs-literal">true</span>);
			<span class="hljs-keyword">this</span>._data.core.original_container_html
				.find(<span class="hljs-string">"li"</span>).addBack()
				.contents().filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nodeType === <span class="hljs-number">3</span> &amp;&amp; (!<span class="hljs-keyword">this</span>.nodeValue || <span class="hljs-regexp">/^\s+$/</span>.test(<span class="hljs-keyword">this</span>.nodeValue));
				})
				.remove();
			<span class="hljs-keyword">this</span>.element.html(<span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"ul class='jstree-container-ul jstree-children'&gt;&lt;"</span>+<span class="hljs-string">"li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'&gt;&lt;i class='jstree-icon jstree-ocl'&gt;&lt;/i&gt;&lt;"</span>+<span class="hljs-string">"a class='jstree-anchor' href='#'&gt;&lt;i class='jstree-icon jstree-themeicon-hidden'&gt;&lt;/i&gt;"</span> + <span class="hljs-keyword">this</span>.get_string(<span class="hljs-string">"Loading ..."</span>) + <span class="hljs-string">"&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;"</span>);
			<span class="hljs-keyword">this</span>._data.core.li_height = <span class="hljs-keyword">this</span>.get_container_ul().children(<span class="hljs-string">"li:eq(0)"</span>).height() || <span class="hljs-number">24</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name loading.jstree</span></p>
<p>triggered after the loading text is shown and before loading starts</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"loading"</span>);
			<span class="hljs-keyword">this</span>.load_node(<span class="hljs-string">'#'</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name destroy()</span></p>
<p>destroy an instance</p>
<p>Parameters:</p>
<ul>
<li><strong>keep_html must be a Boolean.</strong><br/>(if not set to <code>true</code> the container will be emptied, otherwise the current DOM elements will be kept intact)</li>
</ul></div></div><div class="code"><div class="wrapper">		destroy : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(keep_html)</span> {</span>
			<span class="hljs-keyword">if</span>(!keep_html) { <span class="hljs-keyword">this</span>.element.empty(); }
			<span class="hljs-keyword">this</span>.element.unbind(<span class="hljs-string">"destroyed"</span>, <span class="hljs-keyword">this</span>.teardown);
			<span class="hljs-keyword">this</span>.teardown();
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name teardown()</span></p>
<p>part of the destroying of an instance. Used internally.</p></div></div><div class="code"><div class="wrapper">		teardown : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.unbind();
			<span class="hljs-keyword">this</span>.element
				.removeClass(<span class="hljs-string">'jstree'</span>)
				.removeData(<span class="hljs-string">'jstree'</span>)
				.find(<span class="hljs-string">"[class^='jstree']"</span>)
					.addBack()
					.attr(<span class="hljs-string">"class"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.className.replace(<span class="hljs-regexp">/jstree[^ ]*|$/ig</span>,<span class="hljs-string">''</span>); });
			<span class="hljs-keyword">this</span>.element = <span class="hljs-literal">null</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name bind()</span></p>
<p>bind all events. Used internally.</p></div></div><div class="code"><div class="wrapper">		bind : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">"dblclick.jstree"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">if</span>(document.selection &amp;&amp; document.selection.empty) {
							document.selection.empty();
						}
						<span class="hljs-keyword">else</span> {
							<span class="hljs-keyword">if</span>(window.getSelection) {
								<span class="hljs-keyword">var</span> sel = window.getSelection();
								<span class="hljs-keyword">try</span> {
									sel.removeAllRanges();
									sel.collapse();
								} <span class="hljs-keyword">catch</span> (ignore) { }
							}
						}
					})
				.on(<span class="hljs-string">"click.jstree"</span>, <span class="hljs-string">".jstree-ocl"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">this</span>.toggle_node(e.target);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"click.jstree"</span>, <span class="hljs-string">".jstree-anchor"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						e.preventDefault();
						$(e.currentTarget).focus();
						<span class="hljs-keyword">this</span>.activate_node(e.currentTarget, e);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">'keydown.jstree'</span>, <span class="hljs-string">'.jstree-anchor'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">if</span>(e.target.tagName === <span class="hljs-string">"INPUT"</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
						<span class="hljs-keyword">var</span> o = <span class="hljs-literal">null</span>;
						<span class="hljs-keyword">switch</span>(e.which) {
							<span class="hljs-keyword">case</span> <span class="hljs-number">13</span>:
							<span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:
								e.type = <span class="hljs-string">"click"</span>;
								$(e.currentTarget).trigger(e);
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">37</span>:
								e.preventDefault();
								<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_open(e.currentTarget)) {
									<span class="hljs-keyword">this</span>.close_node(e.currentTarget);
								}
								<span class="hljs-keyword">else</span> {
									o = <span class="hljs-keyword">this</span>.get_prev_dom(e.currentTarget);
									<span class="hljs-keyword">if</span>(o &amp;&amp; o.length) { o.children(<span class="hljs-string">'.jstree-anchor'</span>).focus(); }
								}
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">38</span>:
								e.preventDefault();
								o = <span class="hljs-keyword">this</span>.get_prev_dom(e.currentTarget);
								<span class="hljs-keyword">if</span>(o &amp;&amp; o.length) { o.children(<span class="hljs-string">'.jstree-anchor'</span>).focus(); }
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">39</span>:
								e.preventDefault();
								<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_closed(e.currentTarget)) {
									<span class="hljs-keyword">this</span>.open_node(e.currentTarget, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o)</span> {</span> <span class="hljs-keyword">this</span>.get_node(o, <span class="hljs-literal">true</span>).children(<span class="hljs-string">'.jstree-anchor'</span>).focus(); });
								}
								<span class="hljs-keyword">else</span> {
									o = <span class="hljs-keyword">this</span>.get_next_dom(e.currentTarget);
									<span class="hljs-keyword">if</span>(o &amp;&amp; o.length) { o.children(<span class="hljs-string">'.jstree-anchor'</span>).focus(); }
								}
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">40</span>:
								e.preventDefault();
								o = <span class="hljs-keyword">this</span>.get_next_dom(e.currentTarget);
								<span class="hljs-keyword">if</span>(o &amp;&amp; o.length) { o.children(<span class="hljs-string">'.jstree-anchor'</span>).focus(); }
								<span class="hljs-keyword">break</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>delete</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">case</span> <span class="hljs-number">46</span>:
								e.preventDefault();
								o = <span class="hljs-keyword">this</span>.get_node(e.currentTarget);
								<span class="hljs-keyword">if</span>(o &amp;&amp; o.id &amp;&amp; o.id !== <span class="hljs-string">'#'</span>) {
									o = <span class="hljs-keyword">this</span>.is_selected(o) ? <span class="hljs-keyword">this</span>.get_selected() : o;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>this.delete_node(o);</p></div></div><div class="code"><div class="wrapper">								}
								<span class="hljs-keyword">break</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>f2</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">case</span> <span class="hljs-number">113</span>:
								e.preventDefault();
								o = <span class="hljs-keyword">this</span>.get_node(e.currentTarget);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>!
if(o &amp;&amp; o.id &amp;&amp; o.id !== &#39;#&#39;) {
    // this.edit(o);
}</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">default</span>:</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>console.log(e.which);</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">break</span>;
						}
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"load_node.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">if</span>(data.status) {
							<span class="hljs-keyword">if</span>(data.node.id === <span class="hljs-string">'#'</span> &amp;&amp; !<span class="hljs-keyword">this</span>._data.core.loaded) {
								<span class="hljs-keyword">this</span>._data.core.loaded = <span class="hljs-literal">true</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name loaded.jstree</span></p>
<p>triggered after the root node is loaded for the first time</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"loaded"</span>);
							}
							<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>._data.core.ready &amp;&amp; !<span class="hljs-keyword">this</span>.get_container_ul().find(<span class="hljs-string">'.jstree-loading:eq(0)'</span>).length) {
								<span class="hljs-keyword">this</span>._data.core.ready = <span class="hljs-literal">true</span>;
								<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.selected.length) {
									<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.core.expand_selected_onload) {
										<span class="hljs-keyword">var</span> tmp = [], i, j;
										<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-keyword">this</span>._data.core.selected.length; i &lt; j; i++) {
											tmp = tmp.concat(<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.core.selected[i]].parents);
										}
										tmp = $.vakata.array_unique(tmp);
										<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
											<span class="hljs-keyword">this</span>.open_node(tmp[i], <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>);
										}
									}
									<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'ready'</span>, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected });
								}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name ready.jstree</span></p>
<p>triggered after all nodes are finished loading</p></div></div><div class="code"><div class="wrapper">								setTimeout($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"ready"</span>); }, <span class="hljs-keyword">this</span>), <span class="hljs-number">0</span>);
							}
						}
					}, <span class="hljs-keyword">this</span>))</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>THEME RELATED</p></div></div><div class="code"><div class="wrapper">				.on(<span class="hljs-string">"init.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.settings.core.themes;
						<span class="hljs-keyword">this</span>._data.core.themes.dots			= s.dots;
						<span class="hljs-keyword">this</span>._data.core.themes.stripes		= s.stripes;
						<span class="hljs-keyword">this</span>._data.core.themes.icons		= s.icons;
						<span class="hljs-keyword">this</span>.set_theme(s.name || <span class="hljs-string">"default"</span>, s.url);
						<span class="hljs-keyword">this</span>.set_theme_variant(s.variant);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"loading.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>._data.core.themes.dots ? <span class="hljs-string">"show_dots"</span> : <span class="hljs-string">"hide_dots"</span> ]();
						<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>._data.core.themes.icons ? <span class="hljs-string">"show_icons"</span> : <span class="hljs-string">"hide_icons"</span> ]();
						<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>._data.core.themes.stripes ? <span class="hljs-string">"show_stripes"</span> : <span class="hljs-string">"hide_stripes"</span> ]();
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">'blur.jstree'</span>, <span class="hljs-string">'.jstree-anchor'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						$(e.currentTarget).filter(<span class="hljs-string">'.jstree-hovered'</span>).mouseleave();
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">'focus.jstree'</span>, <span class="hljs-string">'.jstree-anchor'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-hovered'</span>).not(e.currentTarget).mouseleave();
						$(e.currentTarget).mouseenter();
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">'mouseenter.jstree'</span>, <span class="hljs-string">'.jstree-anchor'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">this</span>.hover_node(e.currentTarget);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">'mouseleave.jstree'</span>, <span class="hljs-string">'.jstree-anchor'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">this</span>.dehover_node(e.currentTarget);
					}, <span class="hljs-keyword">this</span>));
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name unbind()</span></p>
<p>part of the destroying of an instance. Used internally.</p></div></div><div class="code"><div class="wrapper">		unbind : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element.off(<span class="hljs-string">'.jstree'</span>);
			$(document).off(<span class="hljs-string">'.jstree-'</span> + <span class="hljs-keyword">this</span>._id);
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name trigger(ev [, data])</span></p>
<p>trigger an event. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>ev must be a String.</strong><br/>(the name of the event to trigger)</p>
</li>
<li><p><strong>data must be an Object.</strong><br/>(additional data to pass with the event)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		trigger : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ev, data)</span> {</span>
			<span class="hljs-keyword">if</span>(!data) {
				data = {};
			}
			data.instance = <span class="hljs-keyword">this</span>;
			<span class="hljs-keyword">this</span>.element.triggerHandler(ev.replace(<span class="hljs-string">'.jstree'</span>,<span class="hljs-string">''</span>) + <span class="hljs-string">'.jstree'</span>, data);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_container()</span></p>
<p>returns the jQuery extended instance container</p>
<p><strong>Returns a jQuery</strong></p></div></div><div class="code"><div class="wrapper">		get_container : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.element;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name get_container_ul()</span></p>
<p>returns the jQuery extended main UL node inside the instance container. Used internally.</p>
<p><strong>Returns a jQuery</strong></p></div></div><div class="code"><div class="wrapper">		get_container_ul : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.element.children(<span class="hljs-string">".jstree-children:eq(0)"</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name get_string(key)</span></p>
<p>gets string replacements (localization). Used internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>key must be a String.</strong></li>
</ul>
<p><strong>Returns a String</strong></p></div></div><div class="code"><div class="wrapper">		get_string : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> {</span>
			<span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.settings.core.strings;
			<span class="hljs-keyword">if</span>($.isFunction(a)) { <span class="hljs-keyword">return</span> a.call(<span class="hljs-keyword">this</span>, key); }
			<span class="hljs-keyword">if</span>(a &amp;&amp; a[key]) { <span class="hljs-keyword">return</span> a[key]; }
			<span class="hljs-keyword">return</span> key;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _firstChild(dom)</span></p>
<p>gets the first child of a DOM node. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>dom must be a DOMElement.</strong></li>
</ul>
<p><strong>Returns a DOMElement</strong></p></div></div><div class="code"><div class="wrapper">		_firstChild : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dom)</span> {</span>
			dom = dom ? dom.firstChild : <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">while</span>(dom !== <span class="hljs-literal">null</span> &amp;&amp; dom.nodeType !== <span class="hljs-number">1</span>) {
				dom = dom.nextSibling;
			}
			<span class="hljs-keyword">return</span> dom;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _nextSibling(dom)</span></p>
<p>gets the next sibling of a DOM node. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>dom must be a DOMElement.</strong></li>
</ul>
<p><strong>Returns a DOMElement</strong></p></div></div><div class="code"><div class="wrapper">		_nextSibling : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dom)</span> {</span>
			dom = dom ? dom.nextSibling : <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">while</span>(dom !== <span class="hljs-literal">null</span> &amp;&amp; dom.nodeType !== <span class="hljs-number">1</span>) {
				dom = dom.nextSibling;
			}
			<span class="hljs-keyword">return</span> dom;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _previousSibling(dom)</span></p>
<p>gets the previous sibling of a DOM node. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>dom must be a DOMElement.</strong></li>
</ul>
<p><strong>Returns a DOMElement</strong></p></div></div><div class="code"><div class="wrapper">		_previousSibling : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dom)</span> {</span>
			dom = dom ? dom.previousSibling : <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">while</span>(dom !== <span class="hljs-literal">null</span> &amp;&amp; dom.nodeType !== <span class="hljs-number">1</span>) {
				dom = dom.previousSibling;
			}
			<span class="hljs-keyword">return</span> dom;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_node(obj [, as_dom])</span></p>
<p>get the JSON representation of a node (or the actual jQuery extended DOM node) by using any input (child DOM element, ID string, selector, etc)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>as_dom must be a Boolean.</strong></p>
</li>
</ul>
<p><strong>Returns an Object or a jQuery</strong></p></div></div><div class="code"><div class="wrapper">		get_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, as_dom)</span> {</span>
			<span class="hljs-keyword">if</span>(obj &amp;&amp; obj.id) {
				obj = obj.id;
			}
			<span class="hljs-keyword">var</span> dom;
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[obj]) {
					obj = <span class="hljs-keyword">this</span>._model.data[obj];
				}
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(((dom = $(obj, <span class="hljs-keyword">this</span>.element)).length || (dom = $(<span class="hljs-string">'#'</span> + obj.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>), <span class="hljs-keyword">this</span>.element)).length) &amp;&amp; <span class="hljs-keyword">this</span>._model.data[dom.closest(<span class="hljs-string">'.jstree-node'</span>).attr(<span class="hljs-string">'id'</span>)]) {
					obj = <span class="hljs-keyword">this</span>._model.data[dom.closest(<span class="hljs-string">'.jstree-node'</span>).attr(<span class="hljs-string">'id'</span>)];
				}
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((dom = $(obj, <span class="hljs-keyword">this</span>.element)).length &amp;&amp; dom.hasClass(<span class="hljs-string">'jstree'</span>)) {
					obj = <span class="hljs-keyword">this</span>._model.data[<span class="hljs-string">'#'</span>];
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}

				<span class="hljs-keyword">if</span>(as_dom) {
					obj = obj.id === <span class="hljs-string">'#'</span> ? <span class="hljs-keyword">this</span>.element : $(<span class="hljs-string">'#'</span> + obj.id.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>), <span class="hljs-keyword">this</span>.element);
				}
				<span class="hljs-keyword">return</span> obj;
			} <span class="hljs-keyword">catch</span> (ex) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_path(obj [, glue, ids])</span></p>
<p>get the path to a node, either consisting of node texts, or of node IDs, optionally glued together (otherwise an array)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>glue must be a String.</strong><br/>(if you want the path as a string - pass the glue here (for example &#39;/&#39;), if a falsy value is supplied here, an array is returned)</p>
</li>
<li><p><strong>ids must be a Boolean.</strong><br/>(if set to true build the path using ID, otherwise node text is used)</p>
</li>
</ul>
<p><strong>Returns a mixed</strong></p></div></div><div class="code"><div class="wrapper">		get_path : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, glue, ids)</span> {</span>
			obj = obj.parents ? obj : <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span> || !obj.parents) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">var</span> i, j, p = [];
			p.push(ids ? obj.id : obj.text);
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.parents.length; i &lt; j; i++) {
				p.push(ids ? obj.parents[i] : <span class="hljs-keyword">this</span>.get_text(obj.parents[i]));
			}
			p = p.reverse().slice(<span class="hljs-number">1</span>);
			<span class="hljs-keyword">return</span> glue ? p.join(glue) : p;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_next_dom(obj [, strict])</span></p>
<p>get the next visible node that is below the <code>obj</code> node. If <code>strict</code> is set to <code>true</code> only sibling nodes are returned.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>strict must be a Boolean.</strong></p>
</li>
</ul>
<p><strong>Returns a jQuery</strong></p></div></div><div class="code"><div class="wrapper">		get_next_dom : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, strict)</span> {</span>
			<span class="hljs-keyword">var</span> tmp;
			obj = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(obj[<span class="hljs-number">0</span>] === <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>]) {
				tmp = <span class="hljs-keyword">this</span>._firstChild(<span class="hljs-keyword">this</span>.get_container_ul()[<span class="hljs-number">0</span>]);
				<span class="hljs-keyword">return</span> tmp ? $(tmp) : <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(!obj || !obj.length) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(strict) {
				tmp = <span class="hljs-keyword">this</span>._nextSibling(obj[<span class="hljs-number">0</span>]);
				<span class="hljs-keyword">return</span> tmp ? $(tmp) : <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(obj.hasClass(<span class="hljs-string">"jstree-open"</span>)) {
				tmp = <span class="hljs-keyword">this</span>._firstChild(obj.children(<span class="hljs-string">'.jstree-children'</span>)[<span class="hljs-number">0</span>]);
				<span class="hljs-keyword">return</span> tmp ? $(tmp) : <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>((tmp = <span class="hljs-keyword">this</span>._nextSibling(obj[<span class="hljs-number">0</span>])) !== <span class="hljs-literal">null</span>) {
				<span class="hljs-keyword">return</span> $(tmp);
			}
			<span class="hljs-keyword">return</span> obj.parentsUntil(<span class="hljs-string">".jstree"</span>,<span class="hljs-string">".jstree-node"</span>).next(<span class="hljs-string">".jstree-node"</span>).eq(<span class="hljs-number">0</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_prev_dom(obj [, strict])</span></p>
<p>get the previous visible node that is above the <code>obj</code> node. If <code>strict</code> is set to <code>true</code> only sibling nodes are returned.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>strict must be a Boolean.</strong></p>
</li>
</ul>
<p><strong>Returns a jQuery</strong></p></div></div><div class="code"><div class="wrapper">		get_prev_dom : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, strict)</span> {</span>
			<span class="hljs-keyword">var</span> tmp;
			obj = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(obj[<span class="hljs-number">0</span>] === <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>]) {
				tmp = <span class="hljs-keyword">this</span>.get_container_ul()[<span class="hljs-number">0</span>].lastChild;
				<span class="hljs-keyword">return</span> tmp ? $(tmp) : <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(!obj || !obj.length) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(strict) {
				tmp = <span class="hljs-keyword">this</span>._previousSibling(obj[<span class="hljs-number">0</span>]);
				<span class="hljs-keyword">return</span> tmp ? $(tmp) : <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>((tmp = <span class="hljs-keyword">this</span>._previousSibling(obj[<span class="hljs-number">0</span>])) !== <span class="hljs-literal">null</span>) {
				obj = $(tmp);
				<span class="hljs-keyword">while</span>(obj.hasClass(<span class="hljs-string">"jstree-open"</span>)) {
					obj = obj.children(<span class="hljs-string">".jstree-children:eq(0)"</span>).children(<span class="hljs-string">".jstree-node:last"</span>);
				}
				<span class="hljs-keyword">return</span> obj;
			}
			tmp = obj[<span class="hljs-number">0</span>].parentNode.parentNode;
			<span class="hljs-keyword">return</span> tmp &amp;&amp; tmp.className &amp;&amp; tmp.className.indexOf(<span class="hljs-string">'jstree-node'</span>) !== -<span class="hljs-number">1</span> ? $(tmp) : <span class="hljs-literal">false</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_parent(obj)</span></p>
<p>get the parent ID of a node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a String</strong></p></div></div><div class="code"><div class="wrapper">		get_parent : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">return</span> obj.parent;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_children_dom(obj)</span></p>
<p>get a jQuery collection of all the children of a node (node must be rendered)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a jQuery</strong></p></div></div><div class="code"><div class="wrapper">		get_children_dom : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(obj[<span class="hljs-number">0</span>] === <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>]) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_container_ul().children(<span class="hljs-string">".jstree-node"</span>);
			}
			<span class="hljs-keyword">if</span>(!obj || !obj.length) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">return</span> obj.children(<span class="hljs-string">".jstree-children"</span>).children(<span class="hljs-string">".jstree-node"</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_parent(obj)</span></p>
<p>checks if a node has children</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_parent : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> obj &amp;&amp; (obj.state.loaded === <span class="hljs-literal">false</span> || obj.children.length &gt; <span class="hljs-number">0</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_loaded(obj)</span></p>
<p>checks if a node is loaded (its children are available)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_loaded : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> obj &amp;&amp; obj.state.loaded;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_loading(obj)</span></p>
<p>check if a node is currently loading (fetching children)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_loading : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> obj &amp;&amp; obj.state &amp;&amp; obj.state.loading;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_open(obj)</span></p>
<p>check if a node is opened</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_open : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> obj &amp;&amp; obj.state.opened;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_closed(obj)</span></p>
<p>check if a node is in a closed state</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_closed : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> obj &amp;&amp; <span class="hljs-keyword">this</span>.is_parent(obj) &amp;&amp; !obj.state.opened;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_leaf(obj)</span></p>
<p>check if a node has no children</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_leaf : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.is_parent(obj);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name load_node(obj [, callback]) and trigger load_node.jstree</span></p>
<p>loads a node (fetches its children using the <code>core.data</code> setting). Multiple nodes can be passed to by using an array.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>callback must be a function.</strong><br/>(a function to be executed once loading is conplete, the function is executed in the instance&#39;s scope and receives two arguments - the node and a boolean status)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		load_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, callback)</span> {</span>
			<span class="hljs-keyword">var</span> k, l, i, j, c;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				<span class="hljs-keyword">this</span>._load_nodes(obj.slice(), callback);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj) {
				<span class="hljs-keyword">if</span>(callback) { callback.call(<span class="hljs-keyword">this</span>, obj, <span class="hljs-literal">false</span>); }
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if(obj.state.loading) { } // the node is already loading - just wait for it to load and invoke callback? but if called implicitly it should be loaded again?</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>(obj.state.loaded) {
				obj.state.loaded = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = obj.children_d.length; k &lt; l; k++) {
					<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.parents.length; i &lt; j; i++) {
						<span class="hljs-keyword">this</span>._model.data[obj.parents[i]].children_d = $.vakata.array_remove_item(<span class="hljs-keyword">this</span>._model.data[obj.parents[i]].children_d, obj.children_d[k]);
					}
					<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[obj.children_d[k]].state.selected) {
						c = <span class="hljs-literal">true</span>;
						<span class="hljs-keyword">this</span>._data.core.selected = $.vakata.array_remove_item(<span class="hljs-keyword">this</span>._data.core.selected, obj.children_d[k]);
					}
					<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._model.data[obj.children_d[k]];
				}
				obj.children = [];
				obj.children_d = [];
				<span class="hljs-keyword">if</span>(c) {
					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'load_node'</span>, <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected });
				}
			}
			obj.state.loading = <span class="hljs-literal">true</span>;
			<span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>).addClass(<span class="hljs-string">"jstree-loading"</span>);
			<span class="hljs-keyword">this</span>._load_node(obj, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span>
				obj = <span class="hljs-keyword">this</span>._model.data[obj.id];
				obj.state.loading = <span class="hljs-literal">false</span>;
				obj.state.loaded = status;
				<span class="hljs-keyword">var</span> dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
				<span class="hljs-keyword">if</span>(obj.state.loaded &amp;&amp; !obj.children.length &amp;&amp; dom &amp;&amp; dom.length &amp;&amp; !dom.hasClass(<span class="hljs-string">'jstree-leaf'</span>)) {
					dom.removeClass(<span class="hljs-string">'jstree-closed jstree-open'</span>).addClass(<span class="hljs-string">'jstree-leaf'</span>);
				}
				dom.removeClass(<span class="hljs-string">"jstree-loading"</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name load_node.jstree</span></p>
<p>triggered after a node is loaded</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong><br/>(the node that was loading)</p>
</li>
<li><p><strong>status must be a Boolean.</strong><br/>(was the node loaded successfully)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'load_node'</span>, { <span class="hljs-string">"node"</span> : obj, <span class="hljs-string">"status"</span> : status });
				<span class="hljs-keyword">if</span>(callback) {
					callback.call(<span class="hljs-keyword">this</span>, obj, status);
				}
			}, <span class="hljs-keyword">this</span>));
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _load_nodes(nodes [, callback])</span></p>
<p>load an array of nodes (will also load unavailable nodes as soon as the appear in the structure). Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>nodes must be an array.</strong></p>
</li>
<li><p><strong>callback must be a function.</strong><br/>(a function to be executed once loading is complete, the function is executed in the instance&#39;s scope and receives one argument - the array passed to _load_nodes)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		_load_nodes : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(nodes, callback, is_callback)</span> {</span>
			<span class="hljs-keyword">var</span> r = <span class="hljs-literal">true</span>,
				c = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._load_nodes(nodes, callback, <span class="hljs-literal">true</span>); },
				m = <span class="hljs-keyword">this</span>._model.data, i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = nodes.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(m[nodes[i]] &amp;&amp; (!m[nodes[i]].state.loaded || !is_callback)) {
					<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.is_loading(nodes[i])) {
						<span class="hljs-keyword">this</span>.load_node(nodes[i], c);
					}
					r = <span class="hljs-literal">false</span>;
				}
			}
			<span class="hljs-keyword">if</span>(r) {
				<span class="hljs-keyword">if</span>(callback &amp;&amp; !callback.done) {
					callback.call(<span class="hljs-keyword">this</span>, nodes);
					callback.done = <span class="hljs-literal">true</span>;
				}
			}
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _load_node(obj [, callback])</span></p>
<p>handles the actual loading of a node. Used only internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>callback must be a function.</strong><br/>(a function to be executed once loading is complete, the function is executed in the instance&#39;s scope and receives one argument - a boolean status)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		_load_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, callback)</span> {</span>
			<span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.settings.core.data, t;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>use original HTML</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>(!s) {
				<span class="hljs-keyword">if</span>(obj.id === <span class="hljs-string">'#'</span>) {
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._append_html_data(obj, <span class="hljs-keyword">this</span>._data.core.original_container_html.clone(<span class="hljs-literal">true</span>), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span>
						callback.call(<span class="hljs-keyword">this</span>, status);
					});
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">return</span> callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
				}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return callback.call(this, obj.id === &#39;#&#39; ? this._append_html_data(obj, this._data.core.original_container_html.clone(true)) : false);</p></div></div><div class="code"><div class="wrapper">			}
			<span class="hljs-keyword">if</span>($.isFunction(s)) {
				<span class="hljs-keyword">return</span> s.call(<span class="hljs-keyword">this</span>, obj, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> {</span>
					<span class="hljs-keyword">if</span>(d === <span class="hljs-literal">false</span>) {
						callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
					}
					<span class="hljs-keyword">this</span>[<span class="hljs-keyword">typeof</span> d === <span class="hljs-string">'string'</span> ? <span class="hljs-string">'_append_html_data'</span> : <span class="hljs-string">'_append_json_data'</span>](obj, <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">'string'</span> ? $(d) : d, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span>
						callback.call(<span class="hljs-keyword">this</span>, status);
					});</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return d === false ? callback.call(this, false) : callback.call(this, this<a href="obj, typeof d === &#39;string&#39; ? $(d">typeof d === &#39;string&#39; ? &#39;_append_html_data&#39; : &#39;_append_json_data&#39;</a> : d));</p></div></div><div class="code"><div class="wrapper">				}, <span class="hljs-keyword">this</span>));
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> s === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">if</span>(s.url) {
					s = $.extend(<span class="hljs-literal">true</span>, {}, s);
					<span class="hljs-keyword">if</span>($.isFunction(s.url)) {
						s.url = s.url.call(<span class="hljs-keyword">this</span>, obj);
					}
					<span class="hljs-keyword">if</span>($.isFunction(s.data)) {
						s.data = s.data.call(<span class="hljs-keyword">this</span>, obj);
					}
					<span class="hljs-keyword">return</span> $.ajax(s)
						.done($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d,t,x)</span> {</span>
								<span class="hljs-keyword">var</span> type = x.getResponseHeader(<span class="hljs-string">'Content-Type'</span>);
								<span class="hljs-keyword">if</span>(type.indexOf(<span class="hljs-string">'json'</span>) !== -<span class="hljs-number">1</span> || <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">"object"</span>) {
									<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._append_json_data(obj, d, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span> callback.call(<span class="hljs-keyword">this</span>, status); });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return callback.call(this, this._append_json_data(obj, d));</p></div></div><div class="code"><div class="wrapper">								}
								<span class="hljs-keyword">if</span>(type.indexOf(<span class="hljs-string">'html'</span>) !== -<span class="hljs-number">1</span> || <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">"string"</span>) {
									<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._append_html_data(obj, $(d), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span> callback.call(<span class="hljs-keyword">this</span>, status); });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return callback.call(this, this._append_html_data(obj, $(d)));</p></div></div><div class="code"><div class="wrapper">								}
								<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'ajax'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_04'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Could not load node'</span>, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'id'</span> : obj.id, <span class="hljs-string">'xhr'</span> : x }) };
								<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
								<span class="hljs-keyword">return</span> callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
							}, <span class="hljs-keyword">this</span>))
						.fail($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(f)</span> {</span>
								callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
								<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'ajax'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_04'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Could not load node'</span>, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'id'</span> : obj.id, <span class="hljs-string">'xhr'</span> : f }) };
								<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
							}, <span class="hljs-keyword">this</span>));
				}
				t = ($.isArray(s) || $.isPlainObject(s)) ? <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(s)) : s;
				<span class="hljs-keyword">if</span>(obj.id === <span class="hljs-string">'#'</span>) {
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._append_json_data(obj, t, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span>
						callback.call(<span class="hljs-keyword">this</span>, status);
					});
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'nodata'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_05'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Could not load node'</span>, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'id'</span> : obj.id }) };
					<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
					<span class="hljs-keyword">return</span> callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
				}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return callback.call(this, (obj.id === &quot;#&quot; ? this._append_json_data(obj, t) : false) );</p></div></div><div class="code"><div class="wrapper">			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> s === <span class="hljs-string">'string'</span>) {
				<span class="hljs-keyword">if</span>(obj.id === <span class="hljs-string">'#'</span>) {
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._append_html_data(obj, $(s), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> {</span>
						callback.call(<span class="hljs-keyword">this</span>, status);
					});
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'nodata'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_06'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Could not load node'</span>, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'id'</span> : obj.id }) };
					<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
					<span class="hljs-keyword">return</span> callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
				}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return callback.call(this, (obj.id === &quot;#&quot; ? this._append_html_data(obj, $(s)) : false) );</p></div></div><div class="code"><div class="wrapper">			}
			<span class="hljs-keyword">return</span> callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">false</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _node_changed(obj [, callback])</span></p>
<p>adds a node to the list of nodes to redraw. Used only internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">		_node_changed : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(obj) {
				<span class="hljs-keyword">this</span>._model.changed.push(obj.id);
			}
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _append_html_data(obj, data) and trigger model.jstree, changed.jstree</span></p>
<p>appends HTML content to the tree. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to append to)</p>
</li>
<li><p><strong>data must be a String.</strong><br/>(the HTML string to parse and append)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		_append_html_data : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dom, data, cb)</span> {</span>
			dom = <span class="hljs-keyword">this</span>.get_node(dom);
			dom.children = [];
			dom.children_d = [];
			<span class="hljs-keyword">var</span> dat = data.is(<span class="hljs-string">'ul'</span>) ? data.children() : data,
				par = dom.id,
				chd = [],
				dpc = [],
				m = <span class="hljs-keyword">this</span>._model.data,
				p = m[par],
				s = <span class="hljs-keyword">this</span>._data.core.selected.length,
				tmp, i, j;
			dat.each($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
				tmp = <span class="hljs-keyword">this</span>._parse_model_from_html($(v), par, p.parents.concat());
				<span class="hljs-keyword">if</span>(tmp) {
					chd.push(tmp);
					dpc.push(tmp);
					<span class="hljs-keyword">if</span>(m[tmp].children_d.length) {
						dpc = dpc.concat(m[tmp].children_d);
					}
				}
			}, <span class="hljs-keyword">this</span>));
			p.children = chd;
			p.children_d = dpc;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.parents.length; i &lt; j; i++) {
				m[p.parents[i]].children_d = m[p.parents[i]].children_d.concat(dpc);
			}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name model.jstree</span></p>
<p>triggered when new data is inserted to the tree model</p>
<p>Parameters:</p>
<ul>
<li><p><strong>nodes must be an Array.</strong><br/>(an array of node IDs)</p>
</li>
<li><p><strong>parent must be a String.</strong><br/>(the parent ID of the nodes)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'model'</span>, { <span class="hljs-string">"nodes"</span> : dpc, <span class="hljs-string">'parent'</span> : par });
			<span class="hljs-keyword">if</span>(par !== <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">this</span>._node_changed(par);
				<span class="hljs-keyword">this</span>.redraw();
			}
			<span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.get_container_ul().children(<span class="hljs-string">'.jstree-initial-node'</span>).remove();
				<span class="hljs-keyword">this</span>.redraw(<span class="hljs-literal">true</span>);
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.selected.length !== s) {
				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'model'</span>, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected });
			}
			cb.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">true</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _append_json_data(obj, data) and trigger model.jstree, changed.jstree</span></p>
<p>appends JSON content to the tree. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to append to)</p>
</li>
<li><p><strong>data must be a String.</strong><br/>(the JSON object to parse and append)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		_append_json_data : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dom, data, cb)</span> {</span>
			dom = <span class="hljs-keyword">this</span>.get_node(dom);
			dom.children = [];
			dom.children_d = [];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>*%$@!!!</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>(data.d) {
				data = data.d;
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> data === <span class="hljs-string">"string"</span>) {
					data = <span class="hljs-built_in">JSON</span>.parse(data);
				}
			}
			<span class="hljs-keyword">if</span>(!$.isArray(data)) { data = [data]; }
			<span class="hljs-keyword">var</span> w = <span class="hljs-literal">null</span>,
				args = {
					<span class="hljs-string">'df'</span>	: <span class="hljs-keyword">this</span>._model.default_state,
					<span class="hljs-string">'dat'</span>	: data,
					<span class="hljs-string">'par'</span>	: dom.id,
					<span class="hljs-string">'m'</span>		: <span class="hljs-keyword">this</span>._model.data,
					<span class="hljs-string">'t_id'</span>	: <span class="hljs-keyword">this</span>._id,
					<span class="hljs-string">'t_cnt'</span>	: <span class="hljs-keyword">this</span>._cnt,
					<span class="hljs-string">'sel'</span>	: <span class="hljs-keyword">this</span>._data.core.selected
				},
				func = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data, undefined)</span> {</span>
					<span class="hljs-keyword">if</span>(data.data) { data = data.data; }
					<span class="hljs-keyword">var</span> dat = data.dat,
						par = data.par,
						chd = [],
						dpc = [],
						add = [],
						df = data.df,
						t_id = data.t_id,
						t_cnt = data.t_cnt,
						m = data.m,
						p = m[par],
						sel = data.sel,
						tmp, i, j, rslt,
						parse_flat = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d, p, ps)</span> {</span>
							<span class="hljs-keyword">if</span>(!ps) { ps = []; }
							<span class="hljs-keyword">else</span> { ps = ps.concat(); }
							<span class="hljs-keyword">if</span>(p) { ps.unshift(p); }
							<span class="hljs-keyword">var</span> tid = d.id.toString(),
								i, j, c, e,
								tmp = {
									id			: tid,
									text		: d.text || <span class="hljs-string">''</span>,
									icon		: d.icon !== <span class="hljs-literal">undefined</span> ? d.icon : <span class="hljs-literal">true</span>,
									parent		: p,
									parents		: ps,
									children	: d.children || [],
									children_d	: d.children_d || [],
									data		: d.data,
									state		: { },
									li_attr		: { id : <span class="hljs-literal">false</span> },
									a_attr		: { href : <span class="hljs-string">'#'</span> },
									original	: <span class="hljs-literal">false</span>
								};
							<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> df) {
								<span class="hljs-keyword">if</span>(df.hasOwnProperty(i)) {
									tmp.state[i] = df[i];
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.data &amp;&amp; d.data.jstree &amp;&amp; d.data.jstree.icon) {
								tmp.icon = d.data.jstree.icon;
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.data) {
								tmp.data = d.data;
								<span class="hljs-keyword">if</span>(d.data.jstree) {
									<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> d.data.jstree) {
										<span class="hljs-keyword">if</span>(d.data.jstree.hasOwnProperty(i)) {
											tmp.state[i] = d.data.jstree[i];
										}
									}
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.state === <span class="hljs-string">'object'</span>) {
								<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.state) {
									<span class="hljs-keyword">if</span>(d.state.hasOwnProperty(i)) {
										tmp.state[i] = d.state[i];
									}
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.li_attr === <span class="hljs-string">'object'</span>) {
								<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.li_attr) {
									<span class="hljs-keyword">if</span>(d.li_attr.hasOwnProperty(i)) {
										tmp.li_attr[i] = d.li_attr[i];
									}
								}
							}
							<span class="hljs-keyword">if</span>(!tmp.li_attr.id) {
								tmp.li_attr.id = tid;
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.a_attr === <span class="hljs-string">'object'</span>) {
								<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.a_attr) {
									<span class="hljs-keyword">if</span>(d.a_attr.hasOwnProperty(i)) {
										tmp.a_attr[i] = d.a_attr[i];
									}
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.children &amp;&amp; d.children === <span class="hljs-literal">true</span>) {
								tmp.state.loaded = <span class="hljs-literal">false</span>;
								tmp.children = [];
								tmp.children_d = [];
							}
							m[tmp.id] = tmp;
							<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.children.length; i &lt; j; i++) {
								c = parse_flat(m[tmp.children[i]], tmp.id, ps);
								e = m[c];
								tmp.children_d.push(c);
								<span class="hljs-keyword">if</span>(e.children_d.length) {
									tmp.children_d = tmp.children_d.concat(e.children_d);
								}
							}
							<span class="hljs-keyword">delete</span> d.data;
							<span class="hljs-keyword">delete</span> d.children;
							m[tmp.id].original = d;
							<span class="hljs-keyword">if</span>(tmp.state.selected) {
								add.push(tmp.id);
							}
							<span class="hljs-keyword">return</span> tmp.id;
						},
						parse_nest = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d, p, ps)</span> {</span>
							<span class="hljs-keyword">if</span>(!ps) { ps = []; }
							<span class="hljs-keyword">else</span> { ps = ps.concat(); }
							<span class="hljs-keyword">if</span>(p) { ps.unshift(p); }
							<span class="hljs-keyword">var</span> tid = <span class="hljs-literal">false</span>, i, j, c, e, tmp;
							<span class="hljs-keyword">do</span> {
								tid = <span class="hljs-string">'j'</span> + t_id + <span class="hljs-string">'_'</span> + (++t_cnt);
							} <span class="hljs-keyword">while</span>(m[tid]);

							tmp = {
								id			: <span class="hljs-literal">false</span>,
								text		: <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">'string'</span> ? d : <span class="hljs-string">''</span>,
								icon		: <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">'object'</span> &amp;&amp; d.icon !== <span class="hljs-literal">undefined</span> ? d.icon : <span class="hljs-literal">true</span>,
								parent		: p,
								parents		: ps,
								children	: [],
								children_d	: [],
								data		: <span class="hljs-literal">null</span>,
								state		: { },
								li_attr		: { id : <span class="hljs-literal">false</span> },
								a_attr		: { href : <span class="hljs-string">'#'</span> },
								original	: <span class="hljs-literal">false</span>
							};
							<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> df) {
								<span class="hljs-keyword">if</span>(df.hasOwnProperty(i)) {
									tmp.state[i] = df[i];
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.id) { tmp.id = d.id.toString(); }
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.text) { tmp.text = d.text; }
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.data &amp;&amp; d.data.jstree &amp;&amp; d.data.jstree.icon) {
								tmp.icon = d.data.jstree.icon;
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.data) {
								tmp.data = d.data;
								<span class="hljs-keyword">if</span>(d.data.jstree) {
									<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> d.data.jstree) {
										<span class="hljs-keyword">if</span>(d.data.jstree.hasOwnProperty(i)) {
											tmp.state[i] = d.data.jstree[i];
										}
									}
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.state === <span class="hljs-string">'object'</span>) {
								<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.state) {
									<span class="hljs-keyword">if</span>(d.state.hasOwnProperty(i)) {
										tmp.state[i] = d.state[i];
									}
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.li_attr === <span class="hljs-string">'object'</span>) {
								<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.li_attr) {
									<span class="hljs-keyword">if</span>(d.li_attr.hasOwnProperty(i)) {
										tmp.li_attr[i] = d.li_attr[i];
									}
								}
							}
							<span class="hljs-keyword">if</span>(tmp.li_attr.id &amp;&amp; !tmp.id) {
								tmp.id = tmp.li_attr.id.toString();
							}
							<span class="hljs-keyword">if</span>(!tmp.id) {
								tmp.id = tid;
							}
							<span class="hljs-keyword">if</span>(!tmp.li_attr.id) {
								tmp.li_attr.id = tmp.id;
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.a_attr === <span class="hljs-string">'object'</span>) {
								<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.a_attr) {
									<span class="hljs-keyword">if</span>(d.a_attr.hasOwnProperty(i)) {
										tmp.a_attr[i] = d.a_attr[i];
									}
								}
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.children &amp;&amp; d.children.length) {
								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = d.children.length; i &lt; j; i++) {
									c = parse_nest(d.children[i], tmp.id, ps);
									e = m[c];
									tmp.children.push(c);
									<span class="hljs-keyword">if</span>(e.children_d.length) {
										tmp.children_d = tmp.children_d.concat(e.children_d);
									}
								}
								tmp.children_d = tmp.children_d.concat(tmp.children);
							}
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.children &amp;&amp; d.children === <span class="hljs-literal">true</span>) {
								tmp.state.loaded = <span class="hljs-literal">false</span>;
								tmp.children = [];
								tmp.children_d = [];
							}
							<span class="hljs-keyword">delete</span> d.data;
							<span class="hljs-keyword">delete</span> d.children;
							tmp.original = d;
							m[tmp.id] = tmp;
							<span class="hljs-keyword">if</span>(tmp.state.selected) {
								add.push(tmp.id);
							}
							<span class="hljs-keyword">return</span> tmp.id;
						};

					<span class="hljs-keyword">if</span>(dat.length &amp;&amp; dat[<span class="hljs-number">0</span>].id !== <span class="hljs-literal">undefined</span> &amp;&amp; dat[<span class="hljs-number">0</span>].parent !== <span class="hljs-literal">undefined</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Flat JSON support (for easy import from DB):
1) convert to object (foreach)</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dat.length; i &lt; j; i++) {
							<span class="hljs-keyword">if</span>(!dat[i].children) {
								dat[i].children = [];
							}
							m[dat[i].id.toString()] = dat[i];
						}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>2) populate children (foreach)</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dat.length; i &lt; j; i++) {
							m[dat[i].parent.toString()].children.push(dat[i].id.toString());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>populate parent.children_d</p></div></div><div class="code"><div class="wrapper">							p.children_d.push(dat[i].id.toString());
						}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>3) normalize &amp;&amp; populate parents and children_d with recursion</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.children.length; i &lt; j; i++) {
							tmp = parse_flat(m[p.children[i]], par, p.parents.concat());
							dpc.push(tmp);
							<span class="hljs-keyword">if</span>(m[tmp].children_d.length) {
								dpc = dpc.concat(m[tmp].children_d);
							}
						}
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.parents.length; i &lt; j; i++) {
							m[p.parents[i]].children_d = m[p.parents[i]].children_d.concat(dpc);
						}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>?) three_state selection - p.state.selected &amp;&amp; t - (if three_state foreach(dat =&gt; ch) -&gt; foreach(parents) if(parent.selected) child.selected = true;</p></div></div><div class="code"><div class="wrapper">						rslt = {
							<span class="hljs-string">'cnt'</span> : t_cnt,
							<span class="hljs-string">'mod'</span> : m,
							<span class="hljs-string">'sel'</span> : sel,
							<span class="hljs-string">'par'</span> : par,
							<span class="hljs-string">'dpc'</span> : dpc,
							<span class="hljs-string">'add'</span> : add
						};
					}
					<span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dat.length; i &lt; j; i++) {
							tmp = parse_nest(dat[i], par, p.parents.concat());
							<span class="hljs-keyword">if</span>(tmp) {
								chd.push(tmp);
								dpc.push(tmp);
								<span class="hljs-keyword">if</span>(m[tmp].children_d.length) {
									dpc = dpc.concat(m[tmp].children_d);
								}
							}
						}
						p.children = chd;
						p.children_d = dpc;
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.parents.length; i &lt; j; i++) {
							m[p.parents[i]].children_d = m[p.parents[i]].children_d.concat(dpc);
						}
						rslt = {
							<span class="hljs-string">'cnt'</span> : t_cnt,
							<span class="hljs-string">'mod'</span> : m,
							<span class="hljs-string">'sel'</span> : sel,
							<span class="hljs-string">'par'</span> : par,
							<span class="hljs-string">'dpc'</span> : dpc,
							<span class="hljs-string">'add'</span> : add
						};
					}
					<span class="hljs-keyword">return</span> rslt;
				},
				rslt = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(rslt, worker)</span> {</span>
					<span class="hljs-keyword">this</span>._cnt = rslt.cnt;
					<span class="hljs-keyword">this</span>._model.data = rslt.mod; <span class="hljs-comment">// breaks the reference in load_node - careful</span>

					<span class="hljs-keyword">if</span>(worker) {
						<span class="hljs-keyword">var</span> i, j, a = rslt.add, r = rslt.sel, s = <span class="hljs-keyword">this</span>._data.core.selected.slice(), m = <span class="hljs-keyword">this</span>._model.data;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if selection was changed while calculating in worker</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">if</span>(r.length !== s.length || $.vakata.array_unique(r.concat(s)).length !== r.length) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>deselect nodes that are no longer selected</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = r.length; i &lt; j; i++) {
								<span class="hljs-keyword">if</span>($.inArray(r[i], a) === -<span class="hljs-number">1</span> &amp;&amp; $.inArray(r[i], s) === -<span class="hljs-number">1</span>) {
									m[r[i]].state.selected = <span class="hljs-literal">false</span>;
								}
							}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>select nodes that were selected in the mean time</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = s.length; i &lt; j; i++) {
								<span class="hljs-keyword">if</span>($.inArray(s[i], r) === -<span class="hljs-number">1</span>) {
									m[s[i]].state.selected = <span class="hljs-literal">true</span>;
								}
							}
						}
					}
					<span class="hljs-keyword">if</span>(rslt.add.length) {
						<span class="hljs-keyword">this</span>._data.core.selected = <span class="hljs-keyword">this</span>._data.core.selected.concat(rslt.add);
					}

					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'model'</span>, { <span class="hljs-string">"nodes"</span> : rslt.dpc, <span class="hljs-string">'parent'</span> : rslt.par });

					<span class="hljs-keyword">if</span>(rslt.par !== <span class="hljs-string">'#'</span>) {
						<span class="hljs-keyword">this</span>._node_changed(rslt.par);
						<span class="hljs-keyword">this</span>.redraw();
					}
					<span class="hljs-keyword">else</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>this.get_container_ul().children(&#39;.jstree-initial-node&#39;).remove();</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">this</span>.redraw(<span class="hljs-literal">true</span>);
					}
					<span class="hljs-keyword">if</span>(rslt.add.length) {
						<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'model'</span>, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected });
					}
					cb.call(<span class="hljs-keyword">this</span>, <span class="hljs-literal">true</span>);
				};
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.core.worker &amp;&amp; window.Blob &amp;&amp; window.URL &amp;&amp; window.Worker) {
				<span class="hljs-keyword">try</span> {
					<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._wrk === <span class="hljs-literal">null</span>) {
						<span class="hljs-keyword">this</span>._wrk = window.URL.createObjectURL(
							<span class="hljs-keyword">new</span> window.Blob(
								[<span class="hljs-string">'self.onmessage = '</span> + func.toString().replace(<span class="hljs-regexp">/return ([^;}]+)[\s;}]+$/</span>, <span class="hljs-string">'postMessage($1);}'</span>)],
								{type:<span class="hljs-string">"text/javascript"</span>}
							)
						);
					}
					w = <span class="hljs-keyword">new</span> window.Worker(<span class="hljs-keyword">this</span>._wrk);
					w.onmessage = $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						rslt.call(<span class="hljs-keyword">this</span>, e.data, <span class="hljs-literal">true</span>);
						<span class="hljs-keyword">this</span>._data.core.working = <span class="hljs-literal">false</span>;
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.worker_queue.length) {
							<span class="hljs-keyword">this</span>._append_json_data.apply(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.worker_queue.shift());
						}
					}, <span class="hljs-keyword">this</span>);
					<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>._data.core.working) {
						<span class="hljs-keyword">this</span>._data.core.working = <span class="hljs-literal">true</span>;
						w.postMessage(args);
					}
					<span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">this</span>._data.core.worker_queue.push([dom, data, cb]);
					}
				}
				<span class="hljs-keyword">catch</span>(e) {
					rslt.call(<span class="hljs-keyword">this</span>, func(args), <span class="hljs-literal">false</span>);
				}
			}
			<span class="hljs-keyword">else</span> {
				rslt.call(<span class="hljs-keyword">this</span>, func(args), <span class="hljs-literal">false</span>);
			}
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _parse_model_from_html(d [, p, ps])</span></p>
<p>parses a node from a jQuery object and appends them to the in memory tree model. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>d must be a jQuery.</strong><br/>(the jQuery object to parse)</p>
</li>
<li><p><strong>p must be a String.</strong><br/>(the parent ID)</p>
</li>
<li><p><strong>ps must be an Array.</strong><br/>(list of all parents)</p>
</li>
</ul>
<p><strong>Returns a String</strong><br/>(the ID of the object added to the model)</p></div></div><div class="code"><div class="wrapper">		_parse_model_from_html : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d, p, ps)</span> {</span>
			<span class="hljs-keyword">if</span>(!ps) { ps = []; }
			<span class="hljs-keyword">else</span> { ps = [].concat(ps); }
			<span class="hljs-keyword">if</span>(p) { ps.unshift(p); }
			<span class="hljs-keyword">var</span> c, e, m = <span class="hljs-keyword">this</span>._model.data,
				data = {
					id			: <span class="hljs-literal">false</span>,
					text		: <span class="hljs-literal">false</span>,
					icon		: <span class="hljs-literal">true</span>,
					parent		: p,
					parents		: ps,
					children	: [],
					children_d	: [],
					data		: <span class="hljs-literal">null</span>,
					state		: { },
					li_attr		: { id : <span class="hljs-literal">false</span> },
					a_attr		: { href : <span class="hljs-string">'#'</span> },
					original	: <span class="hljs-literal">false</span>
				}, i, tmp, tid;
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>._model.default_state) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.default_state.hasOwnProperty(i)) {
					data.state[i] = <span class="hljs-keyword">this</span>._model.default_state[i];
				}
			}
			tmp = $.vakata.attributes(d, <span class="hljs-literal">true</span>);
			$.each(tmp, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
				v = $.trim(v);
				<span class="hljs-keyword">if</span>(!v.length) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
				data.li_attr[i] = v;
				<span class="hljs-keyword">if</span>(i === <span class="hljs-string">'id'</span>) {
					data.id = v.toString();
				}
			});
			tmp = d.children(<span class="hljs-string">'a'</span>).eq(<span class="hljs-number">0</span>);
			<span class="hljs-keyword">if</span>(tmp.length) {
				tmp = $.vakata.attributes(tmp, <span class="hljs-literal">true</span>);
				$.each(tmp, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
					v = $.trim(v);
					<span class="hljs-keyword">if</span>(v.length) {
						data.a_attr[i] = v;
					}
				});
			}
			tmp = d.children(<span class="hljs-string">"a:eq(0)"</span>).length ? d.children(<span class="hljs-string">"a:eq(0)"</span>).clone() : d.clone();
			tmp.children(<span class="hljs-string">"ins, i, ul"</span>).remove();
			tmp = tmp.html();
			tmp = $(<span class="hljs-string">'&lt;div /&gt;'</span>).html(tmp);
			data.text = <span class="hljs-keyword">this</span>.settings.core.force_text ? tmp.text() : tmp.html();
			tmp = d.data();
			data.data = tmp ? $.extend(<span class="hljs-literal">true</span>, {}, tmp) : <span class="hljs-literal">null</span>;
			data.state.opened = d.hasClass(<span class="hljs-string">'jstree-open'</span>);
			data.state.selected = d.children(<span class="hljs-string">'a'</span>).hasClass(<span class="hljs-string">'jstree-clicked'</span>);
			data.state.disabled = d.children(<span class="hljs-string">'a'</span>).hasClass(<span class="hljs-string">'jstree-disabled'</span>);
			<span class="hljs-keyword">if</span>(data.data &amp;&amp; data.data.jstree) {
				<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> data.data.jstree) {
					<span class="hljs-keyword">if</span>(data.data.jstree.hasOwnProperty(i)) {
						data.state[i] = data.data.jstree[i];
					}
				}
			}
			tmp = d.children(<span class="hljs-string">"a"</span>).children(<span class="hljs-string">".jstree-themeicon"</span>);
			<span class="hljs-keyword">if</span>(tmp.length) {
				data.icon = tmp.hasClass(<span class="hljs-string">'jstree-themeicon-hidden'</span>) ? <span class="hljs-literal">false</span> : tmp.attr(<span class="hljs-string">'rel'</span>);
			}
			<span class="hljs-keyword">if</span>(data.state.icon) {
				data.icon = data.state.icon;
			}
			tmp = d.children(<span class="hljs-string">"ul"</span>).children(<span class="hljs-string">"li"</span>);
			<span class="hljs-keyword">do</span> {
				tid = <span class="hljs-string">'j'</span> + <span class="hljs-keyword">this</span>._id + <span class="hljs-string">'_'</span> + (++<span class="hljs-keyword">this</span>._cnt);
			} <span class="hljs-keyword">while</span>(m[tid]);
			data.id = data.li_attr.id ? data.li_attr.id.toString() : tid;
			<span class="hljs-keyword">if</span>(tmp.length) {
				tmp.each($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
					c = <span class="hljs-keyword">this</span>._parse_model_from_html($(v), data.id, ps);
					e = <span class="hljs-keyword">this</span>._model.data[c];
					data.children.push(c);
					<span class="hljs-keyword">if</span>(e.children_d.length) {
						data.children_d = data.children_d.concat(e.children_d);
					}
				}, <span class="hljs-keyword">this</span>));
				data.children_d = data.children_d.concat(data.children);
			}
			<span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">if</span>(d.hasClass(<span class="hljs-string">'jstree-closed'</span>)) {
					data.state.loaded = <span class="hljs-literal">false</span>;
				}
			}
			<span class="hljs-keyword">if</span>(data.li_attr[<span class="hljs-string">'class'</span>]) {
				data.li_attr[<span class="hljs-string">'class'</span>] = data.li_attr[<span class="hljs-string">'class'</span>].replace(<span class="hljs-string">'jstree-closed'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'jstree-open'</span>,<span class="hljs-string">''</span>);
			}
			<span class="hljs-keyword">if</span>(data.a_attr[<span class="hljs-string">'class'</span>]) {
				data.a_attr[<span class="hljs-string">'class'</span>] = data.a_attr[<span class="hljs-string">'class'</span>].replace(<span class="hljs-string">'jstree-clicked'</span>,<span class="hljs-string">''</span>).replace(<span class="hljs-string">'jstree-disabled'</span>,<span class="hljs-string">''</span>);
			}
			m[data.id] = data;
			<span class="hljs-keyword">if</span>(data.state.selected) {
				<span class="hljs-keyword">this</span>._data.core.selected.push(data.id);
			}
			<span class="hljs-keyword">return</span> data.id;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _parse_model_from_flat_json(d [, p, ps])</span></p>
<p>parses a node from a JSON object (used when dealing with flat data, which has no nesting of children, but has id and parent properties) and appends it to the in memory tree model. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>d must be an Object.</strong><br/>(the JSON object to parse)</p>
</li>
<li><p><strong>p must be a String.</strong><br/>(the parent ID)</p>
</li>
<li><p><strong>ps must be an Array.</strong><br/>(list of all parents)</p>
</li>
</ul>
<p><strong>Returns a String</strong><br/>(the ID of the object added to the model)</p></div></div><div class="code"><div class="wrapper">		_parse_model_from_flat_json : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d, p, ps)</span> {</span>
			<span class="hljs-keyword">if</span>(!ps) { ps = []; }
			<span class="hljs-keyword">else</span> { ps = ps.concat(); }
			<span class="hljs-keyword">if</span>(p) { ps.unshift(p); }
			<span class="hljs-keyword">var</span> tid = d.id.toString(),
				m = <span class="hljs-keyword">this</span>._model.data,
				df = <span class="hljs-keyword">this</span>._model.default_state,
				i, j, c, e,
				tmp = {
					id			: tid,
					text		: d.text || <span class="hljs-string">''</span>,
					icon		: d.icon !== <span class="hljs-literal">undefined</span> ? d.icon : <span class="hljs-literal">true</span>,
					parent		: p,
					parents		: ps,
					children	: d.children || [],
					children_d	: d.children_d || [],
					data		: d.data,
					state		: { },
					li_attr		: { id : <span class="hljs-literal">false</span> },
					a_attr		: { href : <span class="hljs-string">'#'</span> },
					original	: <span class="hljs-literal">false</span>
				};
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> df) {
				<span class="hljs-keyword">if</span>(df.hasOwnProperty(i)) {
					tmp.state[i] = df[i];
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.data &amp;&amp; d.data.jstree &amp;&amp; d.data.jstree.icon) {
				tmp.icon = d.data.jstree.icon;
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.data) {
				tmp.data = d.data;
				<span class="hljs-keyword">if</span>(d.data.jstree) {
					<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> d.data.jstree) {
						<span class="hljs-keyword">if</span>(d.data.jstree.hasOwnProperty(i)) {
							tmp.state[i] = d.data.jstree[i];
						}
					}
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.state === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.state) {
					<span class="hljs-keyword">if</span>(d.state.hasOwnProperty(i)) {
						tmp.state[i] = d.state[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.li_attr === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.li_attr) {
					<span class="hljs-keyword">if</span>(d.li_attr.hasOwnProperty(i)) {
						tmp.li_attr[i] = d.li_attr[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(!tmp.li_attr.id) {
				tmp.li_attr.id = tid;
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.a_attr === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.a_attr) {
					<span class="hljs-keyword">if</span>(d.a_attr.hasOwnProperty(i)) {
						tmp.a_attr[i] = d.a_attr[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.children &amp;&amp; d.children === <span class="hljs-literal">true</span>) {
				tmp.state.loaded = <span class="hljs-literal">false</span>;
				tmp.children = [];
				tmp.children_d = [];
			}
			m[tmp.id] = tmp;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.children.length; i &lt; j; i++) {
				c = <span class="hljs-keyword">this</span>._parse_model_from_flat_json(m[tmp.children[i]], tmp.id, ps);
				e = m[c];
				tmp.children_d.push(c);
				<span class="hljs-keyword">if</span>(e.children_d.length) {
					tmp.children_d = tmp.children_d.concat(e.children_d);
				}
			}
			<span class="hljs-keyword">delete</span> d.data;
			<span class="hljs-keyword">delete</span> d.children;
			m[tmp.id].original = d;
			<span class="hljs-keyword">if</span>(tmp.state.selected) {
				<span class="hljs-keyword">this</span>._data.core.selected.push(tmp.id);
			}
			<span class="hljs-keyword">return</span> tmp.id;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _parse_model_from_json(d [, p, ps])</span></p>
<p>parses a node from a JSON object and appends it to the in memory tree model. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>d must be an Object.</strong><br/>(the JSON object to parse)</p>
</li>
<li><p><strong>p must be a String.</strong><br/>(the parent ID)</p>
</li>
<li><p><strong>ps must be an Array.</strong><br/>(list of all parents)</p>
</li>
</ul>
<p><strong>Returns a String</strong><br/>(the ID of the object added to the model)</p></div></div><div class="code"><div class="wrapper">		_parse_model_from_json : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d, p, ps)</span> {</span>
			<span class="hljs-keyword">if</span>(!ps) { ps = []; }
			<span class="hljs-keyword">else</span> { ps = ps.concat(); }
			<span class="hljs-keyword">if</span>(p) { ps.unshift(p); }
			<span class="hljs-keyword">var</span> tid = <span class="hljs-literal">false</span>, i, j, c, e, m = <span class="hljs-keyword">this</span>._model.data, df = <span class="hljs-keyword">this</span>._model.default_state, tmp;
			<span class="hljs-keyword">do</span> {
				tid = <span class="hljs-string">'j'</span> + <span class="hljs-keyword">this</span>._id + <span class="hljs-string">'_'</span> + (++<span class="hljs-keyword">this</span>._cnt);
			} <span class="hljs-keyword">while</span>(m[tid]);

			tmp = {
				id			: <span class="hljs-literal">false</span>,
				text		: <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">'string'</span> ? d : <span class="hljs-string">''</span>,
				icon		: <span class="hljs-keyword">typeof</span> d === <span class="hljs-string">'object'</span> &amp;&amp; d.icon !== <span class="hljs-literal">undefined</span> ? d.icon : <span class="hljs-literal">true</span>,
				parent		: p,
				parents		: ps,
				children	: [],
				children_d	: [],
				data		: <span class="hljs-literal">null</span>,
				state		: { },
				li_attr		: { id : <span class="hljs-literal">false</span> },
				a_attr		: { href : <span class="hljs-string">'#'</span> },
				original	: <span class="hljs-literal">false</span>
			};
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> df) {
				<span class="hljs-keyword">if</span>(df.hasOwnProperty(i)) {
					tmp.state[i] = df[i];
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.id) { tmp.id = d.id.toString(); }
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.text) { tmp.text = d.text; }
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.data &amp;&amp; d.data.jstree &amp;&amp; d.data.jstree.icon) {
				tmp.icon = d.data.jstree.icon;
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.data) {
				tmp.data = d.data;
				<span class="hljs-keyword">if</span>(d.data.jstree) {
					<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> d.data.jstree) {
						<span class="hljs-keyword">if</span>(d.data.jstree.hasOwnProperty(i)) {
							tmp.state[i] = d.data.jstree[i];
						}
					}
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.state === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.state) {
					<span class="hljs-keyword">if</span>(d.state.hasOwnProperty(i)) {
						tmp.state[i] = d.state[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.li_attr === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.li_attr) {
					<span class="hljs-keyword">if</span>(d.li_attr.hasOwnProperty(i)) {
						tmp.li_attr[i] = d.li_attr[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(tmp.li_attr.id &amp;&amp; !tmp.id) {
				tmp.id = tmp.li_attr.id.toString();
			}
			<span class="hljs-keyword">if</span>(!tmp.id) {
				tmp.id = tid;
			}
			<span class="hljs-keyword">if</span>(!tmp.li_attr.id) {
				tmp.li_attr.id = tmp.id;
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; <span class="hljs-keyword">typeof</span> d.a_attr === <span class="hljs-string">'object'</span>) {
				<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> d.a_attr) {
					<span class="hljs-keyword">if</span>(d.a_attr.hasOwnProperty(i)) {
						tmp.a_attr[i] = d.a_attr[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.children &amp;&amp; d.children.length) {
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = d.children.length; i &lt; j; i++) {
					c = <span class="hljs-keyword">this</span>._parse_model_from_json(d.children[i], tmp.id, ps);
					e = m[c];
					tmp.children.push(c);
					<span class="hljs-keyword">if</span>(e.children_d.length) {
						tmp.children_d = tmp.children_d.concat(e.children_d);
					}
				}
				tmp.children_d = tmp.children_d.concat(tmp.children);
			}
			<span class="hljs-keyword">if</span>(d &amp;&amp; d.children &amp;&amp; d.children === <span class="hljs-literal">true</span>) {
				tmp.state.loaded = <span class="hljs-literal">false</span>;
				tmp.children = [];
				tmp.children_d = [];
			}
			<span class="hljs-keyword">delete</span> d.data;
			<span class="hljs-keyword">delete</span> d.children;
			tmp.original = d;
			m[tmp.id] = tmp;
			<span class="hljs-keyword">if</span>(tmp.state.selected) {
				<span class="hljs-keyword">this</span>._data.core.selected.push(tmp.id);
			}
			<span class="hljs-keyword">return</span> tmp.id;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _redraw() and trigger redraw.jstree</span></p>
<p>redraws all nodes that need to be redrawn. Used internally.</p></div></div><div class="code"><div class="wrapper">		_redraw : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> nodes = <span class="hljs-keyword">this</span>._model.force_full_redraw ? <span class="hljs-keyword">this</span>._model.data[<span class="hljs-string">'#'</span>].children.concat([]) : <span class="hljs-keyword">this</span>._model.changed.concat([]),
				f = document.createElement(<span class="hljs-string">'UL'</span>), tmp, i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = nodes.length; i &lt; j; i++) {
				tmp = <span class="hljs-keyword">this</span>.redraw_node(nodes[i], <span class="hljs-literal">true</span>, <span class="hljs-keyword">this</span>._model.force_full_redraw);
				<span class="hljs-keyword">if</span>(tmp &amp;&amp; <span class="hljs-keyword">this</span>._model.force_full_redraw) {
					f.appendChild(tmp);
				}
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.force_full_redraw) {
				f.className = <span class="hljs-keyword">this</span>.get_container_ul()[<span class="hljs-number">0</span>].className;
				<span class="hljs-keyword">this</span>.element.empty().append(f);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>this.get_container_ul()[0].appendChild(f);</p></div></div><div class="code"><div class="wrapper">			}
			<span class="hljs-keyword">this</span>._model.force_full_redraw = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>._model.changed = [];</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name redraw.jstree</span></p>
<p>triggered after nodes are redrawn</p>
<p>Parameters:</p>
<ul>
<li><strong>nodes must be an array.</strong><br/>(the redrawn nodes)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'redraw'</span>, { <span class="hljs-string">"nodes"</span> : nodes });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name redraw([full])</span></p>
<p>redraws all nodes that need to be redrawn or optionally - the whole tree</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a Boolean.</strong><br/>(if set to <code>true</code> all nodes are redrawn.)</li>
</ul></div></div><div class="code"><div class="wrapper">		redraw : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">if</span>(full) {
				<span class="hljs-keyword">this</span>._model.force_full_redraw = <span class="hljs-literal">true</span>;
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if(this._model.redraw_timeout) {
clearTimeout(this._model.redraw_timeout);</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-comment">//</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>this._model.redraw_timeout = setTimeout($.proxy(this._redraw, this),0);</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>._redraw();
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name redraw_node(node, deep, is_callback)</span></p>
<p>redraws a single node. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be a mixed.</strong><br/>(the node to redraw)</p>
</li>
<li><p><strong>deep must be a Boolean.</strong><br/>(should child nodes be redrawn too)</p>
</li>
<li><p><strong>is_callback must be a Boolean.</strong><br/>(is this a recursion call)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		redraw_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(node, deep, is_callback)</span> {</span>
			<span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">this</span>.get_node(node),
				par = <span class="hljs-literal">false</span>,
				ind = <span class="hljs-literal">false</span>,
				old = <span class="hljs-literal">false</span>,
				i = <span class="hljs-literal">false</span>,
				j = <span class="hljs-literal">false</span>,
				k = <span class="hljs-literal">false</span>,
				c = <span class="hljs-string">''</span>,
				d = document,
				m = <span class="hljs-keyword">this</span>._model.data,
				f = <span class="hljs-literal">false</span>,
				s = <span class="hljs-literal">false</span>,
				tmp = <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">if</span>(!obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(obj.id === <span class="hljs-string">'#'</span>) {  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.redraw(<span class="hljs-literal">true</span>); }
			deep = deep || obj.children.length === <span class="hljs-number">0</span>;
			node = !document.querySelector ? document.getElementById(obj.id) : <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].querySelector(<span class="hljs-string">'#'</span> + (<span class="hljs-string">"0123456789"</span>.indexOf(obj.id[<span class="hljs-number">0</span>]) !== -<span class="hljs-number">1</span> ? <span class="hljs-string">'\\3'</span> + obj.id[<span class="hljs-number">0</span>] + <span class="hljs-string">' '</span> + obj.id.substr(<span class="hljs-number">1</span>).replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>) : obj.id.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>)) ); <span class="hljs-comment">//, this.element);</span>
			<span class="hljs-keyword">if</span>(!node) {
				deep = <span class="hljs-literal">true</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>node = d.createElement(&#39;LI&#39;);</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(!is_callback) {
					par = obj.parent !== <span class="hljs-string">'#'</span> ? $(<span class="hljs-string">'#'</span> + obj.parent.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>), <span class="hljs-keyword">this</span>.element)[<span class="hljs-number">0</span>] : <span class="hljs-literal">null</span>;
					<span class="hljs-keyword">if</span>(par !== <span class="hljs-literal">null</span> &amp;&amp; (!par || !m[obj.parent].state.opened)) {
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}
					ind = $.inArray(obj.id, par === <span class="hljs-literal">null</span> ? m[<span class="hljs-string">'#'</span>].children : m[obj.parent].children);
				}
			}
			<span class="hljs-keyword">else</span> {
				node = $(node);
				<span class="hljs-keyword">if</span>(!is_callback) {
					par = node.parent().parent()[<span class="hljs-number">0</span>];
					<span class="hljs-keyword">if</span>(par === <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>]) {
						par = <span class="hljs-literal">null</span>;
					}
					ind = node.index();
				}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>m[obj.id].data = node.data(); // use only node&#39;s data, no need to touch jquery storage</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(!deep &amp;&amp; obj.children.length &amp;&amp; !node.children(<span class="hljs-string">'.jstree-children'</span>).length) {
					deep = <span class="hljs-literal">true</span>;
				}
				<span class="hljs-keyword">if</span>(!deep) {
					old = node.children(<span class="hljs-string">'.jstree-children'</span>)[<span class="hljs-number">0</span>];
				}
				s = node.attr(<span class="hljs-string">'aria-selected'</span>);
				f = node.children(<span class="hljs-string">'.jstree-anchor'</span>)[<span class="hljs-number">0</span>] === document.activeElement;
				node.remove();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>node = d.createElement(&#39;LI&#39;);
node = node[0];</p></div></div><div class="code"><div class="wrapper">			}
			node = _node.cloneNode(<span class="hljs-literal">true</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>node is DOM, deep is boolean</p></div></div><div class="code"><div class="wrapper">			c = <span class="hljs-string">'jstree-node '</span>;
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> obj.li_attr) {
				<span class="hljs-keyword">if</span>(obj.li_attr.hasOwnProperty(i)) {
					<span class="hljs-keyword">if</span>(i === <span class="hljs-string">'id'</span>) { <span class="hljs-keyword">continue</span>; }
					<span class="hljs-keyword">if</span>(i !== <span class="hljs-string">'class'</span>) {
						node.setAttribute(i, obj.li_attr[i]);
					}
					<span class="hljs-keyword">else</span> {
						c += obj.li_attr[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(s &amp;&amp; s !== <span class="hljs-string">"false"</span>) {
				node.setAttribute(<span class="hljs-string">'aria-selected'</span>, <span class="hljs-literal">true</span>);
			}
			<span class="hljs-keyword">if</span>(obj.state.loaded &amp;&amp; !obj.children.length) {
				c += <span class="hljs-string">' jstree-leaf'</span>;
			}
			<span class="hljs-keyword">else</span> {
				c += obj.state.opened &amp;&amp; obj.state.loaded ? <span class="hljs-string">' jstree-open'</span> : <span class="hljs-string">' jstree-closed'</span>;
				node.setAttribute(<span class="hljs-string">'aria-expanded'</span>, (obj.state.opened &amp;&amp; obj.state.loaded) );
			}
			<span class="hljs-keyword">if</span>(obj.parent !== <span class="hljs-literal">null</span> &amp;&amp; m[obj.parent].children[m[obj.parent].children.length - <span class="hljs-number">1</span>] === obj.id) {
				c += <span class="hljs-string">' jstree-last'</span>;
			}
			node.id = obj.id;
			node.className = c;
			c = ( obj.state.selected ? <span class="hljs-string">' jstree-clicked'</span> : <span class="hljs-string">''</span>) + ( obj.state.disabled ? <span class="hljs-string">' jstree-disabled'</span> : <span class="hljs-string">''</span>);
			<span class="hljs-keyword">for</span>(j <span class="hljs-keyword">in</span> obj.a_attr) {
				<span class="hljs-keyword">if</span>(obj.a_attr.hasOwnProperty(j)) {
					<span class="hljs-keyword">if</span>(j === <span class="hljs-string">'href'</span> &amp;&amp; obj.a_attr[j] === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">continue</span>; }
					<span class="hljs-keyword">if</span>(j !== <span class="hljs-string">'class'</span>) {
						node.childNodes[<span class="hljs-number">1</span>].setAttribute(j, obj.a_attr[j]);
					}
					<span class="hljs-keyword">else</span> {
						c += <span class="hljs-string">' '</span> + obj.a_attr[j];
					}
				}
			}
			<span class="hljs-keyword">if</span>(c.length) {
				node.childNodes[<span class="hljs-number">1</span>].className = <span class="hljs-string">'jstree-anchor '</span> + c;
			}
			<span class="hljs-keyword">if</span>((obj.icon &amp;&amp; obj.icon !== <span class="hljs-literal">true</span>) || obj.icon === <span class="hljs-literal">false</span>) {
				<span class="hljs-keyword">if</span>(obj.icon === <span class="hljs-literal">false</span>) {
					node.childNodes[<span class="hljs-number">1</span>].childNodes[<span class="hljs-number">0</span>].className += <span class="hljs-string">' jstree-themeicon-hidden'</span>;
				}
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(obj.icon.indexOf(<span class="hljs-string">'/'</span>) === -<span class="hljs-number">1</span> &amp;&amp; obj.icon.indexOf(<span class="hljs-string">'.'</span>) === -<span class="hljs-number">1</span>) {
					node.childNodes[<span class="hljs-number">1</span>].childNodes[<span class="hljs-number">0</span>].className += <span class="hljs-string">' '</span> + obj.icon + <span class="hljs-string">' jstree-themeicon-custom'</span>;
				}
				<span class="hljs-keyword">else</span> {
					node.childNodes[<span class="hljs-number">1</span>].childNodes[<span class="hljs-number">0</span>].style.backgroundImage = <span class="hljs-string">'url('</span>+obj.icon+<span class="hljs-string">')'</span>;
					node.childNodes[<span class="hljs-number">1</span>].childNodes[<span class="hljs-number">0</span>].style.backgroundPosition = <span class="hljs-string">'center center'</span>;
					node.childNodes[<span class="hljs-number">1</span>].childNodes[<span class="hljs-number">0</span>].style.backgroundSize = <span class="hljs-string">'auto'</span>;
					node.childNodes[<span class="hljs-number">1</span>].childNodes[<span class="hljs-number">0</span>].className += <span class="hljs-string">' jstree-themeicon-custom'</span>;
				}
			}

			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.core.force_text) {
				node.childNodes[<span class="hljs-number">1</span>].appendChild(d.createTextNode(obj.text));
			}
			<span class="hljs-keyword">else</span> {
				node.childNodes[<span class="hljs-number">1</span>].innerHTML += obj.text;
			}

			<span class="hljs-keyword">if</span>(deep &amp;&amp; obj.children.length &amp;&amp; obj.state.opened &amp;&amp; obj.state.loaded) {
				k = d.createElement(<span class="hljs-string">'UL'</span>);
				k.setAttribute(<span class="hljs-string">'role'</span>, <span class="hljs-string">'group'</span>);
				k.className = <span class="hljs-string">'jstree-children'</span>;
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children.length; i &lt; j; i++) {
					k.appendChild(<span class="hljs-keyword">this</span>.redraw_node(obj.children[i], deep, <span class="hljs-literal">true</span>));
				}
				node.appendChild(k);
			}
			<span class="hljs-keyword">if</span>(old) {
				node.appendChild(old);
			}
			<span class="hljs-keyword">if</span>(!is_callback) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>append back using par / ind</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(!par) {
					par = <span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>];
				}
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = par.childNodes.length; i &lt; j; i++) {
					<span class="hljs-keyword">if</span>(par.childNodes[i] &amp;&amp; par.childNodes[i].className &amp;&amp; par.childNodes[i].className.indexOf(<span class="hljs-string">'jstree-children'</span>) !== -<span class="hljs-number">1</span>) {
						tmp = par.childNodes[i];
						<span class="hljs-keyword">break</span>;
					}
				}
				<span class="hljs-keyword">if</span>(!tmp) {
					tmp = d.createElement(<span class="hljs-string">'UL'</span>);
					tmp.setAttribute(<span class="hljs-string">'role'</span>, <span class="hljs-string">'group'</span>);
					tmp.className = <span class="hljs-string">'jstree-children'</span>;
					par.appendChild(tmp);
				}
				par = tmp;

				<span class="hljs-keyword">if</span>(ind &lt; par.childNodes.length) {
					par.insertBefore(node, par.childNodes[ind]);
				}
				<span class="hljs-keyword">else</span> {
					par.appendChild(node);
				}
				<span class="hljs-keyword">if</span>(f) {
					node.childNodes[<span class="hljs-number">1</span>].focus();
				}
			}
			<span class="hljs-keyword">if</span>(obj.state.opened &amp;&amp; !obj.state.loaded) {
				obj.state.opened = <span class="hljs-literal">false</span>;
				setTimeout($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">this</span>.open_node(obj.id, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>);
				}, <span class="hljs-keyword">this</span>), <span class="hljs-number">0</span>);
			}
			<span class="hljs-keyword">return</span> node;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name open_node(obj [, callback, animation]) and trigger open_node.jstree, after_open.jstree, before_open.jstree</span></p>
<p>opens a node, revaling its children. If the node is not loaded it will be loaded and opened once ready.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to open)</p>
</li>
<li><p><strong>callback must be a Function.</strong><br/>(a function to execute once the node is opened)</p>
</li>
<li><p><strong>animation must be a Number.</strong><br/>(the animation duration in milliseconds when opening the node (overrides the <code>core.animation</code> setting). Use <code>false</code> for no animation.)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		open_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, callback, animation)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, d, t;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.open_node(obj[t1], callback, animation);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			animation = animation === <span class="hljs-literal">undefined</span> ? <span class="hljs-keyword">this</span>.settings.core.animation : animation;
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.is_closed(obj)) {
				<span class="hljs-keyword">if</span>(callback) {
					callback.call(<span class="hljs-keyword">this</span>, obj, <span class="hljs-literal">false</span>);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.is_loaded(obj)) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_loading(obj)) {
					<span class="hljs-keyword">return</span> setTimeout($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">this</span>.open_node(obj, callback, animation);
					}, <span class="hljs-keyword">this</span>), <span class="hljs-number">500</span>);
				}
				<span class="hljs-keyword">this</span>.load_node(obj, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o, ok)</span> {</span>
					<span class="hljs-keyword">return</span> ok ? <span class="hljs-keyword">this</span>.open_node(o, callback, animation) : (callback ? callback.call(<span class="hljs-keyword">this</span>, o, <span class="hljs-literal">false</span>) : <span class="hljs-literal">false</span>);
				});
			}
			<span class="hljs-keyword">else</span> {
				d = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
				t = <span class="hljs-keyword">this</span>;
				<span class="hljs-keyword">if</span>(d.length) {
					<span class="hljs-keyword">if</span>(obj.children.length &amp;&amp; !<span class="hljs-keyword">this</span>._firstChild(d.children(<span class="hljs-string">'.jstree-children'</span>)[<span class="hljs-number">0</span>])) {
						obj.state.opened = <span class="hljs-literal">true</span>;
						<span class="hljs-keyword">this</span>.redraw_node(obj, <span class="hljs-literal">true</span>);
						d = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
					}
					<span class="hljs-keyword">if</span>(!animation) {
						<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'before_open'</span>, { <span class="hljs-string">"node"</span> : obj });
						d[<span class="hljs-number">0</span>].className = d[<span class="hljs-number">0</span>].className.replace(<span class="hljs-string">'jstree-closed'</span>, <span class="hljs-string">'jstree-open'</span>);
						d[<span class="hljs-number">0</span>].setAttribute(<span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">true</span>);
					}
					<span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'before_open'</span>, { <span class="hljs-string">"node"</span> : obj });
						d
							.children(<span class="hljs-string">".jstree-children"</span>).css(<span class="hljs-string">"display"</span>,<span class="hljs-string">"none"</span>).end()
							.removeClass(<span class="hljs-string">"jstree-closed"</span>).addClass(<span class="hljs-string">"jstree-open"</span>).attr(<span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">true</span>)
							.children(<span class="hljs-string">".jstree-children"</span>).stop(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)
								.slideDown(animation, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
									<span class="hljs-keyword">this</span>.style.display = <span class="hljs-string">""</span>;
									t.trigger(<span class="hljs-string">"after_open"</span>, { <span class="hljs-string">"node"</span> : obj });
								});
					}
				}
				obj.state.opened = <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">if</span>(callback) {
					callback.call(<span class="hljs-keyword">this</span>, obj, <span class="hljs-literal">true</span>);
				}
				<span class="hljs-keyword">if</span>(!d.length) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name before_open.jstree</span></p>
<p>triggered when a node is about to be opened (if the node is supposed to be in the DOM, it will be, but it won&#39;t be visible yet)</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the opened node)</li>
</ul></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'before_open'</span>, { <span class="hljs-string">"node"</span> : obj });
				}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name open_node.jstree</span></p>
<p>triggered when a node is opened (if there is an animation it will not be completed yet)</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the opened node)</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'open_node'</span>, { <span class="hljs-string">"node"</span> : obj });
				<span class="hljs-keyword">if</span>(!animation || !d.length) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name after_open.jstree</span></p>
<p>triggered when a node is opened and the animation is complete</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the opened node)</li>
</ul></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"after_open"</span>, { <span class="hljs-string">"node"</span> : obj });
				}
			}
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _open_to(obj)</span></p>
<p>opens every parent of a node (node should be loaded)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node to reveal)</li>
</ul></div></div><div class="code"><div class="wrapper">		_open_to : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">var</span> i, j, p = obj.parents;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.length; i &lt; j; i+=<span class="hljs-number">1</span>) {
				<span class="hljs-keyword">if</span>(i !== <span class="hljs-string">'#'</span>) {
					<span class="hljs-keyword">this</span>.open_node(p[i], <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>);
				}
			}
			<span class="hljs-keyword">return</span> $(<span class="hljs-string">'#'</span> + obj.id.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>), <span class="hljs-keyword">this</span>.element);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name close_node(obj [, animation]) and trigger close_node.jstree, after_close.jstree</span></p>
<p>closes a node, hiding its children</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to close)</p>
</li>
<li><p><strong>animation must be a Number.</strong><br/>(the animation duration in milliseconds when closing the node (overrides the <code>core.animation</code> setting). Use <code>false</code> for no animation.)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		close_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, animation)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, t, d;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.close_node(obj[t1], animation);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_closed(obj)) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			animation = animation === <span class="hljs-literal">undefined</span> ? <span class="hljs-keyword">this</span>.settings.core.animation : animation;
			t = <span class="hljs-keyword">this</span>;
			d = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(d.length) {
				<span class="hljs-keyword">if</span>(!animation) {
					d[<span class="hljs-number">0</span>].className = d[<span class="hljs-number">0</span>].className.replace(<span class="hljs-string">'jstree-open'</span>, <span class="hljs-string">'jstree-closed'</span>);
					d.attr(<span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">false</span>).children(<span class="hljs-string">'.jstree-children'</span>).remove();
				}
				<span class="hljs-keyword">else</span> {
					d
						.children(<span class="hljs-string">".jstree-children"</span>).attr(<span class="hljs-string">"style"</span>,<span class="hljs-string">"display:block !important"</span>).end()
						.removeClass(<span class="hljs-string">"jstree-open"</span>).addClass(<span class="hljs-string">"jstree-closed"</span>).attr(<span class="hljs-string">"aria-expanded"</span>, <span class="hljs-literal">false</span>)
						.children(<span class="hljs-string">".jstree-children"</span>).stop(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>).slideUp(animation, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
							<span class="hljs-keyword">this</span>.style.display = <span class="hljs-string">""</span>;
							d.children(<span class="hljs-string">'.jstree-children'</span>).remove();
							t.trigger(<span class="hljs-string">"after_close"</span>, { <span class="hljs-string">"node"</span> : obj });
						});
				}
			}
			obj.state.opened = <span class="hljs-literal">false</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name close_node.jstree</span></p>
<p>triggered when a node is closed (if there is an animation it will not be complete yet)</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the closed node)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'close_node'</span>,{ <span class="hljs-string">"node"</span> : obj });
			<span class="hljs-keyword">if</span>(!animation || !d.length) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name after_close.jstree</span></p>
<p>triggered when a node is closed and the animation is complete</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the closed node)</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">"after_close"</span>, { <span class="hljs-string">"node"</span> : obj });
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name toggle_node(obj)</span></p>
<p>toggles a node - closing it if it is open, opening it if it is closed</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node to toggle)</li>
</ul></div></div><div class="code"><div class="wrapper">		toggle_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.toggle_node(obj[t1]);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_closed(obj)) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.open_node(obj);
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_open(obj)) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.close_node(obj);
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name open_all([obj, animation, original_obj]) and trigger open_all.jstree</span></p>
<p>opens all nodes within a node (or the tree), revaling their children. If the node is not loaded it will be loaded and opened once ready.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to open recursively, omit to open all nodes in the tree)</p>
</li>
<li><p><strong>animation must be a Number.</strong><br/>(the animation duration in milliseconds when opening the nodes, the default is no animation)</p>
</li>
<li><p><strong>reference must be a jQuery.</strong><br/>(to the node that started the process (internal use))</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		open_all : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, animation, original_obj)</span> {</span>
			<span class="hljs-keyword">if</span>(!obj) { obj = <span class="hljs-string">'#'</span>; }
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> dom = obj.id === <span class="hljs-string">'#'</span> ? <span class="hljs-keyword">this</span>.get_container_ul() : <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>), i, j, _this;
			<span class="hljs-keyword">if</span>(!dom.length) {
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
					<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_closed(<span class="hljs-keyword">this</span>._model.data[obj.children_d[i]])) {
						<span class="hljs-keyword">this</span>._model.data[obj.children_d[i]].state.opened = <span class="hljs-literal">true</span>;
					}
				}
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'open_all'</span>, { <span class="hljs-string">"node"</span> : obj });
			}
			original_obj = original_obj || dom;
			_this = <span class="hljs-keyword">this</span>;
			dom = <span class="hljs-keyword">this</span>.is_closed(obj) ? dom.find(<span class="hljs-string">'.jstree-closed'</span>).addBack() : dom.find(<span class="hljs-string">'.jstree-closed'</span>);
			dom.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				_this.open_node(
					<span class="hljs-keyword">this</span>,
					<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(node, status)</span> {</span> <span class="hljs-keyword">if</span>(status &amp;&amp; <span class="hljs-keyword">this</span>.is_parent(node)) { <span class="hljs-keyword">this</span>.open_all(node, animation, original_obj); } },
					animation || <span class="hljs-number">0</span>
				);
			});
			<span class="hljs-keyword">if</span>(original_obj.find(<span class="hljs-string">'.jstree-closed'</span>).length === <span class="hljs-number">0</span>) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name open_all.jstree</span></p>
<p>triggered when an <code>open_all</code> call completes</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the opened node)</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'open_all'</span>, { <span class="hljs-string">"node"</span> : <span class="hljs-keyword">this</span>.get_node(original_obj) });
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name close_all([obj, animation]) and trigger close_all.jstree</span></p>
<p>closes all nodes within a node (or the tree), revaling their children</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to close recursively, omit to close all nodes in the tree)</p>
</li>
<li><p><strong>animation must be a Number.</strong><br/>(the animation duration in milliseconds when closing the nodes, the default is no animation)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		close_all : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, animation)</span> {</span>
			<span class="hljs-keyword">if</span>(!obj) { obj = <span class="hljs-string">'#'</span>; }
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> dom = obj.id === <span class="hljs-string">'#'</span> ? <span class="hljs-keyword">this</span>.get_container_ul() : <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>),
				_this = <span class="hljs-keyword">this</span>, i, j;
			<span class="hljs-keyword">if</span>(!dom.length) {
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
					<span class="hljs-keyword">this</span>._model.data[obj.children_d[i]].state.opened = <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'close_all'</span>, { <span class="hljs-string">"node"</span> : obj });
			}
			dom = <span class="hljs-keyword">this</span>.is_open(obj) ? dom.find(<span class="hljs-string">'.jstree-open'</span>).addBack() : dom.find(<span class="hljs-string">'.jstree-open'</span>);
			$(dom.get().reverse()).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> _this.close_node(<span class="hljs-keyword">this</span>, animation || <span class="hljs-number">0</span>); });</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name close_all.jstree</span></p>
<p>triggered when an <code>close_all</code> call completes</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the closed node)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'close_all'</span>, { <span class="hljs-string">"node"</span> : obj });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_disabled(obj)</span></p>
<p>checks if a node is disabled (not selectable)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_disabled : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> obj &amp;&amp; obj.state &amp;&amp; obj.state.disabled;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name enable_node(obj) and trigger enable_node.jstree</span></p>
<p>enables a node - so that it can be selected</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node to enable)</li>
</ul></div></div><div class="code"><div class="wrapper">		enable_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.enable_node(obj[t1]);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			obj.state.disabled = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>.get_node(obj,<span class="hljs-literal">true</span>).children(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(<span class="hljs-string">'jstree-disabled'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name enable_node.jstree</span></p>
<p>triggered when an node is enabled</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the enabled node)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'enable_node'</span>, { <span class="hljs-string">'node'</span> : obj });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name disable_node(obj) and trigger disable_node.jstree</span></p>
<p>disables a node - so that it can not be selected</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node to disable)</li>
</ul></div></div><div class="code"><div class="wrapper">		disable_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.disable_node(obj[t1]);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			obj.state.disabled = <span class="hljs-literal">true</span>;
			<span class="hljs-keyword">this</span>.get_node(obj,<span class="hljs-literal">true</span>).children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(<span class="hljs-string">'jstree-disabled'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name disable_node.jstree</span></p>
<p>triggered when an node is disabled</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong><br/>(the disabled node)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'disable_node'</span>, { <span class="hljs-string">'node'</span> : obj });
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name activate_node(obj, e) and trigger activate_node.jstree</span></p>
<p>called when a node is selected by the user. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>e must be an Object.</strong><br/>(the related event)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		activate_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, e)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_disabled(obj)) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>ensure last_clicked is still in the DOM, make it fresh (maybe it was moved?) and make sure it is still selected, if not - make last_clicked the last selected node</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>._data.core.last_clicked = <span class="hljs-keyword">this</span>._data.core.last_clicked &amp;&amp; <span class="hljs-keyword">this</span>._data.core.last_clicked.id !== <span class="hljs-literal">undefined</span> ? <span class="hljs-keyword">this</span>.get_node(<span class="hljs-keyword">this</span>._data.core.last_clicked.id) : <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.last_clicked &amp;&amp; !<span class="hljs-keyword">this</span>._data.core.last_clicked.state.selected) { <span class="hljs-keyword">this</span>._data.core.last_clicked = <span class="hljs-literal">null</span>; }
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>._data.core.last_clicked &amp;&amp; <span class="hljs-keyword">this</span>._data.core.selected.length) { <span class="hljs-keyword">this</span>._data.core.last_clicked = <span class="hljs-keyword">this</span>.get_node(<span class="hljs-keyword">this</span>._data.core.selected[<span class="hljs-keyword">this</span>._data.core.selected.length - <span class="hljs-number">1</span>]); }

			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.settings.core.multiple || (!e.metaKey &amp;&amp; !e.ctrlKey &amp;&amp; !e.shiftKey) || (e.shiftKey &amp;&amp; (!<span class="hljs-keyword">this</span>._data.core.last_clicked || !<span class="hljs-keyword">this</span>.get_parent(obj) || <span class="hljs-keyword">this</span>.get_parent(obj) !== <span class="hljs-keyword">this</span>._data.core.last_clicked.parent ) )) {
				<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.settings.core.multiple &amp;&amp; (e.metaKey || e.ctrlKey || e.shiftKey) &amp;&amp; <span class="hljs-keyword">this</span>.is_selected(obj)) {
					<span class="hljs-keyword">this</span>.deselect_node(obj, <span class="hljs-literal">false</span>, e);
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">this</span>.deselect_all(<span class="hljs-literal">true</span>);
					<span class="hljs-keyword">this</span>.select_node(obj, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, e);
					<span class="hljs-keyword">this</span>._data.core.last_clicked = <span class="hljs-keyword">this</span>.get_node(obj);
				}
			}
			<span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">if</span>(e.shiftKey) {
					<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.get_node(obj).id,
						l = <span class="hljs-keyword">this</span>._data.core.last_clicked.id,
						p = <span class="hljs-keyword">this</span>.get_node(<span class="hljs-keyword">this</span>._data.core.last_clicked.parent).children,
						c = <span class="hljs-literal">false</span>,
						i, j;
					<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.length; i &lt; j; i += <span class="hljs-number">1</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>separate IFs work whem o and l are the same</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">if</span>(p[i] === o) {
							c = !c;
						}
						<span class="hljs-keyword">if</span>(p[i] === l) {
							c = !c;
						}
						<span class="hljs-keyword">if</span>(c || p[i] === o || p[i] === l) {
							<span class="hljs-keyword">this</span>.select_node(p[i], <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, e);
						}
						<span class="hljs-keyword">else</span> {
							<span class="hljs-keyword">this</span>.deselect_node(p[i], <span class="hljs-literal">false</span>, e);
						}
					}
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.is_selected(obj)) {
						<span class="hljs-keyword">this</span>.select_node(obj, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, e);
					}
					<span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">this</span>.deselect_node(obj, <span class="hljs-literal">false</span>, e);
					}
				}
			}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name activate_node.jstree</span></p>
<p>triggered when an node is clicked or intercated with by the user</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'activate_node'</span>, { <span class="hljs-string">'node'</span> : <span class="hljs-keyword">this</span>.get_node(obj) });
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name hover_node(obj) and trigger hover_node.jstree</span></p>
<p>applies the hover state on a node, called when a node is hovered by the user. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">		hover_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(!obj || !obj.length || obj.children(<span class="hljs-string">'.jstree-hovered'</span>).length) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">var</span> o = <span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-hovered'</span>), t = <span class="hljs-keyword">this</span>.element;
			<span class="hljs-keyword">if</span>(o &amp;&amp; o.length) { <span class="hljs-keyword">this</span>.dehover_node(o); }

			obj.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(<span class="hljs-string">'jstree-hovered'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name hover_node.jstree</span></p>
<p>triggered when an node is hovered</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'hover_node'</span>, { <span class="hljs-string">'node'</span> : <span class="hljs-keyword">this</span>.get_node(obj) });
			setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> t.attr(<span class="hljs-string">'aria-activedescendant'</span>, obj[<span class="hljs-number">0</span>].id); obj.attr(<span class="hljs-string">'aria-selected'</span>, <span class="hljs-literal">true</span>); }, <span class="hljs-number">0</span>);
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name dehover_node(obj) and trigger dehover_node.jstree</span></p>
<p>removes the hover state from a nodecalled when a node is no longer hovered by the user. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">		dehover_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(!obj || !obj.length || !obj.children(<span class="hljs-string">'.jstree-hovered'</span>).length) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			obj.attr(<span class="hljs-string">'aria-selected'</span>, <span class="hljs-literal">false</span>).children(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(<span class="hljs-string">'jstree-hovered'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name dehover_node.jstree</span></p>
<p>triggered when an node is no longer hovered</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Object.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'dehover_node'</span>, { <span class="hljs-string">'node'</span> : <span class="hljs-keyword">this</span>.get_node(obj) });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name select_node(obj [, supress_event, prevent_open]) and trigger select_node.jstree, changed.jstree</span></p>
<p>select a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(an array can be used to select multiple nodes)</p>
</li>
<li><p><strong>supress_event must be a Boolean.</strong><br/>(if set to <code>true</code> the <code>changed.jstree</code> event won&#39;t be triggered)</p>
</li>
<li><p><strong>prevent_open must be a Boolean.</strong><br/>(if set to <code>true</code> parents of the selected node won&#39;t be opened)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		select_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, supress_event, prevent_open, e)</span> {</span>
			<span class="hljs-keyword">var</span> dom, t1, t2, th;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.select_node(obj[t1], supress_event, prevent_open, e);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(!obj.state.selected) {
				obj.state.selected = <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">this</span>._data.core.selected.push(obj.id);
				<span class="hljs-keyword">if</span>(!prevent_open) {
					dom = <span class="hljs-keyword">this</span>._open_to(obj);
				}
				<span class="hljs-keyword">if</span>(dom &amp;&amp; dom.length) {
					dom.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(<span class="hljs-string">'jstree-clicked'</span>);
				}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name select_node.jstree</span></p>
<p>triggered when an node is selected</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event (if any) that triggered this select_node)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'select_node'</span>, { <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'event'</span> : e });
				<span class="hljs-keyword">if</span>(!supress_event) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name changed.jstree</span></p>
<p>triggered when selection changes</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>action must be an Object.</strong><br/>(the action that caused the selection to change)</p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event (if any) that triggered this changed event)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'select_node'</span>, <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'event'</span> : e });
				}
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name deselect_node(obj [, supress_event]) and trigger deselect_node.jstree, changed.jstree</span></p>
<p>deselect a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(an array can be used to deselect multiple nodes)</p>
</li>
<li><p><strong>supress_event must be a Boolean.</strong><br/>(if set to <code>true</code> the <code>changed.jstree</code> event won&#39;t be triggered)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		deselect_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, supress_event, e)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, dom;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.deselect_node(obj[t1], supress_event, e);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(obj.state.selected) {
				obj.state.selected = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">this</span>._data.core.selected = $.vakata.array_remove_item(<span class="hljs-keyword">this</span>._data.core.selected, obj.id);
				<span class="hljs-keyword">if</span>(dom.length) {
					dom.children(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(<span class="hljs-string">'jstree-clicked'</span>);
				}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name deselect_node.jstree</span></p>
<p>triggered when an node is deselected</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event (if any) that triggered this deselect_node)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'deselect_node'</span>, { <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'event'</span> : e });
				<span class="hljs-keyword">if</span>(!supress_event) {
					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'deselect_node'</span>, <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'event'</span> : e });
				}
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name select_all([supress_event]) and trigger select_all.jstree, changed.jstree</span></p>
<p>select all nodes in the tree</p>
<p>Parameters:</p>
<ul>
<li><strong>supress_event must be a Boolean.</strong><br/>(if set to <code>true</code> the <code>changed.jstree</code> event won&#39;t be triggered)</li>
</ul></div></div><div class="code"><div class="wrapper">		select_all : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(supress_event)</span> {</span>
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>._data.core.selected.concat([]), i, j;
			<span class="hljs-keyword">this</span>._data.core.selected = <span class="hljs-keyword">this</span>._model.data[<span class="hljs-string">'#'</span>].children_d.concat();
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-keyword">this</span>._data.core.selected.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.core.selected[i]]) {
					<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.core.selected[i]].state.selected = <span class="hljs-literal">true</span>;
				}
			}
			<span class="hljs-keyword">this</span>.redraw(<span class="hljs-literal">true</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name select_all.jstree</span></p>
<p>triggered when all nodes are selected</p>
<p>Parameters:</p>
<ul>
<li><strong>selected must be an Array.</strong><br/>(the current selection)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'select_all'</span>, { <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected });
			<span class="hljs-keyword">if</span>(!supress_event) {
				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'select_all'</span>, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'old_selection'</span> : tmp });
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name deselect_all([supress_event]) and trigger deselect_all.jstree, changed.jstree</span></p>
<p>deselect all selected nodes</p>
<p>Parameters:</p>
<ul>
<li><strong>supress_event must be a Boolean.</strong><br/>(if set to <code>true</code> the <code>changed.jstree</code> event won&#39;t be triggered)</li>
</ul></div></div><div class="code"><div class="wrapper">		deselect_all : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(supress_event)</span> {</span>
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>._data.core.selected.concat([]), i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-keyword">this</span>._data.core.selected.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.core.selected[i]]) {
					<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.core.selected[i]].state.selected = <span class="hljs-literal">false</span>;
				}
			}
			<span class="hljs-keyword">this</span>._data.core.selected = [];
			<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-clicked'</span>).removeClass(<span class="hljs-string">'jstree-clicked'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name deselect_all.jstree</span></p>
<p>triggered when all nodes are deselected</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong><br/>(the previous selection)</p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'deselect_all'</span>, { <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'node'</span> : tmp });
			<span class="hljs-keyword">if</span>(!supress_event) {
				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'deselect_all'</span>, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'old_selection'</span> : tmp });
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_selected(obj)</span></p>
<p>checks if a node is selected</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		is_selected : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">return</span> obj.state.selected;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_selected([full])</span></p>
<p>get an array of all selected nodes</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a mixed.</strong><br/>(if set to <code>true</code> the returned array will consist of the full node objects, otherwise - only IDs will be returned)</li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">		get_selected : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">return</span> full ? $.map(<span class="hljs-keyword">this</span>._data.core.selected, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_node(i); }, <span class="hljs-keyword">this</span>)) : <span class="hljs-keyword">this</span>._data.core.selected;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_top_selected([full])</span></p>
<p>get an array of all top level selected nodes (ignoring children of selected nodes)</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a mixed.</strong><br/>(if set to <code>true</code> the returned array will consist of the full node objects, otherwise - only IDs will be returned)</li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">		get_top_selected : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>.get_selected(<span class="hljs-literal">true</span>),
				obj = {}, i, j, k, l;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
				obj[tmp[i].id] = tmp[i];
			}
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
				<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = tmp[i].children_d.length; k &lt; l; k++) {
					<span class="hljs-keyword">if</span>(obj[tmp[i].children_d[k]]) {
						<span class="hljs-keyword">delete</span> obj[tmp[i].children_d[k]];
					}
				}
			}
			tmp = [];
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> obj) {
				<span class="hljs-keyword">if</span>(obj.hasOwnProperty(i)) {
					tmp.push(i);
				}
			}
			<span class="hljs-keyword">return</span> full ? $.map(tmp, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_node(i); }, <span class="hljs-keyword">this</span>)) : tmp;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_bottom_selected([full])</span></p>
<p>get an array of all bottom level selected nodes (ignoring selected parents)</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a mixed.</strong><br/>(if set to <code>true</code> the returned array will consist of the full node objects, otherwise - only IDs will be returned)</li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">		get_bottom_selected : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>.get_selected(<span class="hljs-literal">true</span>),
				obj = [], i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(!tmp[i].children.length) {
					obj.push(tmp[i].id);
				}
			}
			<span class="hljs-keyword">return</span> full ? $.map(obj, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_node(i); }, <span class="hljs-keyword">this</span>)) : obj;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name get_state()</span></p>
<p>gets the current state of the tree so that it can be restored later with <code>set_state(state)</code>. Used internally.</p>
<p><strong>Returns an Object</strong></p></div></div><div class="code"><div class="wrapper">		get_state : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> state	= {
				<span class="hljs-string">'core'</span> : {
					<span class="hljs-string">'open'</span> : [],
					<span class="hljs-string">'scroll'</span> : {
						<span class="hljs-string">'left'</span> : <span class="hljs-keyword">this</span>.element.scrollLeft(),
						<span class="hljs-string">'top'</span> : <span class="hljs-keyword">this</span>.element.scrollTop()
					},</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>!
&#39;themes&#39; : {
    &#39;name&#39; : this.get_theme(),
    &#39;icons&#39; : this._data.core.themes.icons,
    &#39;dots&#39; : this._data.core.themes.dots
},</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-string">'selected'</span> : []
				}
			}, i;
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>._model.data) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data.hasOwnProperty(i)) {
					<span class="hljs-keyword">if</span>(i !== <span class="hljs-string">'#'</span>) {
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[i].state.opened) {
							state.core.open.push(i);
						}
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[i].state.selected) {
							state.core.selected.push(i);
						}
					}
				}
			}
			<span class="hljs-keyword">return</span> state;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name set_state(state [, callback]) and trigger set_state.jstree</span></p>
<p>sets the state of the tree. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>state must be an Object.</strong><br/>(the state to restore)</p>
</li>
<li><p><strong>callback must be a Function.</strong><br/>(an optional function to execute once the state is restored.)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		set_state : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(state, callback)</span> {</span>
			<span class="hljs-keyword">if</span>(state) {
				<span class="hljs-keyword">if</span>(state.core) {
					<span class="hljs-keyword">var</span> res, n, t, _this;
					<span class="hljs-keyword">if</span>(state.core.open) {
						<span class="hljs-keyword">if</span>(!$.isArray(state.core.open)) {
							<span class="hljs-keyword">delete</span> state.core.open;
							<span class="hljs-keyword">this</span>.set_state(state, callback);
							<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
						}
						res = <span class="hljs-literal">true</span>;
						n = <span class="hljs-literal">false</span>;
						t = <span class="hljs-keyword">this</span>;
						$.each(state.core.open.concat([]), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
							n = t.get_node(v);
							<span class="hljs-keyword">if</span>(n) {
								<span class="hljs-keyword">if</span>(t.is_loaded(v)) {
									<span class="hljs-keyword">if</span>(t.is_closed(v)) {
										t.open_node(v, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>);
									}
									<span class="hljs-keyword">if</span>(state &amp;&amp; state.core &amp;&amp; state.core.open) {
										$.vakata.array_remove_item(state.core.open, v);
									}
								}
								<span class="hljs-keyword">else</span> {
									<span class="hljs-keyword">if</span>(!t.is_loading(v)) {
										t.open_node(v, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o, s)</span> {</span>
											<span class="hljs-keyword">if</span>(!s &amp;&amp; state &amp;&amp; state.core &amp;&amp; state.core.open) {
												$.vakata.array_remove_item(state.core.open, o.id);
											}
											<span class="hljs-keyword">this</span>.set_state(state, callback);
										}, t), <span class="hljs-number">0</span>);
									}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>there will be some async activity - so wait for it</p></div></div><div class="code"><div class="wrapper">									res = <span class="hljs-literal">false</span>;
								}
							}
						});
						<span class="hljs-keyword">if</span>(res) {
							<span class="hljs-keyword">delete</span> state.core.open;
							<span class="hljs-keyword">this</span>.set_state(state, callback);
						}
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}
					<span class="hljs-keyword">if</span>(state.core.scroll) {
						<span class="hljs-keyword">if</span>(state.core.scroll &amp;&amp; state.core.scroll.left !== <span class="hljs-literal">undefined</span>) {
							<span class="hljs-keyword">this</span>.element.scrollLeft(state.core.scroll.left);
						}
						<span class="hljs-keyword">if</span>(state.core.scroll &amp;&amp; state.core.scroll.top !== <span class="hljs-literal">undefined</span>) {
							<span class="hljs-keyword">this</span>.element.scrollTop(state.core.scroll.top);
						}
						<span class="hljs-keyword">delete</span> state.core.scroll;
						<span class="hljs-keyword">this</span>.set_state(state, callback);
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>!
if(state.core.themes) {
    if(state.core.themes.name) {
        this.set_theme(state.core.themes.name);
    }
    if(typeof state.core.themes.dots !== &#39;undefined&#39;) {
        this<a href=""> state.core.themes.dots ? &quot;show_dots&quot; : &quot;hide_dots&quot; </a>;
    }
    if(typeof state.core.themes.icons !== &#39;undefined&#39;) {
        this<a href=""> state.core.themes.icons ? &quot;show_icons&quot; : &quot;hide_icons&quot; </a>;
    }
    delete state.core.themes;
    delete state.core.open;
    this.set_state(state, callback);
    return false;
}</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">if</span>(state.core.selected) {
						_this = <span class="hljs-keyword">this</span>;
						<span class="hljs-keyword">this</span>.deselect_all();
						$.each(state.core.selected, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
							_this.select_node(v);
						});
						<span class="hljs-keyword">delete</span> state.core.selected;
						<span class="hljs-keyword">this</span>.set_state(state, callback);
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}
					<span class="hljs-keyword">if</span>($.isEmptyObject(state.core)) {
						<span class="hljs-keyword">delete</span> state.core;
						<span class="hljs-keyword">this</span>.set_state(state, callback);
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}
				}
				<span class="hljs-keyword">if</span>($.isEmptyObject(state)) {
					state = <span class="hljs-literal">null</span>;
					<span class="hljs-keyword">if</span>(callback) { callback.call(<span class="hljs-keyword">this</span>); }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name set_state.jstree</span></p>
<p>triggered when a <code>set_state</code> call completes</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'set_state'</span>);
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name refresh() and trigger refresh.jstree</span></p>
<p>refreshes the tree - all nodes are reloaded with calls to <code>load_node</code>.</p>
<p>Parameters:</p>
<ul>
<li><strong>skip_loading must be a Boolean.</strong><br/>(an option to skip showing the loading indicator)</li>
</ul></div></div><div class="code"><div class="wrapper">		refresh : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(skip_loading)</span> {</span>
			<span class="hljs-keyword">this</span>._data.core.state = <span class="hljs-keyword">this</span>.get_state();
			<span class="hljs-keyword">this</span>._cnt = <span class="hljs-number">0</span>;
			<span class="hljs-keyword">this</span>._model.data = {
				<span class="hljs-string">'#'</span> : {
					id : <span class="hljs-string">'#'</span>,
					parent : <span class="hljs-literal">null</span>,
					parents : [],
					children : [],
					children_d : [],
					state : { loaded : <span class="hljs-literal">false</span> }
				}
			};
			<span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>.get_container_ul()[<span class="hljs-number">0</span>].className;
			<span class="hljs-keyword">if</span>(!skip_loading) {
				<span class="hljs-keyword">this</span>.element.html(<span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"ul class='"</span>+c+<span class="hljs-string">"'&gt;&lt;"</span>+<span class="hljs-string">"li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'&gt;&lt;i class='jstree-icon jstree-ocl'&gt;&lt;/i&gt;&lt;"</span>+<span class="hljs-string">"a class='jstree-anchor' href='#'&gt;&lt;i class='jstree-icon jstree-themeicon-hidden'&gt;&lt;/i&gt;"</span> + <span class="hljs-keyword">this</span>.get_string(<span class="hljs-string">"Loading ..."</span>) + <span class="hljs-string">"&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;"</span>);
			}
			<span class="hljs-keyword">this</span>.load_node(<span class="hljs-string">'#'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o, s)</span> {</span>
				<span class="hljs-keyword">if</span>(s) {
					<span class="hljs-keyword">this</span>.get_container_ul()[<span class="hljs-number">0</span>].className = c;
					<span class="hljs-keyword">this</span>.set_state($.extend(<span class="hljs-literal">true</span>, {}, <span class="hljs-keyword">this</span>._data.core.state), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name refresh.jstree</span></p>
<p>triggered when a <code>refresh</code> call completes</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'refresh'</span>);
					});
				}
				<span class="hljs-keyword">this</span>._data.core.state = <span class="hljs-literal">null</span>;
			});
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name refresh_node(obj) and trigger refresh_node.jstree</span></p>
<p>refreshes a node in the tree (reload its children) all opened nodes inside that node are reloaded with calls to <code>load_node</code>.</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node)</li>
</ul></div></div><div class="code"><div class="wrapper">		refresh_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> opened = [], to_load = [], s = <span class="hljs-keyword">this</span>._data.core.selected.concat([]);
			to_load.push(obj.id);
			<span class="hljs-keyword">if</span>(obj.state.opened === <span class="hljs-literal">true</span>) { opened.push(obj.id); }
			<span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>).find(<span class="hljs-string">'.jstree-open'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> opened.push(<span class="hljs-keyword">this</span>.id); });
			<span class="hljs-keyword">this</span>._load_nodes(to_load, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(nodes)</span> {</span>
				<span class="hljs-keyword">this</span>.open_node(opened, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>);
				<span class="hljs-keyword">this</span>.select_node(<span class="hljs-keyword">this</span>._data.core.selected);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name refresh_node.jstree</span></p>
<p>triggered when a node is refreshed</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong><br/>(- the refreshed node)</p>
</li>
<li><p><strong>nodes must be an Array.</strong><br/>(- an array of the IDs of the nodes that were reloaded)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'refresh_node'</span>, { <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'nodes'</span> : nodes });
			}, <span class="hljs-keyword">this</span>));
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name set_id(obj, id)</span></p>
<p>set (change) the ID of a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>id must be a String.</strong><br/>(the new ID)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		set_id : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, id)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> i, j, m = <span class="hljs-keyword">this</span>._model.data;
			id = id.toString();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>update parents (replace current ID with new one in children and children_d)</p></div></div><div class="code"><div class="wrapper">			m[obj.parent].children[$.inArray(obj.id, m[obj.parent].children)] = id;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.parents.length; i &lt; j; i++) {
				m[obj.parents[i]].children_d[$.inArray(obj.id, m[obj.parents[i]].children_d)] = id;
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>update children (replace current ID with new one in parent and parents)</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children.length; i &lt; j; i++) {
				m[obj.children[i]].parent = id;
			}
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
				m[obj.children_d[i]].parents[$.inArray(obj.id, m[obj.children_d[i]].parents)] = id;
			}
			i = $.inArray(obj.id, <span class="hljs-keyword">this</span>._data.core.selected);
			<span class="hljs-keyword">if</span>(i !== -<span class="hljs-number">1</span>) { <span class="hljs-keyword">this</span>._data.core.selected[i] = id; }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>update model and obj itself (obj.id, this._model.data[KEY])</p></div></div><div class="code"><div class="wrapper">			i = <span class="hljs-keyword">this</span>.get_node(obj.id, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(i) {
				i.attr(<span class="hljs-string">'id'</span>, id);
			}
			<span class="hljs-keyword">delete</span> m[obj.id];
			obj.id = id;
			m[id] = obj;
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_text(obj)</span></p>
<p>get the text value of a node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node)</li>
</ul>
<p><strong>Returns a String</strong></p></div></div><div class="code"><div class="wrapper">		get_text : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> (!obj || obj.id === <span class="hljs-string">'#'</span>) ? <span class="hljs-literal">false</span> : obj.text;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name set_text(obj, val) and trigger set_text.jstree</span></p>
<p>set the text value of a node. Used internally, please use <code>rename_node(obj, val)</code>.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node, you can pass an array to set the text on multiple nodes)</p>
</li>
<li><p><strong>val must be a String.</strong><br/>(the new text value)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		set_text : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, val)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.set_text(obj[t1], val);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			obj.text = val;
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>).length) {
				<span class="hljs-keyword">this</span>.redraw_node(obj.id);
			}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name set_text.jstree</span></p>
<p>triggered when a node text value is changed</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be an Object.</strong></p>
</li>
<li><p><strong>text must be a String.</strong><br/>(the new value)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'set_text'</span>,{ <span class="hljs-string">"obj"</span> : obj, <span class="hljs-string">"text"</span> : val });
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_json([obj, options])</span></p>
<p>gets a JSON representation of a node (or the whole tree)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>options must be an Object.</strong></p>
<ul>
<li><p><strong>options.no_state must be a Boolean.</strong><br/>(do not return state information)</p>
</li>
<li><p><strong>options.no_id must be a Boolean.</strong><br/>(do not return ID)</p>
</li>
<li><p><strong>options.no_children must be a Boolean.</strong><br/>(do not include children)</p>
</li>
<li><p><strong>options.no_data must be a Boolean.</strong><br/>(do not include node data)</p>
</li>
<li><p><strong>options.flat must be a Boolean.</strong><br/>(return flat JSON instead of nested)</p>
</li>
</ul>
</li>
</ul>
<p><strong>Returns an Object</strong></p></div></div><div class="code"><div class="wrapper">		get_json : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, options, flat)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj || <span class="hljs-string">'#'</span>);
			<span class="hljs-keyword">if</span>(!obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(options &amp;&amp; options.flat &amp;&amp; !flat) { flat = []; }
			<span class="hljs-keyword">var</span> tmp = {
				<span class="hljs-string">'id'</span> : obj.id,
				<span class="hljs-string">'text'</span> : obj.text,
				<span class="hljs-string">'icon'</span> : <span class="hljs-keyword">this</span>.get_icon(obj),
				<span class="hljs-string">'li_attr'</span> : obj.li_attr,
				<span class="hljs-string">'a_attr'</span> : obj.a_attr,
				<span class="hljs-string">'state'</span> : {},
				<span class="hljs-string">'data'</span> : options &amp;&amp; options.no_data ? <span class="hljs-literal">false</span> : obj.data</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>( this.get_node(obj, true).length ? this.get_node(obj, true).data() : obj.data ),</p></div></div><div class="code"><div class="wrapper">			}, i, j;
			<span class="hljs-keyword">if</span>(options &amp;&amp; options.flat) {
				tmp.parent = obj.parent;
			}
			<span class="hljs-keyword">else</span> {
				tmp.children = [];
			}
			<span class="hljs-keyword">if</span>(!options || !options.no_state) {
				<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> obj.state) {
					<span class="hljs-keyword">if</span>(obj.state.hasOwnProperty(i)) {
						tmp.state[i] = obj.state[i];
					}
				}
			}
			<span class="hljs-keyword">if</span>(options &amp;&amp; options.no_id) {
				<span class="hljs-keyword">delete</span> tmp.id;
				<span class="hljs-keyword">if</span>(tmp.li_attr &amp;&amp; tmp.li_attr.id) {
					<span class="hljs-keyword">delete</span> tmp.li_attr.id;
				}
			}
			<span class="hljs-keyword">if</span>(options &amp;&amp; options.flat &amp;&amp; obj.id !== <span class="hljs-string">'#'</span>) {
				flat.push(tmp);
			}
			<span class="hljs-keyword">if</span>(!options || !options.no_children) {
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children.length; i &lt; j; i++) {
					<span class="hljs-keyword">if</span>(options &amp;&amp; options.flat) {
						<span class="hljs-keyword">this</span>.get_json(obj.children[i], options, flat);
					}
					<span class="hljs-keyword">else</span> {
						tmp.children.push(<span class="hljs-keyword">this</span>.get_json(obj.children[i], options));
					}
				}
			}
			<span class="hljs-keyword">return</span> options &amp;&amp; options.flat ? flat : (obj.id === <span class="hljs-string">'#'</span> ? tmp.children : tmp);
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name create_node([obj, node, pos, callback, is_loaded]) and trigger model.jstree, create_node.jstree</span></p>
<p>create a new node (do not confuse with load_node)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>par must be a mixed.</strong><br/>(the parent node (to create a root node use either &quot;#&quot; (string) or <code>null</code>))</p>
</li>
<li><p><strong>node must be a mixed.</strong><br/>(the data for the new node (a valid JSON object, or a simple string with the name))</p>
</li>
<li><p><strong>pos must be a mixed.</strong><br/>(the index at which to insert the node, &quot;first&quot; and &quot;last&quot; are also supported, default is &quot;last&quot;)</p>
</li>
<li><p><strong>callback must be a Function.</strong><br/>(a function to be called once the node is created)</p>
</li>
<li><p><strong>is_loaded must be a Boolean.</strong><br/>(internal argument indicating if the parent node was succesfully loaded)</p>
</li>
</ul>
<p><strong>Returns a String</strong><br/>(the ID of the newly create node)</p></div></div><div class="code"><div class="wrapper">		create_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(par, node, pos, callback, is_loaded)</span> {</span>
			<span class="hljs-keyword">if</span>(par === <span class="hljs-literal">null</span>) { par = <span class="hljs-string">"#"</span>; }
			par = <span class="hljs-keyword">this</span>.get_node(par);
			<span class="hljs-keyword">if</span>(!par) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			pos = pos === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">"last"</span> : pos;
			<span class="hljs-keyword">if</span>(!pos.toString().match(<span class="hljs-regexp">/^(before|after)$/</span>) &amp;&amp; !is_loaded &amp;&amp; !<span class="hljs-keyword">this</span>.is_loaded(par)) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.load_node(par, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.create_node(par, node, pos, callback, <span class="hljs-literal">true</span>); });
			}
			<span class="hljs-keyword">if</span>(!node) { node = { <span class="hljs-string">"text"</span> : <span class="hljs-keyword">this</span>.get_string(<span class="hljs-string">'New node'</span>) }; }
			<span class="hljs-keyword">if</span>(node.text === <span class="hljs-literal">undefined</span>) { node.text = <span class="hljs-keyword">this</span>.get_string(<span class="hljs-string">'New node'</span>); }
			<span class="hljs-keyword">var</span> tmp, dpc, i, j;

			<span class="hljs-keyword">if</span>(par.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">if</span>(pos === <span class="hljs-string">"before"</span>) { pos = <span class="hljs-string">"first"</span>; }
				<span class="hljs-keyword">if</span>(pos === <span class="hljs-string">"after"</span>) { pos = <span class="hljs-string">"last"</span>; }
			}
			<span class="hljs-keyword">switch</span>(pos) {
				<span class="hljs-keyword">case</span> <span class="hljs-string">"before"</span>:
					tmp = <span class="hljs-keyword">this</span>.get_node(par.parent);
					pos = $.inArray(par.id, tmp.children);
					par = tmp;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"after"</span> :
					tmp = <span class="hljs-keyword">this</span>.get_node(par.parent);
					pos = $.inArray(par.id, tmp.children) + <span class="hljs-number">1</span>;
					par = tmp;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"inside"</span>:
				<span class="hljs-keyword">case</span> <span class="hljs-string">"first"</span>:
					pos = <span class="hljs-number">0</span>;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"last"</span>:
					pos = par.children.length;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">default</span>:
					<span class="hljs-keyword">if</span>(!pos) { pos = <span class="hljs-number">0</span>; }
					<span class="hljs-keyword">break</span>;
			}
			<span class="hljs-keyword">if</span>(pos &gt; par.children.length) { pos = par.children.length; }
			<span class="hljs-keyword">if</span>(!node.id) { node.id = <span class="hljs-literal">true</span>; }
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.check(<span class="hljs-string">"create_node"</span>, node, par, pos)) {
				<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(node.id === <span class="hljs-literal">true</span>) { <span class="hljs-keyword">delete</span> node.id; }
			node = <span class="hljs-keyword">this</span>._parse_model_from_json(node, par.id, par.parents.concat());
			<span class="hljs-keyword">if</span>(!node) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			tmp = <span class="hljs-keyword">this</span>.get_node(node);
			dpc = [];
			dpc.push(node);
			dpc = dpc.concat(tmp.children_d);
			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'model'</span>, { <span class="hljs-string">"nodes"</span> : dpc, <span class="hljs-string">"parent"</span> : par.id });

			par.children_d = par.children_d.concat(dpc);
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = par.parents.length; i &lt; j; i++) {
				<span class="hljs-keyword">this</span>._model.data[par.parents[i]].children_d = <span class="hljs-keyword">this</span>._model.data[par.parents[i]].children_d.concat(dpc);
			}
			node = tmp;
			tmp = [];
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = par.children.length; i &lt; j; i++) {
				tmp[i &gt;= pos ? i+<span class="hljs-number">1</span> : i] = par.children[i];
			}
			tmp[pos] = node.id;
			par.children = tmp;

			<span class="hljs-keyword">this</span>.redraw_node(par, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(callback) { callback.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.get_node(node)); }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name create_node.jstree</span></p>
<p>triggered when a node is created</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>parent must be a String.</strong><br/>(the parent&#39;s ID)</p>
</li>
<li><p><strong>position must be a Number.</strong><br/>(the position of the new node among the parent&#39;s children)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'create_node'</span>, { <span class="hljs-string">"node"</span> : <span class="hljs-keyword">this</span>.get_node(node), <span class="hljs-string">"parent"</span> : par.id, <span class="hljs-string">"position"</span> : pos });
			<span class="hljs-keyword">return</span> node.id;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name rename_node(obj, val) and trigger rename_node.jstree</span></p>
<p>set the text value of a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node, you can pass an array to rename multiple nodes to the same name)</p>
</li>
<li><p><strong>val must be a String.</strong><br/>(the new text value)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		rename_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, val)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, old;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.rename_node(obj[t1], val);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			old = obj.text;
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.check(<span class="hljs-string">"rename_node"</span>, obj, <span class="hljs-keyword">this</span>.get_parent(obj), val)) {
				<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">this</span>.set_text(obj, val); <span class="hljs-comment">// .apply(this, Array.prototype.slice.call(arguments))</span></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name rename_node.jstree</span></p>
<p>triggered when a node is renamed</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>text must be a String.</strong><br/>(the new value)</p>
</li>
<li><p><strong>old must be a String.</strong><br/>(the old value)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'rename_node'</span>, { <span class="hljs-string">"node"</span> : obj, <span class="hljs-string">"text"</span> : val, <span class="hljs-string">"old"</span> : old });
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name delete_node(obj) and trigger delete_node.jstree, changed.jstree</span></p>
<p>remove a node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node, you can pass an array to delete multiple nodes)</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		delete_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, par, pos, tmp, i, j, k, l, c;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.delete_node(obj[t1]);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			par = <span class="hljs-keyword">this</span>.get_node(obj.parent);
			pos = $.inArray(obj.id, par.children);
			c = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.check(<span class="hljs-string">"delete_node"</span>, obj, par, pos)) {
				<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(pos !== -<span class="hljs-number">1</span>) {
				par.children = $.vakata.array_remove(par.children, pos);
			}
			tmp = obj.children_d.concat([]);
			tmp.push(obj.id);
			<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = tmp.length; k &lt; l; k++) {
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.parents.length; i &lt; j; i++) {
					pos = $.inArray(tmp[k], <span class="hljs-keyword">this</span>._model.data[obj.parents[i]].children_d);
					<span class="hljs-keyword">if</span>(pos !== -<span class="hljs-number">1</span>) {
						<span class="hljs-keyword">this</span>._model.data[obj.parents[i]].children_d = $.vakata.array_remove(<span class="hljs-keyword">this</span>._model.data[obj.parents[i]].children_d, pos);
					}
				}
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[tmp[k]].state.selected) {
					c = <span class="hljs-literal">true</span>;
					pos = $.inArray(tmp[k], <span class="hljs-keyword">this</span>._data.core.selected);
					<span class="hljs-keyword">if</span>(pos !== -<span class="hljs-number">1</span>) {
						<span class="hljs-keyword">this</span>._data.core.selected = $.vakata.array_remove(<span class="hljs-keyword">this</span>._data.core.selected, pos);
					}
				}
			}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name delete_node.jstree</span></p>
<p>triggered when a node is deleted</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>parent must be a String.</strong><br/>(the parent&#39;s ID)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'delete_node'</span>, { <span class="hljs-string">"node"</span> : obj, <span class="hljs-string">"parent"</span> : par.id });
			<span class="hljs-keyword">if</span>(c) {
				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'changed'</span>, { <span class="hljs-string">'action'</span> : <span class="hljs-string">'delete_node'</span>, <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.core.selected, <span class="hljs-string">'parent'</span> : par.id });
			}
			<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = tmp.length; k &lt; l; k++) {
				<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._model.data[tmp[k]];
			}
			<span class="hljs-keyword">this</span>.redraw_node(par, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name check(chk, obj, par, pos)</span></p>
<p>check if an operation is premitted on the tree. Used internally.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>chk must be a String.</strong><br/>(the operation to check, can be &quot;create_node&quot;, &quot;rename_node&quot;, &quot;delete_node&quot;, &quot;copy_node&quot; or &quot;move_node&quot;)</p>
</li>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>par must be a mixed.</strong><br/>(the parent)</p>
</li>
<li><p><strong>pos must be a mixed.</strong><br/>(the position to insert at, or if &quot;rename_node&quot; - the new name)</p>
</li>
<li><p><strong>more must be a mixed.</strong><br/>(some various additional information, for example if a &quot;move_node&quot; operations is triggered by DND this will be the hovered node)</p>
</li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		check : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(chk, obj, par, pos, more)</span> {</span>
			obj = obj &amp;&amp; obj.id ? obj : <span class="hljs-keyword">this</span>.get_node(obj);
			par = par &amp;&amp; par.id ? par : <span class="hljs-keyword">this</span>.get_node(par);
			<span class="hljs-keyword">var</span> tmp = chk.match(<span class="hljs-regexp">/^move_node|copy_node|create_node$/i</span>) ? par : obj,
				chc = <span class="hljs-keyword">this</span>.settings.core.check_callback;
			<span class="hljs-keyword">if</span>(chk === <span class="hljs-string">"move_node"</span> || chk === <span class="hljs-string">"copy_node"</span>) {
				<span class="hljs-keyword">if</span>((!more || !more.is_multi) &amp;&amp; (obj.id === par.id || $.inArray(obj.id, par.children) === pos || $.inArray(par.id, obj.children_d) !== -<span class="hljs-number">1</span>)) {
					<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_01'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Moving parent inside child'</span>, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
			}
			<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.data) { tmp = tmp.data; }
			<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.functions &amp;&amp; (tmp.functions[chk] === <span class="hljs-literal">false</span> || tmp.functions[chk] === <span class="hljs-literal">true</span>)) {
				<span class="hljs-keyword">if</span>(tmp.functions[chk] === <span class="hljs-literal">false</span>) {
					<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_02'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Node data prevents function: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
				}
				<span class="hljs-keyword">return</span> tmp.functions[chk];
			}
			<span class="hljs-keyword">if</span>(chc === <span class="hljs-literal">false</span> || ($.isFunction(chc) &amp;&amp; chc.call(<span class="hljs-keyword">this</span>, chk, obj, par, pos, more) === <span class="hljs-literal">false</span>) || (chc &amp;&amp; chc[chk] === <span class="hljs-literal">false</span>)) {
				<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_03'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'User config for core.check_callback prevents function: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name last_error()</span></p>
<p>get the last error</p>
<p><strong>Returns an Object</strong></p></div></div><div class="code"><div class="wrapper">		last_error : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._data.core.last_error;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name move_node(obj, par [, pos, callback, is_loaded]) and trigger move_node.jstree</span></p>
<p>move a node to a new parent</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to move, pass an array to move multiple nodes)</p>
</li>
<li><p><strong>par must be a mixed.</strong><br/>(the new parent)</p>
</li>
<li><p><strong>pos must be a mixed.</strong><br/>(the position to insert at (besides integer values, &quot;first&quot; and &quot;last&quot; are supported, as well as &quot;before&quot; and &quot;after&quot;), defaults to integer <code>0</code>)</p>
</li>
<li><p><strong>callback must be a function.</strong><br/>(a function to call once the move is completed, receives 3 arguments - the node, the new parent and the position)</p>
</li>
<li><p><strong>internal must be a Boolean.</strong><br/>(parameter indicating if the parent node has been loaded)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		move_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, par, pos, callback, is_loaded)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, old_par, old_pos, new_par, old_ins, is_multi, dpc, tmp, i, j, k, l, p;

			par = <span class="hljs-keyword">this</span>.get_node(par);
			pos = pos === <span class="hljs-literal">undefined</span> ? <span class="hljs-number">0</span> : pos;
			<span class="hljs-keyword">if</span>(!par) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(!pos.toString().match(<span class="hljs-regexp">/^(before|after)$/</span>) &amp;&amp; !is_loaded &amp;&amp; !<span class="hljs-keyword">this</span>.is_loaded(par)) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.load_node(par, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.move_node(obj, par, pos, callback, <span class="hljs-literal">true</span>); });
			}

			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.reverse().slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.move_node(obj[t1], par, pos, callback, is_loaded);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = obj &amp;&amp; obj.id ? obj : <span class="hljs-keyword">this</span>.get_node(obj);

			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }

			old_par = (obj.parent || <span class="hljs-string">'#'</span>).toString();
			new_par = (!pos.toString().match(<span class="hljs-regexp">/^(before|after)$/</span>) || par.id === <span class="hljs-string">'#'</span>) ? par : <span class="hljs-keyword">this</span>.get_node(par.parent);
			old_ins = obj.instance ? obj.instance : (<span class="hljs-keyword">this</span>._model.data[obj.id] ? <span class="hljs-keyword">this</span> : $.jstree.reference(obj.id));
			is_multi = !old_ins || !old_ins._id || (<span class="hljs-keyword">this</span>._id !== old_ins._id);
			old_pos = old_ins &amp;&amp; old_ins._id &amp;&amp; old_par &amp;&amp; old_ins._model.data[old_par] &amp;&amp; old_ins._model.data[old_par].children ? $.inArray(obj.id, old_ins._model.data[old_par].children) : -<span class="hljs-number">1</span>;
			<span class="hljs-keyword">if</span>(is_multi) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.copy_node(obj, par, pos, callback, is_loaded)) {
					<span class="hljs-keyword">if</span>(old_ins) { old_ins.delete_node(obj); }
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>var m = this._model.data;</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span>(new_par.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">if</span>(pos === <span class="hljs-string">"before"</span>) { pos = <span class="hljs-string">"first"</span>; }
				<span class="hljs-keyword">if</span>(pos === <span class="hljs-string">"after"</span>) { pos = <span class="hljs-string">"last"</span>; }
			}
			<span class="hljs-keyword">switch</span>(pos) {
				<span class="hljs-keyword">case</span> <span class="hljs-string">"before"</span>:
					pos = $.inArray(par.id, new_par.children);
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"after"</span> :
					pos = $.inArray(par.id, new_par.children) + <span class="hljs-number">1</span>;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"inside"</span>:
				<span class="hljs-keyword">case</span> <span class="hljs-string">"first"</span>:
					pos = <span class="hljs-number">0</span>;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"last"</span>:
					pos = new_par.children.length;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">default</span>:
					<span class="hljs-keyword">if</span>(!pos) { pos = <span class="hljs-number">0</span>; }
					<span class="hljs-keyword">break</span>;
			}
			<span class="hljs-keyword">if</span>(pos &gt; new_par.children.length) { pos = new_par.children.length; }
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.check(<span class="hljs-string">"move_node"</span>, obj, new_par, pos, { <span class="hljs-string">'core'</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">'is_multi'</span> : (old_ins &amp;&amp; old_ins._id &amp;&amp; old_ins._id !== <span class="hljs-keyword">this</span>._id), <span class="hljs-string">'is_foreign'</span> : (!old_ins || !old_ins._id) })) {
				<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(obj.parent === new_par.id) {
				dpc = new_par.children.concat();
				tmp = $.inArray(obj.id, dpc);
				<span class="hljs-keyword">if</span>(tmp !== -<span class="hljs-number">1</span>) {
					dpc = $.vakata.array_remove(dpc, tmp);
					<span class="hljs-keyword">if</span>(pos &gt; tmp) { pos--; }
				}
				tmp = [];
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dpc.length; i &lt; j; i++) {
					tmp[i &gt;= pos ? i+<span class="hljs-number">1</span> : i] = dpc[i];
				}
				tmp[pos] = obj.id;
				new_par.children = tmp;
				<span class="hljs-keyword">this</span>._node_changed(new_par.id);
				<span class="hljs-keyword">this</span>.redraw(new_par.id === <span class="hljs-string">'#'</span>);
			}
			<span class="hljs-keyword">else</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>clean old parent and up</p></div></div><div class="code"><div class="wrapper">				tmp = obj.children_d.concat();
				tmp.push(obj.id);
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.parents.length; i &lt; j; i++) {
					dpc = [];
					p = old_ins._model.data[obj.parents[i]].children_d;
					<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = p.length; k &lt; l; k++) {
						<span class="hljs-keyword">if</span>($.inArray(p[k], tmp) === -<span class="hljs-number">1</span>) {
							dpc.push(p[k]);
						}
					}
					old_ins._model.data[obj.parents[i]].children_d = dpc;
				}
				old_ins._model.data[old_par].children = $.vakata.array_remove_item(old_ins._model.data[old_par].children, obj.id);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>insert into new parent and up</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = new_par.parents.length; i &lt; j; i++) {
					<span class="hljs-keyword">this</span>._model.data[new_par.parents[i]].children_d = <span class="hljs-keyword">this</span>._model.data[new_par.parents[i]].children_d.concat(tmp);
				}
				dpc = [];
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = new_par.children.length; i &lt; j; i++) {
					dpc[i &gt;= pos ? i+<span class="hljs-number">1</span> : i] = new_par.children[i];
				}
				dpc[pos] = obj.id;
				new_par.children = dpc;
				new_par.children_d.push(obj.id);
				new_par.children_d = new_par.children_d.concat(obj.children_d);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>update object</p></div></div><div class="code"><div class="wrapper">				obj.parent = new_par.id;
				tmp = new_par.parents.concat();
				tmp.unshift(new_par.id);
				p = obj.parents.length;
				obj.parents = tmp;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>update object children</p></div></div><div class="code"><div class="wrapper">				tmp = tmp.concat();
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
					<span class="hljs-keyword">this</span>._model.data[obj.children_d[i]].parents = <span class="hljs-keyword">this</span>._model.data[obj.children_d[i]].parents.slice(<span class="hljs-number">0</span>,p*-<span class="hljs-number">1</span>);
					<span class="hljs-built_in">Array</span>.prototype.push.apply(<span class="hljs-keyword">this</span>._model.data[obj.children_d[i]].parents, tmp);
				}

				<span class="hljs-keyword">this</span>._node_changed(old_par);
				<span class="hljs-keyword">this</span>._node_changed(new_par.id);
				<span class="hljs-keyword">this</span>.redraw(old_par === <span class="hljs-string">'#'</span> || new_par.id === <span class="hljs-string">'#'</span>);
			}
			<span class="hljs-keyword">if</span>(callback) { callback.call(<span class="hljs-keyword">this</span>, obj, new_par, pos); }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name move_node.jstree</span></p>
<p>triggered when a node is moved</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>parent must be a String.</strong><br/>(the parent&#39;s ID)</p>
</li>
<li><p><strong>position must be a Number.</strong><br/>(the position of the node among the parent&#39;s children)</p>
</li>
<li><p><strong>old_parent must be a String.</strong><br/>(the old parent of the node)</p>
</li>
<li><p><strong>old_position must be a Number.</strong><br/>(the old position of the node)</p>
</li>
<li><p><strong>is_multi must be a Boolean.</strong><br/>(do the node and new parent belong to different instances)</p>
</li>
<li><p><strong>old_instance must be a jsTree.</strong><br/>(the instance the node came from)</p>
</li>
<li><p><strong>new_instance must be a jsTree.</strong><br/>(the instance of the new parent)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'move_node'</span>, { <span class="hljs-string">"node"</span> : obj, <span class="hljs-string">"parent"</span> : new_par.id, <span class="hljs-string">"position"</span> : pos, <span class="hljs-string">"old_parent"</span> : old_par, <span class="hljs-string">"old_position"</span> : old_pos, <span class="hljs-string">'is_multi'</span> : (old_ins &amp;&amp; old_ins._id &amp;&amp; old_ins._id !== <span class="hljs-keyword">this</span>._id), <span class="hljs-string">'is_foreign'</span> : (!old_ins || !old_ins._id), <span class="hljs-string">'old_instance'</span> : old_ins, <span class="hljs-string">'new_instance'</span> : <span class="hljs-keyword">this</span> });
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name copy_node(obj, par [, pos, callback, is_loaded]) and trigger model.jstree copy_node.jstree</span></p>
<p>copy a node to a new parent</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to copy, pass an array to copy multiple nodes)</p>
</li>
<li><p><strong>par must be a mixed.</strong><br/>(the new parent)</p>
</li>
<li><p><strong>pos must be a mixed.</strong><br/>(the position to insert at (besides integer values, &quot;first&quot; and &quot;last&quot; are supported, as well as &quot;before&quot; and &quot;after&quot;), defaults to integer <code>0</code>)</p>
</li>
<li><p><strong>callback must be a function.</strong><br/>(a function to call once the move is completed, receives 3 arguments - the node, the new parent and the position)</p>
</li>
<li><p><strong>internal must be a Boolean.</strong><br/>(parameter indicating if the parent node has been loaded)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		copy_node : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, par, pos, callback, is_loaded)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, dpc, tmp, i, j, node, old_par, new_par, old_ins, is_multi;

			par = <span class="hljs-keyword">this</span>.get_node(par);
			pos = pos === <span class="hljs-literal">undefined</span> ? <span class="hljs-number">0</span> : pos;
			<span class="hljs-keyword">if</span>(!par) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(!pos.toString().match(<span class="hljs-regexp">/^(before|after)$/</span>) &amp;&amp; !is_loaded &amp;&amp; !<span class="hljs-keyword">this</span>.is_loaded(par)) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.load_node(par, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.copy_node(obj, par, pos, callback, <span class="hljs-literal">true</span>); });
			}

			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.reverse().slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.copy_node(obj[t1], par, pos, callback, is_loaded);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = obj &amp;&amp; obj.id ? obj : <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }

			old_par = (obj.parent || <span class="hljs-string">'#'</span>).toString();
			new_par = (!pos.toString().match(<span class="hljs-regexp">/^(before|after)$/</span>) || par.id === <span class="hljs-string">'#'</span>) ? par : <span class="hljs-keyword">this</span>.get_node(par.parent);
			old_ins = obj.instance ? obj.instance : (<span class="hljs-keyword">this</span>._model.data[obj.id] ? <span class="hljs-keyword">this</span> : $.jstree.reference(obj.id));
			is_multi = !old_ins || !old_ins._id || (<span class="hljs-keyword">this</span>._id !== old_ins._id);
			<span class="hljs-keyword">if</span>(new_par.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">if</span>(pos === <span class="hljs-string">"before"</span>) { pos = <span class="hljs-string">"first"</span>; }
				<span class="hljs-keyword">if</span>(pos === <span class="hljs-string">"after"</span>) { pos = <span class="hljs-string">"last"</span>; }
			}
			<span class="hljs-keyword">switch</span>(pos) {
				<span class="hljs-keyword">case</span> <span class="hljs-string">"before"</span>:
					pos = $.inArray(par.id, new_par.children);
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"after"</span> :
					pos = $.inArray(par.id, new_par.children) + <span class="hljs-number">1</span>;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"inside"</span>:
				<span class="hljs-keyword">case</span> <span class="hljs-string">"first"</span>:
					pos = <span class="hljs-number">0</span>;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"last"</span>:
					pos = new_par.children.length;
					<span class="hljs-keyword">break</span>;
				<span class="hljs-keyword">default</span>:
					<span class="hljs-keyword">if</span>(!pos) { pos = <span class="hljs-number">0</span>; }
					<span class="hljs-keyword">break</span>;
			}
			<span class="hljs-keyword">if</span>(pos &gt; new_par.children.length) { pos = new_par.children.length; }
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.check(<span class="hljs-string">"copy_node"</span>, obj, new_par, pos, { <span class="hljs-string">'core'</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">'is_multi'</span> : (old_ins &amp;&amp; old_ins._id &amp;&amp; old_ins._id !== <span class="hljs-keyword">this</span>._id), <span class="hljs-string">'is_foreign'</span> : (!old_ins || !old_ins._id) })) {
				<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			node = old_ins ? old_ins.get_json(obj, { no_id : <span class="hljs-literal">true</span>, no_data : <span class="hljs-literal">true</span>, no_state : <span class="hljs-literal">true</span> }) : obj;
			<span class="hljs-keyword">if</span>(!node) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(node.id === <span class="hljs-literal">true</span>) { <span class="hljs-keyword">delete</span> node.id; }
			node = <span class="hljs-keyword">this</span>._parse_model_from_json(node, new_par.id, new_par.parents.concat());
			<span class="hljs-keyword">if</span>(!node) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			tmp = <span class="hljs-keyword">this</span>.get_node(node);
			<span class="hljs-keyword">if</span>(obj &amp;&amp; obj.state &amp;&amp; obj.state.loaded === <span class="hljs-literal">false</span>) { tmp.state.loaded = <span class="hljs-literal">false</span>; }
			dpc = [];
			dpc.push(node);
			dpc = dpc.concat(tmp.children_d);
			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'model'</span>, { <span class="hljs-string">"nodes"</span> : dpc, <span class="hljs-string">"parent"</span> : new_par.id });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>insert into new parent and up</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = new_par.parents.length; i &lt; j; i++) {
				<span class="hljs-keyword">this</span>._model.data[new_par.parents[i]].children_d = <span class="hljs-keyword">this</span>._model.data[new_par.parents[i]].children_d.concat(dpc);
			}
			dpc = [];
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = new_par.children.length; i &lt; j; i++) {
				dpc[i &gt;= pos ? i+<span class="hljs-number">1</span> : i] = new_par.children[i];
			}
			dpc[pos] = tmp.id;
			new_par.children = dpc;
			new_par.children_d.push(tmp.id);
			new_par.children_d = new_par.children_d.concat(tmp.children_d);

			<span class="hljs-keyword">this</span>._node_changed(new_par.id);
			<span class="hljs-keyword">this</span>.redraw(new_par.id === <span class="hljs-string">'#'</span>);
			<span class="hljs-keyword">if</span>(callback) { callback.call(<span class="hljs-keyword">this</span>, tmp, new_par, pos); }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name copy_node.jstree</span></p>
<p>triggered when a node is copied</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong><br/>(the copied node)</p>
</li>
<li><p><strong>original must be an Object.</strong><br/>(the original node)</p>
</li>
<li><p><strong>parent must be a String.</strong><br/>(the parent&#39;s ID)</p>
</li>
<li><p><strong>position must be a Number.</strong><br/>(the position of the node among the parent&#39;s children)</p>
</li>
<li><p><strong>old_parent must be a String.</strong><br/>(the old parent of the node)</p>
</li>
<li><p><strong>old_position must be a Number.</strong><br/>(the position of the original node)</p>
</li>
<li><p><strong>is_multi must be a Boolean.</strong><br/>(do the node and new parent belong to different instances)</p>
</li>
<li><p><strong>old_instance must be a jsTree.</strong><br/>(the instance the node came from)</p>
</li>
<li><p><strong>new_instance must be a jsTree.</strong><br/>(the instance of the new parent)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'copy_node'</span>, { <span class="hljs-string">"node"</span> : tmp, <span class="hljs-string">"original"</span> : obj, <span class="hljs-string">"parent"</span> : new_par.id, <span class="hljs-string">"position"</span> : pos, <span class="hljs-string">"old_parent"</span> : old_par, <span class="hljs-string">"old_position"</span> : old_ins &amp;&amp; old_ins._id &amp;&amp; old_par &amp;&amp; old_ins._model.data[old_par] &amp;&amp; old_ins._model.data[old_par].children ? $.inArray(obj.id, old_ins._model.data[old_par].children) : -<span class="hljs-number">1</span>,<span class="hljs-string">'is_multi'</span> : (old_ins &amp;&amp; old_ins._id &amp;&amp; old_ins._id !== <span class="hljs-keyword">this</span>._id), <span class="hljs-string">'is_foreign'</span> : (!old_ins || !old_ins._id), <span class="hljs-string">'old_instance'</span> : old_ins, <span class="hljs-string">'new_instance'</span> : <span class="hljs-keyword">this</span> });
			<span class="hljs-keyword">return</span> tmp.id;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name cut(obj) and trigger cut.jstree</span></p>
<p>cut a node (a later call to <code>paste(obj)</code> would move the node)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(multiple objects can be passed using an array)</li>
</ul></div></div><div class="code"><div class="wrapper">		cut : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">if</span>(!obj) { obj = <span class="hljs-keyword">this</span>._data.core.selected.concat(); }
			<span class="hljs-keyword">if</span>(!$.isArray(obj)) { obj = [obj]; }
			<span class="hljs-keyword">if</span>(!obj.length) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> tmp = [], o, t1, t2;
			<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
				o = <span class="hljs-keyword">this</span>.get_node(obj[t1]);
				<span class="hljs-keyword">if</span>(o &amp;&amp; o.id &amp;&amp; o.id !== <span class="hljs-string">'#'</span>) { tmp.push(o); }
			}
			<span class="hljs-keyword">if</span>(!tmp.length) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			ccp_node = tmp;
			ccp_inst = <span class="hljs-keyword">this</span>;
			ccp_mode = <span class="hljs-string">'move_node'</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name cut.jstree</span></p>
<p>triggered when nodes are added to the buffer for moving</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Array.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'cut'</span>, { <span class="hljs-string">"node"</span> : obj });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name copy(obj) and trigger copy.jstre</span></p>
<p>copy a node (a later call to <code>paste(obj)</code> would copy the node)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(multiple objects can be passed using an array)</li>
</ul></div></div><div class="code"><div class="wrapper">		copy : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">if</span>(!obj) { obj = <span class="hljs-keyword">this</span>._data.core.selected.concat(); }
			<span class="hljs-keyword">if</span>(!$.isArray(obj)) { obj = [obj]; }
			<span class="hljs-keyword">if</span>(!obj.length) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> tmp = [], o, t1, t2;
			<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
				o = <span class="hljs-keyword">this</span>.get_node(obj[t1]);
				<span class="hljs-keyword">if</span>(o &amp;&amp; o.id &amp;&amp; o.id !== <span class="hljs-string">'#'</span>) { tmp.push(o); }
			}
			<span class="hljs-keyword">if</span>(!tmp.length) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			ccp_node = tmp;
			ccp_inst = <span class="hljs-keyword">this</span>;
			ccp_mode = <span class="hljs-string">'copy_node'</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name copy.jstree</span></p>
<p>triggered when nodes are added to the buffer for copying</p>
<p>Parameters:</p>
<ul>
<li><strong>node must be an Array.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'copy'</span>, { <span class="hljs-string">"node"</span> : obj });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_buffer()</span></p>
<p>get the current buffer (any nodes that are waiting for a paste operation)</p>
<p><strong>Returns an Object</strong><br/>(an object consisting of <code>mode</code> (&quot;copy_node&quot; or &quot;move_node&quot;), <code>node</code> (an array of objects) and <code>inst</code> (the instance))</p></div></div><div class="code"><div class="wrapper">		get_buffer : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> { <span class="hljs-string">'mode'</span> : ccp_mode, <span class="hljs-string">'node'</span> : ccp_node, <span class="hljs-string">'inst'</span> : ccp_inst };
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name can_paste()</span></p>
<p>check if there is something in the buffer to paste</p>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		can_paste : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> ccp_mode !== <span class="hljs-literal">false</span> &amp;&amp; ccp_node !== <span class="hljs-literal">false</span>; <span class="hljs-comment">// &amp;&amp; ccp_inst._model.data[ccp_node];</span>
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name paste(obj [, pos]) and trigger paste.jstree</span></p>
<p>copy or move the previously cut or copied nodes to a new parent</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the new parent)</p>
</li>
<li><p><strong>pos must be a mixed.</strong><br/>(the position to insert at (besides integer, &quot;first&quot; and &quot;last&quot; are supported), defaults to integer <code>0</code>)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		paste : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, pos)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || !ccp_mode || !ccp_mode.match(<span class="hljs-regexp">/^(copy_node|move_node)$/</span>) || !ccp_node) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>[ccp_mode](ccp_node, obj, pos)) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name paste.jstree</span></p>
<p>triggered when paste is invoked</p>
<p>Parameters:</p>
<ul>
<li><p><strong>parent must be a String.</strong><br/>(the ID of the receiving node)</p>
</li>
<li><p><strong>node must be an Array.</strong><br/>(the nodes in the buffer)</p>
</li>
<li><p><strong>mode must be a String.</strong><br/>(the performed operation - &quot;copy_node&quot; or &quot;move_node&quot;)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'paste'</span>, { <span class="hljs-string">"parent"</span> : obj.id, <span class="hljs-string">"node"</span> : ccp_node, <span class="hljs-string">"mode"</span> : ccp_mode });
			}
			ccp_node = <span class="hljs-literal">false</span>;
			ccp_mode = <span class="hljs-literal">false</span>;
			ccp_inst = <span class="hljs-literal">false</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name edit(obj [, default_text])</span></p>
<p>put a node in edit mode (input field to rename the node)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>default_text must be a String.</strong><br/>(the text to populate the input with (if omitted the node text value is used))</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		edit : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, default_text)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.core.check_callback === <span class="hljs-literal">false</span>) {
				<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'core'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'core_07'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Could not edit node because of check_callback'</span> };
				<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			default_text = <span class="hljs-keyword">typeof</span> default_text === <span class="hljs-string">'string'</span> ? default_text : obj.text;
			<span class="hljs-keyword">this</span>.set_text(obj, <span class="hljs-string">""</span>);
			obj = <span class="hljs-keyword">this</span>._open_to(obj);

			<span class="hljs-keyword">var</span> rtl = <span class="hljs-keyword">this</span>._data.core.rtl,
				w  = <span class="hljs-keyword">this</span>.element.width(),
				a  = obj.children(<span class="hljs-string">'.jstree-anchor'</span>),
				s  = $(<span class="hljs-string">'&lt;span&gt;'</span>),</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>!
oi = obj.children(&quot;i:visible&quot;),
ai = a.children(&quot;i:visible&quot;),
w1 = oi.width() <em> oi.length,
w2 = ai.width() </em> ai.length,</p></div></div><div class="code"><div class="wrapper">				t  = default_text,
				h1 = $(<span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"div /&gt;"</span>, { css : { <span class="hljs-string">"position"</span> : <span class="hljs-string">"absolute"</span>, <span class="hljs-string">"top"</span> : <span class="hljs-string">"-200px"</span>, <span class="hljs-string">"left"</span> : (rtl ? <span class="hljs-string">"0px"</span> : <span class="hljs-string">"-1000px"</span>), <span class="hljs-string">"visibility"</span> : <span class="hljs-string">"hidden"</span> } }).appendTo(<span class="hljs-string">"body"</span>),
				h2 = $(<span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"input /&gt;"</span>, {
						<span class="hljs-string">"value"</span> : t,
						<span class="hljs-string">"class"</span> : <span class="hljs-string">"jstree-rename-input"</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>&quot;size&quot; : t.length,</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-string">"css"</span> : {
							<span class="hljs-string">"padding"</span> : <span class="hljs-string">"0"</span>,
							<span class="hljs-string">"border"</span> : <span class="hljs-string">"1px solid silver"</span>,
							<span class="hljs-string">"box-sizing"</span> : <span class="hljs-string">"border-box"</span>,
							<span class="hljs-string">"display"</span> : <span class="hljs-string">"inline-block"</span>,
							<span class="hljs-string">"height"</span> : (<span class="hljs-keyword">this</span>._data.core.li_height) + <span class="hljs-string">"px"</span>,
							<span class="hljs-string">"lineHeight"</span> : (<span class="hljs-keyword">this</span>._data.core.li_height) + <span class="hljs-string">"px"</span>,
							<span class="hljs-string">"width"</span> : <span class="hljs-string">"150px"</span> <span class="hljs-comment">// will be set a bit further down</span>
						},
						<span class="hljs-string">"blur"</span> : $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
							<span class="hljs-keyword">var</span> i = s.children(<span class="hljs-string">".jstree-rename-input"</span>),
								v = i.val();
							<span class="hljs-keyword">if</span>(v === <span class="hljs-string">""</span>) { v = t; }
							h1.remove();
							s.replaceWith(a);
							s.remove();
							<span class="hljs-keyword">this</span>.set_text(obj, t);
							<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.rename_node(obj, $(<span class="hljs-string">'&lt;div&gt;&lt;/div&gt;'</span>).text(v)[<span class="hljs-keyword">this</span>.settings.core.force_text ? <span class="hljs-string">'text'</span> : <span class="hljs-string">'html'</span>]()) === <span class="hljs-literal">false</span>) {
								<span class="hljs-keyword">this</span>.set_text(obj, t); <span class="hljs-comment">// move this up? and fix #483</span>
							}
						}, <span class="hljs-keyword">this</span>),
						<span class="hljs-string">"keydown"</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> {</span>
							<span class="hljs-keyword">var</span> key = event.which;
							<span class="hljs-keyword">if</span>(key === <span class="hljs-number">27</span>) {
								<span class="hljs-keyword">this</span>.value = t;
							}
							<span class="hljs-keyword">if</span>(key === <span class="hljs-number">27</span> || key === <span class="hljs-number">13</span> || key === <span class="hljs-number">37</span> || key === <span class="hljs-number">38</span> || key === <span class="hljs-number">39</span> || key === <span class="hljs-number">40</span> || key === <span class="hljs-number">32</span>) {
								event.stopImmediatePropagation();
							}
							<span class="hljs-keyword">if</span>(key === <span class="hljs-number">27</span> || key === <span class="hljs-number">13</span>) {
								event.preventDefault();
								<span class="hljs-keyword">this</span>.blur();
							}
						},
						<span class="hljs-string">"click"</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span> e.stopImmediatePropagation(); },
						<span class="hljs-string">"mousedown"</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span> e.stopImmediatePropagation(); },
						<span class="hljs-string">"keyup"</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> {</span>
							h2.width(<span class="hljs-built_in">Math</span>.min(h1.text(<span class="hljs-string">"pW"</span> + <span class="hljs-keyword">this</span>.value).width(),w));
						},
						<span class="hljs-string">"keypress"</span> : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> {</span>
							<span class="hljs-keyword">if</span>(event.which === <span class="hljs-number">13</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
						}
					}),
				fn = {
						fontFamily		: a.css(<span class="hljs-string">'fontFamily'</span>)		|| <span class="hljs-string">''</span>,
						fontSize		: a.css(<span class="hljs-string">'fontSize'</span>)			|| <span class="hljs-string">''</span>,
						fontWeight		: a.css(<span class="hljs-string">'fontWeight'</span>)		|| <span class="hljs-string">''</span>,
						fontStyle		: a.css(<span class="hljs-string">'fontStyle'</span>)		|| <span class="hljs-string">''</span>,
						fontStretch		: a.css(<span class="hljs-string">'fontStretch'</span>)		|| <span class="hljs-string">''</span>,
						fontVariant		: a.css(<span class="hljs-string">'fontVariant'</span>)		|| <span class="hljs-string">''</span>,
						letterSpacing	: a.css(<span class="hljs-string">'letterSpacing'</span>)	|| <span class="hljs-string">''</span>,
						wordSpacing		: a.css(<span class="hljs-string">'wordSpacing'</span>)		|| <span class="hljs-string">''</span>
				};
			s.attr(<span class="hljs-string">'class'</span>, a.attr(<span class="hljs-string">'class'</span>)).append(a.contents().clone()).append(h2);
			a.replaceWith(s);
			h1.css(fn);
			h2.css(fn).width(<span class="hljs-built_in">Math</span>.min(h1.text(<span class="hljs-string">"pW"</span> + h2[<span class="hljs-number">0</span>].value).width(),w))[<span class="hljs-number">0</span>].select();
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name set_theme(theme_name [, theme_url]) and trigger set_theme.jstree</span></p>
<p>changes the theme</p>
<p>Parameters:</p>
<ul>
<li><p><strong>theme_name must be a String.</strong><br/>(the name of the new theme to apply)</p>
</li>
<li><p><strong>theme_url must be a mixed.</strong><br/>(the location of the CSS file for this theme. Omit or set to <code>false</code> if you manually included the file. Set to <code>true</code> to autoload from the <code>core.themes.dir</code> directory.)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		set_theme : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(theme_name, theme_url)</span> {</span>
			<span class="hljs-keyword">if</span>(!theme_name) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(theme_url === <span class="hljs-literal">true</span>) {
				<span class="hljs-keyword">var</span> dir = <span class="hljs-keyword">this</span>.settings.core.themes.dir;
				<span class="hljs-keyword">if</span>(!dir) { dir = $.jstree.path + <span class="hljs-string">'/themes'</span>; }
				theme_url = dir + <span class="hljs-string">'/'</span> + theme_name + <span class="hljs-string">'/style.css'</span>;
			}
			<span class="hljs-keyword">if</span>(theme_url &amp;&amp; $.inArray(theme_url, themes_loaded) === -<span class="hljs-number">1</span>) {
				$(<span class="hljs-string">'head'</span>).append(<span class="hljs-string">'&lt;'</span>+<span class="hljs-string">'link rel="stylesheet" href="'</span> + theme_url + <span class="hljs-string">'" type="text/css" /&gt;'</span>);
				themes_loaded.push(theme_url);
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.themes.name) {
				<span class="hljs-keyword">this</span>.element.removeClass(<span class="hljs-string">'jstree-'</span> + <span class="hljs-keyword">this</span>._data.core.themes.name);
			}
			<span class="hljs-keyword">this</span>._data.core.themes.name = theme_name;
			<span class="hljs-keyword">this</span>.element.addClass(<span class="hljs-string">'jstree-'</span> + theme_name);
			<span class="hljs-keyword">this</span>.element[<span class="hljs-keyword">this</span>.settings.core.themes.responsive ? <span class="hljs-string">'addClass'</span> : <span class="hljs-string">'removeClass'</span> ](<span class="hljs-string">'jstree-'</span> + theme_name + <span class="hljs-string">'-responsive'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event and name set_theme.jstree</span></p>
<p>triggered when a theme is set</p>
<p>Parameters:</p>
<ul>
<li><strong>theme must be a String.</strong><br/>(the new theme)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'set_theme'</span>, { <span class="hljs-string">'theme'</span> : theme_name });
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_theme()</span></p>
<p>gets the name of the currently applied theme name</p>
<p><strong>Returns a String</strong></p></div></div><div class="code"><div class="wrapper">		get_theme : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._data.core.themes.name; },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name set_theme_variant(variant_name)</span></p>
<p>changes the theme variant (if the theme has variants)</p>
<p>Parameters:</p>
<ul>
<li><strong>variant_name can be a String or a Boolean.</strong><br/>(the variant to apply (if <code>false</code> is used the current variant is removed))</li>
</ul></div></div><div class="code"><div class="wrapper">		set_theme_variant : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(variant_name)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.themes.variant) {
				<span class="hljs-keyword">this</span>.element.removeClass(<span class="hljs-string">'jstree-'</span> + <span class="hljs-keyword">this</span>._data.core.themes.name + <span class="hljs-string">'-'</span> + <span class="hljs-keyword">this</span>._data.core.themes.variant);
			}
			<span class="hljs-keyword">this</span>._data.core.themes.variant = variant_name;
			<span class="hljs-keyword">if</span>(variant_name) {
				<span class="hljs-keyword">this</span>.element.addClass(<span class="hljs-string">'jstree-'</span> + <span class="hljs-keyword">this</span>._data.core.themes.name + <span class="hljs-string">'-'</span> + <span class="hljs-keyword">this</span>._data.core.themes.variant);
			}
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_theme()</span></p>
<p>gets the name of the currently applied theme variant</p>
<p><strong>Returns a String</strong></p></div></div><div class="code"><div class="wrapper">		get_theme_variant : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._data.core.themes.variant; },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name show_stripes()</span></p>
<p>shows a striped background on the container (if the theme supports it)</p></div></div><div class="code"><div class="wrapper">		show_stripes : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.stripes = <span class="hljs-literal">true</span>; <span class="hljs-keyword">this</span>.get_container_ul().addClass(<span class="hljs-string">"jstree-striped"</span>); },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name hide_stripes()</span></p>
<p>hides the striped background on the container</p></div></div><div class="code"><div class="wrapper">		hide_stripes : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.stripes = <span class="hljs-literal">false</span>; <span class="hljs-keyword">this</span>.get_container_ul().removeClass(<span class="hljs-string">"jstree-striped"</span>); },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name toggle_stripes()</span></p>
<p>toggles the striped background on the container</p></div></div><div class="code"><div class="wrapper">		toggle_stripes : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.themes.stripes) { <span class="hljs-keyword">this</span>.hide_stripes(); } <span class="hljs-keyword">else</span> { <span class="hljs-keyword">this</span>.show_stripes(); } },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name show_dots()</span></p>
<p>shows the connecting dots (if the theme supports it)</p></div></div><div class="code"><div class="wrapper">		show_dots : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.dots = <span class="hljs-literal">true</span>; <span class="hljs-keyword">this</span>.get_container_ul().removeClass(<span class="hljs-string">"jstree-no-dots"</span>); },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name hide_dots()</span></p>
<p>hides the connecting dots</p></div></div><div class="code"><div class="wrapper">		hide_dots : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.dots = <span class="hljs-literal">false</span>; <span class="hljs-keyword">this</span>.get_container_ul().addClass(<span class="hljs-string">"jstree-no-dots"</span>); },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name toggle_dots()</span></p>
<p>toggles the connecting dots</p></div></div><div class="code"><div class="wrapper">		toggle_dots : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.themes.dots) { <span class="hljs-keyword">this</span>.hide_dots(); } <span class="hljs-keyword">else</span> { <span class="hljs-keyword">this</span>.show_dots(); } },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name show_icons()</span></p>
<p>show the node icons</p></div></div><div class="code"><div class="wrapper">		show_icons : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.icons = <span class="hljs-literal">true</span>; <span class="hljs-keyword">this</span>.get_container_ul().removeClass(<span class="hljs-string">"jstree-no-icons"</span>); },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name hide_icons()</span></p>
<p>hide the node icons</p></div></div><div class="code"><div class="wrapper">		hide_icons : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.icons = <span class="hljs-literal">false</span>; <span class="hljs-keyword">this</span>.get_container_ul().addClass(<span class="hljs-string">"jstree-no-icons"</span>); },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name toggle_icons()</span></p>
<p>toggle the node icons</p></div></div><div class="code"><div class="wrapper">		toggle_icons : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.themes.icons) { <span class="hljs-keyword">this</span>.hide_icons(); } <span class="hljs-keyword">else</span> { <span class="hljs-keyword">this</span>.show_icons(); } },</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name set_icon(obj, icon)</span></p>
<p>set the node icon for a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong></p>
</li>
<li><p><strong>icon must be a String.</strong><br/>(the new icon - can be a path to an icon or a className, if using an image that is in the current directory use a <code>./</code> prefix, otherwise it will be detected as a class)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		set_icon : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, icon)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, dom, old;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.set_icon(obj[t1], icon);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			old = obj.icon;
			obj.icon = icon;
			dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>).children(<span class="hljs-string">".jstree-anchor"</span>).children(<span class="hljs-string">".jstree-themeicon"</span>);
			<span class="hljs-keyword">if</span>(icon === <span class="hljs-literal">false</span>) {
				<span class="hljs-keyword">this</span>.hide_icon(obj);
			}
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(icon === <span class="hljs-literal">true</span>) {
				dom.removeClass(<span class="hljs-string">'jstree-themeicon-custom '</span> + old).css(<span class="hljs-string">"background"</span>,<span class="hljs-string">""</span>).removeAttr(<span class="hljs-string">"rel"</span>);
			}
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(icon.indexOf(<span class="hljs-string">"/"</span>) === -<span class="hljs-number">1</span> &amp;&amp; icon.indexOf(<span class="hljs-string">"."</span>) === -<span class="hljs-number">1</span>) {
				dom.removeClass(old).css(<span class="hljs-string">"background"</span>,<span class="hljs-string">""</span>);
				dom.addClass(icon + <span class="hljs-string">' jstree-themeicon-custom'</span>).attr(<span class="hljs-string">"rel"</span>,icon);
			}
			<span class="hljs-keyword">else</span> {
				dom.removeClass(old).css(<span class="hljs-string">"background"</span>,<span class="hljs-string">""</span>);
				dom.addClass(<span class="hljs-string">'jstree-themeicon-custom'</span>).css(<span class="hljs-string">"background"</span>, <span class="hljs-string">"url('"</span> + icon + <span class="hljs-string">"') center center no-repeat"</span>).attr(<span class="hljs-string">"rel"</span>,icon);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_icon(obj)</span></p>
<p>get the node icon for a node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a String</strong></p></div></div><div class="code"><div class="wrapper">		get_icon : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> (!obj || obj.id === <span class="hljs-string">'#'</span>) ? <span class="hljs-literal">false</span> : obj.icon;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name hide_icon(obj)</span></p>
<p>hide the icon on an individual node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">		hide_icon : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.hide_icon(obj[t1]);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			obj.icon = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>).children(<span class="hljs-string">".jstree-anchor"</span>).children(<span class="hljs-string">".jstree-themeicon"</span>).addClass(<span class="hljs-string">'jstree-themeicon-hidden'</span>);
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		},</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name show_icon(obj)</span></p>
<p>show the icon on an individual node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul></div></div><div class="code"><div class="wrapper">		show_icon : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">var</span> t1, t2, dom;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.show_icon(obj[t1]);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			obj.icon = dom.length ? dom.children(<span class="hljs-string">".jstree-anchor"</span>).children(<span class="hljs-string">".jstree-themeicon"</span>).attr(<span class="hljs-string">'rel'</span>) : <span class="hljs-literal">true</span>;
			<span class="hljs-keyword">if</span>(!obj.icon) { obj.icon = <span class="hljs-literal">true</span>; }
			dom.children(<span class="hljs-string">".jstree-anchor"</span>).children(<span class="hljs-string">".jstree-themeicon"</span>).removeClass(<span class="hljs-string">'jstree-themeicon-hidden'</span>);
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		}
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>helpers</p></div></div><div class="code"><div class="wrapper">	$.vakata = {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>collect attributes</p></div></div><div class="code"><div class="wrapper">	$.vakata.attributes = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(node, with_values)</span> {</span>
		node = $(node)[<span class="hljs-number">0</span>];
		<span class="hljs-keyword">var</span> attr = with_values ? {} : [];
		<span class="hljs-keyword">if</span>(node &amp;&amp; node.attributes) {
			$.each(node.attributes, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
				<span class="hljs-keyword">if</span>($.inArray(v.nodeName.toLowerCase(),[<span class="hljs-string">'style'</span>,<span class="hljs-string">'contenteditable'</span>,<span class="hljs-string">'hasfocus'</span>,<span class="hljs-string">'tabindex'</span>]) !== -<span class="hljs-number">1</span>) { <span class="hljs-keyword">return</span>; }
				<span class="hljs-keyword">if</span>(v.nodeValue !== <span class="hljs-literal">null</span> &amp;&amp; $.trim(v.nodeValue) !== <span class="hljs-string">''</span>) {
					<span class="hljs-keyword">if</span>(with_values) { attr[v.nodeName] = v.nodeValue; }
					<span class="hljs-keyword">else</span> { attr.push(v.nodeName); }
				}
			});
		}
		<span class="hljs-keyword">return</span> attr;
	};
	$.vakata.array_unique = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(array)</span> {</span>
		<span class="hljs-keyword">var</span> a = [], i, j, l;
		<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, l = array.length; i &lt; l; i++) {
			<span class="hljs-keyword">for</span>(j = <span class="hljs-number">0</span>; j &lt;= i; j++) {
				<span class="hljs-keyword">if</span>(array[i] === array[j]) {
					<span class="hljs-keyword">break</span>;
				}
			}
			<span class="hljs-keyword">if</span>(j === i) { a.push(array[i]); }
		}
		<span class="hljs-keyword">return</span> a;
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>remove item from array</p></div></div><div class="code"><div class="wrapper">	$.vakata.array_remove = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(array, from, to)</span> {</span>
		<span class="hljs-keyword">var</span> rest = array.slice((to || from) + <span class="hljs-number">1</span> || array.length);
		array.length = from &lt; <span class="hljs-number">0</span> ? array.length + from : from;
		array.push.apply(array, rest);
		<span class="hljs-keyword">return</span> array;
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>remove item from array</p></div></div><div class="code"><div class="wrapper">	$.vakata.array_remove_item = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(array, item)</span> {</span>
		<span class="hljs-keyword">var</span> tmp = $.inArray(item, array);
		<span class="hljs-keyword">return</span> tmp !== -<span class="hljs-number">1</span> ? $.vakata.array_remove(array, tmp) : array;
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="checkbox-plugin">Checkbox plugin</h3>
<p>This plugin renders checkbox icons in front of each node, making multiple selection much easier. 
It also supports tri-state behavior, meaning that if a node has a few of its children checked it will be rendered as undetermined, and state will be propagated up.</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">var</span> _i = document.createElement(<span class="hljs-string">'I'</span>);
	_i.className = <span class="hljs-string">'jstree-icon jstree-checkbox'</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox and plugin checkbox</span></p>
<p>stores all defaults for the checkbox plugin</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.checkbox = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox.visible and plugin checkbox</span></p>
<p>a boolean indicating if checkboxes should be visible (can be changed at a later time using <code>show_checkboxes()</code> and <code>hide_checkboxes</code>). Defaults to <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		visible				: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox.three_state and plugin checkbox</span></p>
<p>a boolean indicating if checkboxes should cascade down and have an undetermined state. Defaults to <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		three_state			: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox.whole_node and plugin checkbox</span></p>
<p>a boolean indicating if clicking anywhere on the node should act as clicking on the checkbox. Defaults to <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		whole_node			: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox.keep_selected_style and plugin checkbox</span></p>
<p>a boolean indicating if the selected style of a node should be kept, or removed. Defaults to <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		keep_selected_style	: <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox.cascade and plugin checkbox</span></p>
<p>This setting controls how cascading and undetermined nodes are applied. 
If &#39;up&#39; is in the string - cascading up is enabled, if &#39;down&#39; is in the string - cascading down is enabled, if &#39;undetermined&#39; is in the string - undetermined nodes will be used. 
If <code>three_state</code> is set to <code>true</code> this setting is automatically set to &#39;up+down+undetermined&#39;. Defaults to &#39;&#39;.</p></div></div><div class="code"><div class="wrapper">		cascade				: <span class="hljs-string">''</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.checkbox.tie_selection and plugin checkbox</span></p>
<p>This setting controls if checkbox are bound to the general tree selection or to an internal array maintained by the checkbox plugin. Defaults to <code>true</code>, only set to <code>false</code> if you know exactly what you are doing. </p></div></div><div class="code"><div class="wrapper">		tie_selection		: <span class="hljs-literal">true</span>
	};
	$.jstree.plugins.checkbox = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);
			<span class="hljs-keyword">this</span>._data.checkbox.uto = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">this</span>._data.checkbox.selected = [];
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.three_state) {
				<span class="hljs-keyword">this</span>.settings.checkbox.cascade = <span class="hljs-string">'up+down+undetermined'</span>;
			}
			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">"init.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">this</span>._data.checkbox.visible = <span class="hljs-keyword">this</span>.settings.checkbox.visible;
						<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.settings.checkbox.keep_selected_style) {
							<span class="hljs-keyword">this</span>.element.addClass(<span class="hljs-string">'jstree-checkbox-no-clicked'</span>);
						}
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) {
							<span class="hljs-keyword">this</span>.element.addClass(<span class="hljs-string">'jstree-checkbox-selection'</span>);
						}
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"loading.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">this</span>[ <span class="hljs-keyword">this</span>._data.checkbox.visible ? <span class="hljs-string">'show_checkboxes'</span> : <span class="hljs-string">'hide_checkboxes'</span> ]();
					}, <span class="hljs-keyword">this</span>));
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.cascade.indexOf(<span class="hljs-string">'undetermined'</span>) !== -<span class="hljs-number">1</span>) {
				<span class="hljs-keyword">this</span>.element
					.on(<span class="hljs-string">'changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>only if undetermined is in setting</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.checkbox.uto) { clearTimeout(<span class="hljs-keyword">this</span>._data.checkbox.uto); }
							<span class="hljs-keyword">this</span>._data.checkbox.uto = setTimeout($.proxy(<span class="hljs-keyword">this</span>._undetermined, <span class="hljs-keyword">this</span>), <span class="hljs-number">50</span>);
						}, <span class="hljs-keyword">this</span>));
			}
			<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) {
				<span class="hljs-keyword">this</span>.element
					.on(<span class="hljs-string">'model.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>._model.data,
							p = m[data.parent],
							dpc = data.nodes,
							i, j;
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dpc.length; i &lt; j; i++) {
							m[dpc[i]].state.checked = (m[dpc[i]].original &amp;&amp; m[dpc[i]].original.state &amp;&amp; m[dpc[i]].original.state.checked);
							<span class="hljs-keyword">if</span>(m[dpc[i]].state.checked) {
								<span class="hljs-keyword">this</span>._data.checkbox.selected.push(dpc[i]);
							}
						}
					}, <span class="hljs-keyword">this</span>));
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.cascade.indexOf(<span class="hljs-string">'up'</span>) !== -<span class="hljs-number">1</span> || <span class="hljs-keyword">this</span>.settings.checkbox.cascade.indexOf(<span class="hljs-string">'down'</span>) !== -<span class="hljs-number">1</span>) {
				<span class="hljs-keyword">this</span>.element
					.on(<span class="hljs-string">'model.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
							<span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>._model.data,
								p = m[data.parent],
								dpc = data.nodes,
								chd = [],
								c, i, j, k, l, tmp, s = <span class="hljs-keyword">this</span>.settings.checkbox.cascade, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection;

							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'down'</span>) !== -<span class="hljs-number">1</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply down</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">if</span>(p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ]) {
									<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dpc.length; i &lt; j; i++) {
										m[dpc[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
									}
									<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected = <span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.concat(dpc);
								}
								<span class="hljs-keyword">else</span> {
									<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dpc.length; i &lt; j; i++) {
										<span class="hljs-keyword">if</span>(m[dpc[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ]) {
											<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = m[dpc[i]].children_d.length; k &lt; l; k++) {
												m[m[dpc[i]].children_d[k]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
											}
											<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected = <span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.concat(m[dpc[i]].children_d);
										}
									}
								}
							}

							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'up'</span>) !== -<span class="hljs-number">1</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply up</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.children_d.length; i &lt; j; i++) {
									<span class="hljs-keyword">if</span>(!m[p.children_d[i]].children.length) {
										chd.push(m[p.children_d[i]].parent);
									}
								}
								chd = $.vakata.array_unique(chd);
								<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = chd.length; k &lt; l; k++) {
									p = m[chd[k]];
									<span class="hljs-keyword">while</span>(p &amp;&amp; p.id !== <span class="hljs-string">'#'</span>) {
										c = <span class="hljs-number">0</span>;
										<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.children.length; i &lt; j; i++) {
											c += m[p.children[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ];
										}
										<span class="hljs-keyword">if</span>(c === j) {
											p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
											<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.push(p.id);
											tmp = <span class="hljs-keyword">this</span>.get_node(p, <span class="hljs-literal">true</span>);
											<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
												tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass( t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
											}
										}
										<span class="hljs-keyword">else</span> {
											<span class="hljs-keyword">break</span>;
										}
										p = <span class="hljs-keyword">this</span>.get_node(p.parent);
									}
								}
							}

							<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected = $.vakata.array_unique(<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected);
						}, <span class="hljs-keyword">this</span>))
					.on(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection ? <span class="hljs-string">'select_node.jstree'</span> : <span class="hljs-string">'check_node.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
							<span class="hljs-keyword">var</span> obj = data.node,
								m = <span class="hljs-keyword">this</span>._model.data,
								par = <span class="hljs-keyword">this</span>.get_node(obj.parent),
								dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>),
								i, j, c, tmp, s = <span class="hljs-keyword">this</span>.settings.checkbox.cascade, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply down</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'down'</span>) !== -<span class="hljs-number">1</span>) {
								<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected = $.vakata.array_unique(<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.concat(obj.children_d));
								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
									tmp = m[obj.children_d[i]];
									tmp.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
									<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.original &amp;&amp; tmp.original.state &amp;&amp; tmp.original.state.undetermined) {
										tmp.original.state.undetermined = <span class="hljs-literal">false</span>;
									}
								}
							}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply up</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'up'</span>) !== -<span class="hljs-number">1</span>) {
								<span class="hljs-keyword">while</span>(par &amp;&amp; par.id !== <span class="hljs-string">'#'</span>) {
									c = <span class="hljs-number">0</span>;
									<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = par.children.length; i &lt; j; i++) {
										c += m[par.children[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ];
									}
									<span class="hljs-keyword">if</span>(c === j) {
										par.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
										<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.push(par.id);
										tmp = <span class="hljs-keyword">this</span>.get_node(par, <span class="hljs-literal">true</span>);
										<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
											tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
										}
									}
									<span class="hljs-keyword">else</span> {
										<span class="hljs-keyword">break</span>;
									}
									par = <span class="hljs-keyword">this</span>.get_node(par.parent);
								}
							}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply down (process .children separately?)</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'down'</span>) !== -<span class="hljs-number">1</span> &amp;&amp; dom.length) {
								dom.find(<span class="hljs-string">'.jstree-anchor'</span>).addClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
							}
						}, <span class="hljs-keyword">this</span>))
					.on(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection ? <span class="hljs-string">'deselect_all.jstree'</span> : <span class="hljs-string">'uncheck_all.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
							<span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">this</span>.get_node(<span class="hljs-string">'#'</span>),
								m = <span class="hljs-keyword">this</span>._model.data,
								i, j, tmp;
							<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
								tmp = m[obj.children_d[i]];
	 							<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.original &amp;&amp; tmp.original.state &amp;&amp; tmp.original.state.undetermined) {
									tmp.original.state.undetermined = <span class="hljs-literal">false</span>;
								}
							}
						}, <span class="hljs-keyword">this</span>))
					.on(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection ? <span class="hljs-string">'deselect_node.jstree'</span> : <span class="hljs-string">'uncheck_node.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
							<span class="hljs-keyword">var</span> obj = data.node,
								dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>),
								i, j, tmp, s = <span class="hljs-keyword">this</span>.settings.checkbox.cascade, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection;
							<span class="hljs-keyword">if</span>(obj &amp;&amp; obj.original &amp;&amp; obj.original.state &amp;&amp; obj.original.state.undetermined) {
								obj.original.state.undetermined = <span class="hljs-literal">false</span>;
							}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply down</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'down'</span>) !== -<span class="hljs-number">1</span>) {
								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
									tmp = <span class="hljs-keyword">this</span>._model.data[obj.children_d[i]];
									tmp.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">false</span>;
									<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.original &amp;&amp; tmp.original.state &amp;&amp; tmp.original.state.undetermined) {
										tmp.original.state.undetermined = <span class="hljs-literal">false</span>;
									}
								}
							}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply up</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'up'</span>) !== -<span class="hljs-number">1</span>) {
								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.parents.length; i &lt; j; i++) {
									tmp = <span class="hljs-keyword">this</span>._model.data[obj.parents[i]];
									tmp.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">false</span>;
									<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.original &amp;&amp; tmp.original.state &amp;&amp; tmp.original.state.undetermined) {
										tmp.original.state.undetermined = <span class="hljs-literal">false</span>;
									}
									tmp = <span class="hljs-keyword">this</span>.get_node(obj.parents[i], <span class="hljs-literal">true</span>);
									<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
										tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
									}
								}
							}
							tmp = [];
							<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.length; i &lt; j; i++) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply down + apply up</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">if</span>(
									(s.indexOf(<span class="hljs-string">'down'</span>) === -<span class="hljs-number">1</span> || $.inArray(<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected[i], obj.children_d) === -<span class="hljs-number">1</span>) &amp;&amp;
									(s.indexOf(<span class="hljs-string">'up'</span>) === -<span class="hljs-number">1</span> || $.inArray(<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected[i], obj.parents) === -<span class="hljs-number">1</span>)
								) {
									tmp.push(<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected[i]);
								}
							}
							<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected = $.vakata.array_unique(tmp);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply down (process .children separately?)</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">if</span>(s.indexOf(<span class="hljs-string">'down'</span>) !== -<span class="hljs-number">1</span> &amp;&amp; dom.length) {
								dom.find(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
							}
						}, <span class="hljs-keyword">this</span>));
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.cascade.indexOf(<span class="hljs-string">'up'</span>) !== -<span class="hljs-number">1</span>) {
				<span class="hljs-keyword">this</span>.element
					.on(<span class="hljs-string">'delete_node.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply up (whole handler)</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">this</span>.get_node(data.parent),
								m = <span class="hljs-keyword">this</span>._model.data,
								i, j, c, tmp, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection;
							<span class="hljs-keyword">while</span>(p &amp;&amp; p.id !== <span class="hljs-string">'#'</span>) {
								c = <span class="hljs-number">0</span>;
								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.children.length; i &lt; j; i++) {
									c += m[p.children[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ];
								}
								<span class="hljs-keyword">if</span>(c === j) {
									p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
									<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.push(p.id);
									tmp = <span class="hljs-keyword">this</span>.get_node(p, <span class="hljs-literal">true</span>);
									<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
										tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
									}
								}
								<span class="hljs-keyword">else</span> {
									<span class="hljs-keyword">break</span>;
								}
								p = <span class="hljs-keyword">this</span>.get_node(p.parent);
							}
						}, <span class="hljs-keyword">this</span>))
					.on(<span class="hljs-string">'move_node.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>apply up (whole handler)</p></div></div><div class="code"><div class="wrapper">							<span class="hljs-keyword">var</span> is_multi = data.is_multi,
								old_par = data.old_parent,
								new_par = <span class="hljs-keyword">this</span>.get_node(data.parent),
								m = <span class="hljs-keyword">this</span>._model.data,
								p, c, i, j, tmp, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection;
							<span class="hljs-keyword">if</span>(!is_multi) {
								p = <span class="hljs-keyword">this</span>.get_node(old_par);
								<span class="hljs-keyword">while</span>(p &amp;&amp; p.id !== <span class="hljs-string">'#'</span>) {
									c = <span class="hljs-number">0</span>;
									<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.children.length; i &lt; j; i++) {
										c += m[p.children[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ];
									}
									<span class="hljs-keyword">if</span>(c === j) {
										p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
										<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.push(p.id);
										tmp = <span class="hljs-keyword">this</span>.get_node(p, <span class="hljs-literal">true</span>);
										<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
											tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
										}
									}
									<span class="hljs-keyword">else</span> {
										<span class="hljs-keyword">break</span>;
									}
									p = <span class="hljs-keyword">this</span>.get_node(p.parent);
								}
							}
							p = new_par;
							<span class="hljs-keyword">while</span>(p &amp;&amp; p.id !== <span class="hljs-string">'#'</span>) {
								c = <span class="hljs-number">0</span>;
								<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.children.length; i &lt; j; i++) {
									c += m[p.children[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ];
								}
								<span class="hljs-keyword">if</span>(c === j) {
									<span class="hljs-keyword">if</span>(!p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ]) {
										p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">true</span>;
										<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected.push(p.id);
										tmp = <span class="hljs-keyword">this</span>.get_node(p, <span class="hljs-literal">true</span>);
										<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
											tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
										}
									}
								}
								<span class="hljs-keyword">else</span> {
									<span class="hljs-keyword">if</span>(p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ]) {
										p.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] = <span class="hljs-literal">false</span>;
										<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected = $.vakata.array_remove_item(<span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected, p.id);
										tmp = <span class="hljs-keyword">this</span>.get_node(p, <span class="hljs-literal">true</span>);
										<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
											tmp.children(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(t ? <span class="hljs-string">'jstree-clicked'</span> : <span class="hljs-string">'jstree-checked'</span>);
										}
									}
									<span class="hljs-keyword">else</span> {
										<span class="hljs-keyword">break</span>;
									}
								}
								p = <span class="hljs-keyword">this</span>.get_node(p.parent);
							}
						}, <span class="hljs-keyword">this</span>));
			}
		};</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _undetermined() and plugin checkbox</span></p>
<p>set the undetermined state where and if necessary. Used internally.</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>._undetermined = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> i, j, m = <span class="hljs-keyword">this</span>._model.data, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection, s = <span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected, p = [], tt = <span class="hljs-keyword">this</span>;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = s.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(m[s[i]] &amp;&amp; m[s[i]].parents) {
					p = p.concat(m[s[i]].parents);
				}
			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>attempt for server side undetermined state</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-closed'</span>).not(<span class="hljs-string">':has(.jstree-children)'</span>)
				.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">var</span> tmp = tt.get_node(<span class="hljs-keyword">this</span>), tmp2;
					<span class="hljs-keyword">if</span>(!tmp.state.loaded) {
						<span class="hljs-keyword">if</span>(tmp.original &amp;&amp; tmp.original.state &amp;&amp; tmp.original.state.undetermined &amp;&amp; tmp.original.state.undetermined === <span class="hljs-literal">true</span>) {
							p.push(tmp.id);
							p = p.concat(tmp.parents);
						}
					}
					<span class="hljs-keyword">else</span> {
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.children_d.length; i &lt; j; i++) {
							tmp2 = m[tmp.children_d[i]];
							<span class="hljs-keyword">if</span>(!tmp2.state.loaded &amp;&amp; tmp2.original &amp;&amp; tmp2.original.state &amp;&amp; tmp2.original.state.undetermined &amp;&amp; tmp2.original.state.undetermined === <span class="hljs-literal">true</span>) {
								p.push(tmp2.id);
								p = p.concat(tmp2.parents);
							}
						}
					}
				});
			p = $.vakata.array_unique(p);
			p = $.vakata.array_remove_item(p,<span class="hljs-string">'#'</span>);

			<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-undetermined'</span>).removeClass(<span class="hljs-string">'jstree-undetermined'</span>);
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = p.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(!m[p[i]].state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ]) {
					s = <span class="hljs-keyword">this</span>.get_node(p[i], <span class="hljs-literal">true</span>);
					<span class="hljs-keyword">if</span>(s &amp;&amp; s.length) {
						s.children(<span class="hljs-string">'.jstree-anchor'</span>).children(<span class="hljs-string">'.jstree-checkbox'</span>).addClass(<span class="hljs-string">'jstree-undetermined'</span>);
					}
				}
			}
		};
		<span class="hljs-keyword">this</span>.redraw_node = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, deep, is_callback)</span> {</span>
			obj = parent.redraw_node.call(<span class="hljs-keyword">this</span>, obj, deep, is_callback);
			<span class="hljs-keyword">if</span>(obj) {
				<span class="hljs-keyword">var</span> i, j, tmp = <span class="hljs-literal">null</span>;
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.childNodes.length; i &lt; j; i++) {
					<span class="hljs-keyword">if</span>(obj.childNodes[i] &amp;&amp; obj.childNodes[i].className &amp;&amp; obj.childNodes[i].className.indexOf(<span class="hljs-string">"jstree-anchor"</span>) !== -<span class="hljs-number">1</span>) {
						tmp = obj.childNodes[i];
						<span class="hljs-keyword">break</span>;
					}
				}
				<span class="hljs-keyword">if</span>(tmp) {
					<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection &amp;&amp; <span class="hljs-keyword">this</span>._model.data[obj.id].state.checked) { tmp.className += <span class="hljs-string">' jstree-checked'</span>; }
					tmp.insertBefore(_i.cloneNode(<span class="hljs-literal">false</span>), tmp.childNodes[<span class="hljs-number">0</span>]);
				}
			}
			<span class="hljs-keyword">if</span>(!is_callback &amp;&amp; <span class="hljs-keyword">this</span>.settings.checkbox.cascade.indexOf(<span class="hljs-string">'undetermined'</span>) !== -<span class="hljs-number">1</span>) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.checkbox.uto) { clearTimeout(<span class="hljs-keyword">this</span>._data.checkbox.uto); }
				<span class="hljs-keyword">this</span>._data.checkbox.uto = setTimeout($.proxy(<span class="hljs-keyword">this</span>._undetermined, <span class="hljs-keyword">this</span>), <span class="hljs-number">50</span>);
			}
			<span class="hljs-keyword">return</span> obj;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name show_checkboxes() and plugin checkbox</span></p>
<p>show the node checkbox icons</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.show_checkboxes = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.checkboxes = <span class="hljs-literal">true</span>; <span class="hljs-keyword">this</span>.get_container_ul().removeClass(<span class="hljs-string">"jstree-no-checkboxes"</span>); };</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name hide_checkboxes() and plugin checkbox</span></p>
<p>hide the node checkbox icons</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.hide_checkboxes = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.core.themes.checkboxes = <span class="hljs-literal">false</span>; <span class="hljs-keyword">this</span>.get_container_ul().addClass(<span class="hljs-string">"jstree-no-checkboxes"</span>); };</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name toggle_checkboxes() and plugin checkbox</span></p>
<p>toggle the node icons</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.toggle_checkboxes = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.core.themes.checkboxes) { <span class="hljs-keyword">this</span>.hide_checkboxes(); } <span class="hljs-keyword">else</span> { <span class="hljs-keyword">this</span>.show_checkboxes(); } };</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_undetermined(obj)</span></p>
<p>checks if a node is in an undetermined state</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.is_undetermined = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.settings.checkbox.cascade, i, j, t = <span class="hljs-keyword">this</span>.settings.checkbox.tie_selection, d = <span class="hljs-keyword">this</span>._data[ t ? <span class="hljs-string">'core'</span> : <span class="hljs-string">'checkbox'</span> ].selected, m = <span class="hljs-keyword">this</span>._model.data;
			<span class="hljs-keyword">if</span>(!obj || obj.state[ t ? <span class="hljs-string">'selected'</span> : <span class="hljs-string">'checked'</span> ] === <span class="hljs-literal">true</span> || s.indexOf(<span class="hljs-string">'undetermined'</span>) === -<span class="hljs-number">1</span> || (s.indexOf(<span class="hljs-string">'down'</span>) === -<span class="hljs-number">1</span> &amp;&amp; s.indexOf(<span class="hljs-string">'up'</span>) === -<span class="hljs-number">1</span>)) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(!obj.state.loaded &amp;&amp; obj.original.state.undetermined === <span class="hljs-literal">true</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>($.inArray(obj.children_d[i], d) !== -<span class="hljs-number">1</span> || (!m[obj.children_d[i]].state.loaded &amp;&amp; m[obj.children_d[i]].original.state.undetermined)) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				}
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		};

		<span class="hljs-keyword">this</span>.activate_node = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, e)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection &amp;&amp; (<span class="hljs-keyword">this</span>.settings.checkbox.whole_node || $(e.target).hasClass(<span class="hljs-string">'jstree-checkbox'</span>))) {
				e.ctrlKey = <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection || (!<span class="hljs-keyword">this</span>.settings.checkbox.whole_node &amp;&amp; !$(e.target).hasClass(<span class="hljs-string">'jstree-checkbox'</span>))) {
				<span class="hljs-keyword">return</span> parent.activate_node.call(<span class="hljs-keyword">this</span>, obj, e);
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.is_checked(obj)) {
				<span class="hljs-keyword">this</span>.uncheck_node(obj, e);
			}
			<span class="hljs-keyword">else</span> {
				<span class="hljs-keyword">this</span>.check_node(obj, e);
			}
			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'activate_node'</span>, { <span class="hljs-string">'node'</span> : <span class="hljs-keyword">this</span>.get_node(obj) });
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name check_node(obj), trigger check_node.jstree, and plugin checkbox</span></p>
<p>check a node (only if tie_selection in checkbox settings is false, otherwise select_node will be called internally)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(an array can be used to check multiple nodes)</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.check_node = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, e)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.select_node(obj, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, e); }
			<span class="hljs-keyword">var</span> dom, t1, t2, th;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.check_node(obj[t1], e);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(!obj.state.checked) {
				obj.state.checked = <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">this</span>._data.checkbox.selected.push(obj.id);
				<span class="hljs-keyword">if</span>(dom &amp;&amp; dom.length) {
					dom.children(<span class="hljs-string">'.jstree-anchor'</span>).addClass(<span class="hljs-string">'jstree-checked'</span>);
				}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name check_node.jstree, and plugin checkbox</span></p>
<p>triggered when an node is checked (only if tie_selection in checkbox settings is false)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event (if any) that triggered this check_node)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'check_node'</span>, { <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.checkbox.selected, <span class="hljs-string">'event'</span> : e });
			}
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name deselect_node(obj), trigger uncheck_node.jstree, and plugin checkbox</span></p>
<p>uncheck a node (only if tie_selection in checkbox settings is false, otherwise deselect_node will be called internally)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(an array can be used to deselect multiple nodes)</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.uncheck_node = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, e)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.deselect_node(obj, <span class="hljs-literal">false</span>, e); }
			<span class="hljs-keyword">var</span> t1, t2, dom;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.uncheck_node(obj[t1], e);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
			dom = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(obj.state.checked) {
				obj.state.checked = <span class="hljs-literal">false</span>;
				<span class="hljs-keyword">this</span>._data.checkbox.selected = $.vakata.array_remove_item(<span class="hljs-keyword">this</span>._data.checkbox.selected, obj.id);
				<span class="hljs-keyword">if</span>(dom.length) {
					dom.children(<span class="hljs-string">'.jstree-anchor'</span>).removeClass(<span class="hljs-string">'jstree-checked'</span>);
				}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name uncheck_node.jstree, and plugin checkbox</span></p>
<p>triggered when an node is unchecked (only if tie_selection in checkbox settings is false)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong></p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event (if any) that triggered this uncheck_node)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'uncheck_node'</span>, { <span class="hljs-string">'node'</span> : obj, <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.checkbox.selected, <span class="hljs-string">'event'</span> : e });
			}
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name check_all(), trigger check_all.jstree, changed.jstree, and plugin checkbox</span></p>
<p>checks all nodes in the tree (only if tie_selection in checkbox settings is false, otherwise select_all will be called internally)</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.check_all = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.select_all(); }
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>._data.checkbox.selected.concat([]), i, j;
			<span class="hljs-keyword">this</span>._data.checkbox.selected = <span class="hljs-keyword">this</span>._model.data[<span class="hljs-string">'#'</span>].children_d.concat();
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-keyword">this</span>._data.checkbox.selected.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.checkbox.selected[i]]) {
					<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.checkbox.selected[i]].state.checked = <span class="hljs-literal">true</span>;
				}
			}
			<span class="hljs-keyword">this</span>.redraw(<span class="hljs-literal">true</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name check_all.jstree, and plugin checkbox</span></p>
<p>triggered when all nodes are checked (only if tie_selection in checkbox settings is false)</p>
<p>Parameters:</p>
<ul>
<li><strong>selected must be an Array.</strong><br/>(the current selection)</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'check_all'</span>, { <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.checkbox.selected });
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name uncheck_all(), trigger uncheck_all.jstree, and plugin checkbox</span></p>
<p>uncheck all checked nodes (only if tie_selection in checkbox settings is false, otherwise deselect_all will be called internally)</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.uncheck_all = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.deselect_all(); }
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>._data.checkbox.selected.concat([]), i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-keyword">this</span>._data.checkbox.selected.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.checkbox.selected[i]]) {
					<span class="hljs-keyword">this</span>._model.data[<span class="hljs-keyword">this</span>._data.checkbox.selected[i]].state.checked = <span class="hljs-literal">false</span>;
				}
			}
			<span class="hljs-keyword">this</span>._data.checkbox.selected = [];
			<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-checked'</span>).removeClass(<span class="hljs-string">'jstree-checked'</span>);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name uncheck_all.jstree, and plugin checkbox</span></p>
<p>triggered when all nodes are unchecked (only if tie_selection in checkbox settings is false)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong><br/>(the previous selection)</p>
</li>
<li><p><strong>selected must be an Array.</strong><br/>(the current selection)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'uncheck_all'</span>, { <span class="hljs-string">'selected'</span> : <span class="hljs-keyword">this</span>._data.checkbox.selected, <span class="hljs-string">'node'</span> : tmp });
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name is_checked(obj) and plugin checkbox</span></p>
<p>checks if a node is checked (if tie_selection is on in the settings this function will return the same as is_selected)</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.is_checked = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.is_selected(obj); }
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">return</span> obj.state.checked;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_checked([full]) and plugin checkbox</span></p>
<p>get an array of all checked nodes (if tie_selection is on in the settings this function will return the same as get_selected)</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a mixed.</strong><br/>(if set to <code>true</code> the returned array will consist of the full node objects, otherwise - only IDs will be returned)</li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.get_checked = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_selected(full); }
			<span class="hljs-keyword">return</span> full ? $.map(<span class="hljs-keyword">this</span>._data.checkbox.selected, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_node(i); }, <span class="hljs-keyword">this</span>)) : <span class="hljs-keyword">this</span>._data.checkbox.selected;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_top_checked([full]) and plugin checkbox</span></p>
<p>get an array of all top level checked nodes (ignoring children of checked nodes) (if tie_selection is on in the settings this function will return the same as get_top_selected)</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a mixed.</strong><br/>(if set to <code>true</code> the returned array will consist of the full node objects, otherwise - only IDs will be returned)</li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.get_top_checked = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_top_selected(full); }
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>.get_checked(<span class="hljs-literal">true</span>),
				obj = {}, i, j, k, l;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
				obj[tmp[i].id] = tmp[i];
			}
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
				<span class="hljs-keyword">for</span>(k = <span class="hljs-number">0</span>, l = tmp[i].children_d.length; k &lt; l; k++) {
					<span class="hljs-keyword">if</span>(obj[tmp[i].children_d[k]]) {
						<span class="hljs-keyword">delete</span> obj[tmp[i].children_d[k]];
					}
				}
			}
			tmp = [];
			<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> obj) {
				<span class="hljs-keyword">if</span>(obj.hasOwnProperty(i)) {
					tmp.push(i);
				}
			}
			<span class="hljs-keyword">return</span> full ? $.map(tmp, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_node(i); }, <span class="hljs-keyword">this</span>)) : tmp;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_bottom_checked([full]) and plugin checkbox</span></p>
<p>get an array of all bottom level checked nodes (ignoring selected parents) (if tie_selection is on in the settings this function will return the same as get_bottom_selected)</p>
<p>Parameters:</p>
<ul>
<li><strong>full must be a mixed.</strong><br/>(if set to <code>true</code> the returned array will consist of the full node objects, otherwise - only IDs will be returned)</li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.get_bottom_checked = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(full)</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.checkbox.tie_selection) { <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_bottom_selected(full); }
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>.get_checked(<span class="hljs-literal">true</span>),
				obj = [], i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
				<span class="hljs-keyword">if</span>(!tmp[i].children.length) {
					obj.push(tmp[i].id);
				}
			}
			<span class="hljs-keyword">return</span> full ? $.map(obj, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_node(i); }, <span class="hljs-keyword">this</span>)) : obj;
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the checkbox plugin by default
$.jstree.defaults.plugins.push(&quot;checkbox&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="contextmenu-plugin">Contextmenu plugin</h3>
<p>Shows a context menu when a node is right-clicked.
TODO: move logic outside of function + check multiple move</p></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.contextmenu and plugin contextmenu</span></p>
<p>stores all defaults for the contextmenu plugin</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.contextmenu = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.contextmenu.select_node and plugin contextmenu</span></p>
<p>a boolean indicating if the node should be selected when the context menu is invoked on it. Defaults to <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		select_node : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.contextmenu.show_at_node and plugin contextmenu</span></p>
<p>a boolean indicating if the menu should be shown aligned with the node. Defaults to <code>true</code>, otherwise the mouse coordinates are used.</p></div></div><div class="code"><div class="wrapper">		show_at_node : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.contextmenu.items and plugin contextmenu</span></p>
<p>an object of actions, or a function that accepts a node and a callback function and calls the callback function with an object of actions available for that node (you can also return the items too).</p>
<p>Each action consists of a key (a unique name) and a value which is an object with the following properties (only label and action are required):</p>
<ul>
<li><code>separator_before</code> - a boolean indicating if there should be a separator before this item</li>
<li><code>separator_after</code> - a boolean indicating if there should be a separator after this item</li>
<li><code>_disabled</code> - a boolean indicating if this action should be disabled</li>
<li><code>label</code> - a string - the name of the action (could be a function returning a string)</li>
<li><code>action</code> - a function to be executed if this item is chosen</li>
<li><code>icon</code> - a string, can be a path to an icon or a className, if using an image that is in the current directory use a <code>./</code> prefix, otherwise it will be detected as a class</li>
<li><code>shortcut</code> - keyCode which will trigger the action if the menu is open (for example <code>113</code> for rename, which equals F2)</li>
<li><code>shortcut_label</code> - shortcut label (like for example <code>F2</code> for rename)</li>
</ul></div></div><div class="code"><div class="wrapper">		items : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o, cb)</span> {</span> <span class="hljs-comment">// Could be an object directly</span>
			<span class="hljs-keyword">return</span> {
				<span class="hljs-string">"create"</span> : {
					<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">true</span>,
					<span class="hljs-string">"_disabled"</span>			: <span class="hljs-literal">false</span>, <span class="hljs-comment">//(this.check("create_node", data.reference, {}, "last")),</span>
					<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Create"</span>,
					<span class="hljs-string">"action"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
						<span class="hljs-keyword">var</span> inst = $.jstree.reference(data.reference),
							obj = inst.get_node(data.reference);
						inst.create_node(obj, {}, <span class="hljs-string">"last"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(new_node)</span> {</span>
							setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> inst.edit(new_node); },<span class="hljs-number">0</span>);
						});
					}
				},
				<span class="hljs-string">"rename"</span> : {
					<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"_disabled"</span>			: <span class="hljs-literal">false</span>, <span class="hljs-comment">//(this.check("rename_node", data.reference, this.get_parent(data.reference), "")),</span>
					<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Rename"</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>&quot;shortcut&quot;            : 113,
&quot;shortcut_label&quot;    : &#39;F2&#39;,
&quot;icon&quot;                : &quot;glyphicon glyphicon-leaf&quot;,</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-string">"action"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
						<span class="hljs-keyword">var</span> inst = $.jstree.reference(data.reference),
							obj = inst.get_node(data.reference);
						inst.edit(obj);
					}
				},
				<span class="hljs-string">"remove"</span> : {
					<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"icon"</span>				: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"_disabled"</span>			: <span class="hljs-literal">false</span>, <span class="hljs-comment">//(this.check("delete_node", data.reference, this.get_parent(data.reference), "")),</span>
					<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Delete"</span>,
					<span class="hljs-string">"action"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
						<span class="hljs-keyword">var</span> inst = $.jstree.reference(data.reference),
							obj = inst.get_node(data.reference);
						<span class="hljs-keyword">if</span>(inst.is_selected(obj)) {
							inst.delete_node(inst.get_selected());
						}
						<span class="hljs-keyword">else</span> {
							inst.delete_node(obj);
						}
					}
				},
				<span class="hljs-string">"ccp"</span> : {
					<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">true</span>,
					<span class="hljs-string">"icon"</span>				: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Edit"</span>,
					<span class="hljs-string">"action"</span>			: <span class="hljs-literal">false</span>,
					<span class="hljs-string">"submenu"</span> : {
						<span class="hljs-string">"cut"</span> : {
							<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Cut"</span>,
							<span class="hljs-string">"action"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
								<span class="hljs-keyword">var</span> inst = $.jstree.reference(data.reference),
									obj = inst.get_node(data.reference);
								<span class="hljs-keyword">if</span>(inst.is_selected(obj)) {
									inst.cut(inst.get_selected());
								}
								<span class="hljs-keyword">else</span> {
									inst.cut(obj);
								}
							}
						},
						<span class="hljs-string">"copy"</span> : {
							<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"icon"</span>				: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Copy"</span>,
							<span class="hljs-string">"action"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
								<span class="hljs-keyword">var</span> inst = $.jstree.reference(data.reference),
									obj = inst.get_node(data.reference);
								<span class="hljs-keyword">if</span>(inst.is_selected(obj)) {
									inst.copy(inst.get_selected());
								}
								<span class="hljs-keyword">else</span> {
									inst.copy(obj);
								}
							}
						},
						<span class="hljs-string">"paste"</span> : {
							<span class="hljs-string">"separator_before"</span>	: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"icon"</span>				: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"_disabled"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
								<span class="hljs-keyword">return</span> !$.jstree.reference(data.reference).can_paste();
							},
							<span class="hljs-string">"separator_after"</span>	: <span class="hljs-literal">false</span>,
							<span class="hljs-string">"label"</span>				: <span class="hljs-string">"Paste"</span>,
							<span class="hljs-string">"action"</span>			: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data)</span> {</span>
								<span class="hljs-keyword">var</span> inst = $.jstree.reference(data.reference),
									obj = inst.get_node(data.reference);
								inst.paste(obj);
							}
						}
					}
				}
			};
		}
	};

	$.jstree.plugins.contextmenu = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);

			<span class="hljs-keyword">var</span> last_ts = <span class="hljs-number">0</span>;
			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">"contextmenu.jstree"</span>, <span class="hljs-string">".jstree-anchor"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						e.preventDefault();
						last_ts = e.ctrlKey ? e.timeStamp : <span class="hljs-number">0</span>;
						<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.is_loading(e.currentTarget)) {
							<span class="hljs-keyword">this</span>.show_contextmenu(e.currentTarget, e.pageX, e.pageY, e);
						}
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"click.jstree"</span>, <span class="hljs-string">".jstree-anchor"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.contextmenu.visible &amp;&amp; (!last_ts || e.timeStamp - last_ts &gt; <span class="hljs-number">250</span>)) { <span class="hljs-comment">// work around safari &amp; macOS ctrl+click</span>
							$.vakata.context.hide();
						}
					}, <span class="hljs-keyword">this</span>));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if(!(&#39;oncontextmenu&#39; in document.body) &amp;&amp; (&#39;ontouchstart&#39; in document.body)) {
    var el = null, tm = null;
    this.element
        .on(&quot;touchstart&quot;, &quot;.jstree-anchor&quot;, function (e) {
            el = e.currentTarget;
            tm = +new Date();
            $(document).one(&quot;touchend&quot;, function (e) {
                e.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);
                e.currentTarget = e.target;
                tm = ((+(new Date())) - tm);
                if(e.target === el &amp;&amp; tm &gt; 600 &amp;&amp; tm &lt; 1000) {
                    e.preventDefault();
                    $(el).trigger(&#39;contextmenu&#39;, e);
                }
                el = null;
                tm = null;
            });
        });
}</p></div></div><div class="code"><div class="wrapper">			$(document).on(<span class="hljs-string">"context_hide.vakata"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>._data.contextmenu.visible = <span class="hljs-literal">false</span>; }, <span class="hljs-keyword">this</span>));
		};
		<span class="hljs-keyword">this</span>.teardown = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.contextmenu.visible) {
				$.vakata.context.hide();
			}
			parent.teardown.call(<span class="hljs-keyword">this</span>);
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name show_contextmenu(obj [, x, y]), plugin contextmenu, and trigger show_contextmenu.jstree</span></p>
<p>prepare and show the context menu for a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>x must be a Number.</strong><br/>(the x-coordinate relative to the document to show the menu at)</p>
</li>
<li><p><strong>y must be a Number.</strong><br/>(the y-coordinate relative to the document to show the menu at)</p>
</li>
<li><p><strong>e must be an Object.</strong><br/>(the event if available that triggered the contextmenu)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.show_contextmenu = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, x, y, e)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj || obj.id === <span class="hljs-string">'#'</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.settings.contextmenu,
				d = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>),
				a = d.children(<span class="hljs-string">".jstree-anchor"</span>),
				o = <span class="hljs-literal">false</span>,
				i = <span class="hljs-literal">false</span>;
			<span class="hljs-keyword">if</span>(s.show_at_node || x === <span class="hljs-literal">undefined</span> || y === <span class="hljs-literal">undefined</span>) {
				o = a.offset();
				x = o.left;
				y = o.top + <span class="hljs-keyword">this</span>._data.core.li_height;
			}
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.contextmenu.select_node &amp;&amp; !<span class="hljs-keyword">this</span>.is_selected(obj)) {
				<span class="hljs-keyword">this</span>.activate_node(obj, e);
			}

			i = s.items;
			<span class="hljs-keyword">if</span>($.isFunction(i)) {
				i = i.call(<span class="hljs-keyword">this</span>, obj, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span>
					<span class="hljs-keyword">this</span>._show_contextmenu(obj, x, y, i);
				}, <span class="hljs-keyword">this</span>));
			}
			<span class="hljs-keyword">if</span>($.isPlainObject(i)) {
				<span class="hljs-keyword">this</span>._show_contextmenu(obj, x, y, i);
			}
		};</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _show_contextmenu(obj, x, y, i), plugin contextmenu, and trigger show_contextmenu.jstree</span></p>
<p>show the prepared context menu for a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>x must be a Number.</strong><br/>(the x-coordinate relative to the document to show the menu at)</p>
</li>
<li><p><strong>y must be a Number.</strong><br/>(the y-coordinate relative to the document to show the menu at)</p>
</li>
<li><p><strong>i must be a Number.</strong><br/>(the object of items to show)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>._show_contextmenu = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, x, y, i)</span> {</span>
			<span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.get_node(obj, <span class="hljs-literal">true</span>),
				a = d.children(<span class="hljs-string">".jstree-anchor"</span>);
			$(document).one(<span class="hljs-string">"context_show.vakata"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				<span class="hljs-keyword">var</span> cls = <span class="hljs-string">'jstree-contextmenu jstree-'</span> + <span class="hljs-keyword">this</span>.get_theme() + <span class="hljs-string">'-contextmenu'</span>;
				$(data.element).addClass(cls);
			}, <span class="hljs-keyword">this</span>));
			<span class="hljs-keyword">this</span>._data.contextmenu.visible = <span class="hljs-literal">true</span>;
			$.vakata.context.show(a, { <span class="hljs-string">'x'</span> : x, <span class="hljs-string">'y'</span> : y }, i);</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name show_contextmenu.jstree, and plugin contextmenu</span></p>
<p>triggered when the contextmenu is shown for a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>node must be an Object.</strong><br/>(the node)</p>
</li>
<li><p><strong>x must be a Number.</strong><br/>(the x-coordinate of the menu relative to the document)</p>
</li>
<li><p><strong>y must be a Number.</strong><br/>(the y-coordinate of the menu relative to the document)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'show_contextmenu'</span>, { <span class="hljs-string">"node"</span> : obj, <span class="hljs-string">"x"</span> : x, <span class="hljs-string">"y"</span> : y });
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>contextmenu helper</p></div></div><div class="code"><div class="wrapper">	(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($)</span> {</span>
		<span class="hljs-keyword">var</span> right_to_left = <span class="hljs-literal">false</span>,
			vakata_context = {
				element		: <span class="hljs-literal">false</span>,
				reference	: <span class="hljs-literal">false</span>,
				position_x	: <span class="hljs-number">0</span>,
				position_y	: <span class="hljs-number">0</span>,
				items		: [],
				html		: <span class="hljs-string">""</span>,
				is_visible	: <span class="hljs-literal">false</span>
			};

		$.vakata.context = {
			settings : {
				hide_onmouseleave	: <span class="hljs-number">0</span>,
				icons				: <span class="hljs-literal">true</span>
			},
			_trigger : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event_name)</span> {</span>
				$(document).triggerHandler(<span class="hljs-string">"context_"</span> + event_name + <span class="hljs-string">".vakata"</span>, {
					<span class="hljs-string">"reference"</span>	: vakata_context.reference,
					<span class="hljs-string">"element"</span>	: vakata_context.element,
					<span class="hljs-string">"position"</span>	: {
						<span class="hljs-string">"x"</span> : vakata_context.position_x,
						<span class="hljs-string">"y"</span> : vakata_context.position_y
					}
				});
			},
			_execute : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i)</span> {</span>
				i = vakata_context.items[i];
				<span class="hljs-keyword">return</span> i &amp;&amp; (!i._disabled || ($.isFunction(i._disabled) &amp;&amp; !i._disabled({ <span class="hljs-string">"item"</span> : i, <span class="hljs-string">"reference"</span> : vakata_context.reference, <span class="hljs-string">"element"</span> : vakata_context.element }))) &amp;&amp; i.action ? i.action.call(<span class="hljs-literal">null</span>, {
							<span class="hljs-string">"item"</span>		: i,
							<span class="hljs-string">"reference"</span>	: vakata_context.reference,
							<span class="hljs-string">"element"</span>	: vakata_context.element,
							<span class="hljs-string">"position"</span>	: {
								<span class="hljs-string">"x"</span> : vakata_context.position_x,
								<span class="hljs-string">"y"</span> : vakata_context.position_y
							}
						}) : <span class="hljs-literal">false</span>;
			},
			_parse : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o, is_callback)</span> {</span>
				<span class="hljs-keyword">if</span>(!o) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
				<span class="hljs-keyword">if</span>(!is_callback) {
					vakata_context.html		= <span class="hljs-string">""</span>;
					vakata_context.items	= [];
				}
				<span class="hljs-keyword">var</span> str = <span class="hljs-string">""</span>,
					sep = <span class="hljs-literal">false</span>,
					tmp;

				<span class="hljs-keyword">if</span>(is_callback) { str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"ul&gt;"</span>; }
				$.each(o, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, val)</span> {</span>
					<span class="hljs-keyword">if</span>(!val) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
					vakata_context.items.push(val);
					<span class="hljs-keyword">if</span>(!sep &amp;&amp; val.separator_before) {
						str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"li class='vakata-context-separator'&gt;&lt;"</span>+<span class="hljs-string">"a href='#' "</span> + ($.vakata.context.settings.icons ? <span class="hljs-string">''</span> : <span class="hljs-string">'style="margin-left:0px;"'</span>) + <span class="hljs-string">"&gt;&amp;#160;&lt;"</span>+<span class="hljs-string">"/a&gt;&lt;"</span>+<span class="hljs-string">"/li&gt;"</span>;
					}
					sep = <span class="hljs-literal">false</span>;
					str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"li class='"</span> + (val._class || <span class="hljs-string">""</span>) + (val._disabled === <span class="hljs-literal">true</span> || ($.isFunction(val._disabled) &amp;&amp; val._disabled({ <span class="hljs-string">"item"</span> : val, <span class="hljs-string">"reference"</span> : vakata_context.reference, <span class="hljs-string">"element"</span> : vakata_context.element })) ? <span class="hljs-string">" vakata-contextmenu-disabled "</span> : <span class="hljs-string">""</span>) + <span class="hljs-string">"' "</span>+(val.shortcut?<span class="hljs-string">" data-shortcut='"</span>+val.shortcut+<span class="hljs-string">"' "</span>:<span class="hljs-string">''</span>)+<span class="hljs-string">"&gt;"</span>;
					str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"a href='#' rel='"</span> + (vakata_context.items.length - <span class="hljs-number">1</span>) + <span class="hljs-string">"'&gt;"</span>;
					<span class="hljs-keyword">if</span>($.vakata.context.settings.icons) {
						str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"i "</span>;
						<span class="hljs-keyword">if</span>(val.icon) {
							<span class="hljs-keyword">if</span>(val.icon.indexOf(<span class="hljs-string">"/"</span>) !== -<span class="hljs-number">1</span> || val.icon.indexOf(<span class="hljs-string">"."</span>) !== -<span class="hljs-number">1</span>) { str += <span class="hljs-string">" style='background:url(\""</span> + val.icon + <span class="hljs-string">"\") center center no-repeat' "</span>; }
							<span class="hljs-keyword">else</span> { str += <span class="hljs-string">" class='"</span> + val.icon + <span class="hljs-string">"' "</span>; }
						}
						str += <span class="hljs-string">"&gt;&lt;"</span>+<span class="hljs-string">"/i&gt;&lt;"</span>+<span class="hljs-string">"span class='vakata-contextmenu-sep'&gt;&amp;#160;&lt;"</span>+<span class="hljs-string">"/span&gt;"</span>;
					}
					str += ($.isFunction(val.label) ? val.label({ <span class="hljs-string">"item"</span> : i, <span class="hljs-string">"reference"</span> : vakata_context.reference, <span class="hljs-string">"element"</span> : vakata_context.element }) : val.label) + (val.shortcut?<span class="hljs-string">' &lt;span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'</span>+val.shortcut+<span class="hljs-string">'"&gt;'</span>+ (val.shortcut_label || <span class="hljs-string">''</span>) +<span class="hljs-string">'&lt;/span&gt;'</span>:<span class="hljs-string">''</span>) + <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"/a&gt;"</span>;
					<span class="hljs-keyword">if</span>(val.submenu) {
						tmp = $.vakata.context._parse(val.submenu, <span class="hljs-literal">true</span>);
						<span class="hljs-keyword">if</span>(tmp) { str += tmp; }
					}
					str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"/li&gt;"</span>;
					<span class="hljs-keyword">if</span>(val.separator_after) {
						str += <span class="hljs-string">"&lt;"</span>+<span class="hljs-string">"li class='vakata-context-separator'&gt;&lt;"</span>+<span class="hljs-string">"a href='#' "</span> + ($.vakata.context.settings.icons ? <span class="hljs-string">''</span> : <span class="hljs-string">'style="margin-left:0px;"'</span>) + <span class="hljs-string">"&gt;&amp;#160;&lt;"</span>+<span class="hljs-string">"/a&gt;&lt;"</span>+<span class="hljs-string">"/li&gt;"</span>;
						sep = <span class="hljs-literal">true</span>;
					}
				});
				str  = str.replace(<span class="hljs-regexp">/&lt;li class\='vakata-context-separator'\&gt;&lt;\/li\&gt;$/</span>,<span class="hljs-string">""</span>);
				<span class="hljs-keyword">if</span>(is_callback) { str += <span class="hljs-string">"&lt;/ul&gt;"</span>; }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin contextmenu, and name context_parse.vakata</span></p>
<p>triggered on the document when the contextmenu is parsed (HTML is built)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>reference must be a jQuery.</strong><br/>(the element that was right clicked)</p>
</li>
<li><p><strong>element must be a jQuery.</strong><br/>(the DOM element of the menu itself)</p>
</li>
<li><p><strong>position must be an Object.</strong><br/>(the x &amp; y coordinates of the menu)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(!is_callback) { vakata_context.html = str; $.vakata.context._trigger(<span class="hljs-string">"parse"</span>); }
				<span class="hljs-keyword">return</span> str.length &gt; <span class="hljs-number">10</span> ? str : <span class="hljs-literal">false</span>;
			},
			_show_submenu : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(o)</span> {</span>
				o = $(o);
				<span class="hljs-keyword">if</span>(!o.length || !o.children(<span class="hljs-string">"ul"</span>).length) { <span class="hljs-keyword">return</span>; }
				<span class="hljs-keyword">var</span> e = o.children(<span class="hljs-string">"ul"</span>),
					x = o.offset().left + o.outerWidth(),
					y = o.offset().top,
					w = e.width(),
					h = e.height(),
					dw = $(window).width() + $(window).scrollLeft(),
					dh = $(window).height() + $(window).scrollTop();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>       -       </p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(right_to_left) {
					o[x - (w + <span class="hljs-number">10</span> + o.outerWidth()) &lt; <span class="hljs-number">0</span> ? <span class="hljs-string">"addClass"</span> : <span class="hljs-string">"removeClass"</span>](<span class="hljs-string">"vakata-context-left"</span>);
				}
				<span class="hljs-keyword">else</span> {
					o[x + w + <span class="hljs-number">10</span> &gt; dw ? <span class="hljs-string">"addClass"</span> : <span class="hljs-string">"removeClass"</span>](<span class="hljs-string">"vakata-context-right"</span>);
				}
				<span class="hljs-keyword">if</span>(y + h + <span class="hljs-number">10</span> &gt; dh) {
					e.css(<span class="hljs-string">"bottom"</span>,<span class="hljs-string">"-1px"</span>);
				}
				e.show();
			},
			show : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(reference, position, data)</span> {</span>
				<span class="hljs-keyword">var</span> o, e, x, y, w, h, dw, dh, cond = <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">if</span>(vakata_context.element &amp;&amp; vakata_context.element.length) {
					vakata_context.element.width(<span class="hljs-string">''</span>);
				}
				<span class="hljs-keyword">switch</span>(cond) {
					<span class="hljs-keyword">case</span> (!position &amp;&amp; !reference):
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					<span class="hljs-keyword">case</span> (!!position &amp;&amp; !!reference):
						vakata_context.reference	= reference;
						vakata_context.position_x	= position.x;
						vakata_context.position_y	= position.y;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> (!position &amp;&amp; !!reference):
						vakata_context.reference	= reference;
						o = reference.offset();
						vakata_context.position_x	= o.left + reference.outerHeight();
						vakata_context.position_y	= o.top;
						<span class="hljs-keyword">break</span>;
					<span class="hljs-keyword">case</span> (!!position &amp;&amp; !reference):
						vakata_context.position_x	= position.x;
						vakata_context.position_y	= position.y;
						<span class="hljs-keyword">break</span>;
				}
				<span class="hljs-keyword">if</span>(!!reference &amp;&amp; !data &amp;&amp; $(reference).data(<span class="hljs-string">'vakata_contextmenu'</span>)) {
					data = $(reference).data(<span class="hljs-string">'vakata_contextmenu'</span>);
				}
				<span class="hljs-keyword">if</span>($.vakata.context._parse(data)) {
					vakata_context.element.html(vakata_context.html);
				}
				<span class="hljs-keyword">if</span>(vakata_context.items.length) {
					e = vakata_context.element;
					x = vakata_context.position_x;
					y = vakata_context.position_y;
					w = e.width();
					h = e.height();
					dw = $(window).width() + $(window).scrollLeft();
					dh = $(window).height() + $(window).scrollTop();
					<span class="hljs-keyword">if</span>(right_to_left) {
						x -= e.outerWidth();
						<span class="hljs-keyword">if</span>(x &lt; $(window).scrollLeft() + <span class="hljs-number">20</span>) {
							x = $(window).scrollLeft() + <span class="hljs-number">20</span>;
						}
					}
					<span class="hljs-keyword">if</span>(x + w + <span class="hljs-number">20</span> &gt; dw) {
						x = dw - (w + <span class="hljs-number">20</span>);
					}
					<span class="hljs-keyword">if</span>(y + h + <span class="hljs-number">20</span> &gt; dh) {
						y = dh - (h + <span class="hljs-number">20</span>);
					}

					vakata_context.element
						.css({ <span class="hljs-string">"left"</span> : x, <span class="hljs-string">"top"</span> : y })
						.show()
						.find(<span class="hljs-string">'a:eq(0)'</span>).focus().parent().addClass(<span class="hljs-string">"vakata-context-hover"</span>);
					vakata_context.is_visible = <span class="hljs-literal">true</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin contextmenu, and name context_show.vakata</span></p>
<p>triggered on the document when the contextmenu is shown</p>
<p>Parameters:</p>
<ul>
<li><p><strong>reference must be a jQuery.</strong><br/>(the element that was right clicked)</p>
</li>
<li><p><strong>element must be a jQuery.</strong><br/>(the DOM element of the menu itself)</p>
</li>
<li><p><strong>position must be an Object.</strong><br/>(the x &amp; y coordinates of the menu)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">					$.vakata.context._trigger(<span class="hljs-string">"show"</span>);
				}
			},
			hide : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">if</span>(vakata_context.is_visible) {
					vakata_context.element.hide().find(<span class="hljs-string">"ul"</span>).hide().end().find(<span class="hljs-string">':focus'</span>).blur();
					vakata_context.is_visible = <span class="hljs-literal">false</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin contextmenu, and name context_hide.vakata</span></p>
<p>triggered on the document when the contextmenu is hidden</p>
<p>Parameters:</p>
<ul>
<li><p><strong>reference must be a jQuery.</strong><br/>(the element that was right clicked)</p>
</li>
<li><p><strong>element must be a jQuery.</strong><br/>(the DOM element of the menu itself)</p>
</li>
<li><p><strong>position must be an Object.</strong><br/>(the x &amp; y coordinates of the menu)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">					$.vakata.context._trigger(<span class="hljs-string">"hide"</span>);
				}
			}
		};
		$(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			right_to_left = $(<span class="hljs-string">"body"</span>).css(<span class="hljs-string">"direction"</span>) === <span class="hljs-string">"rtl"</span>;
			<span class="hljs-keyword">var</span> to = <span class="hljs-literal">false</span>;

			vakata_context.element = $(<span class="hljs-string">"&lt;ul class='vakata-context'&gt;&lt;/ul&gt;"</span>);
			vakata_context.element
				.on(<span class="hljs-string">"mouseenter"</span>, <span class="hljs-string">"li"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					e.stopImmediatePropagation();

					<span class="hljs-keyword">if</span>($.contains(<span class="hljs-keyword">this</span>, e.relatedTarget)) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>  delegate mouseleave -
$(this).find(&quot;.vakata-context-hover&quot;).removeClass(&quot;vakata-context-hover&quot;);</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">return</span>;
					}

					<span class="hljs-keyword">if</span>(to) { clearTimeout(to); }
					vakata_context.element.find(<span class="hljs-string">".vakata-context-hover"</span>).removeClass(<span class="hljs-string">"vakata-context-hover"</span>).end();

					$(<span class="hljs-keyword">this</span>)
						.siblings().find(<span class="hljs-string">"ul"</span>).hide().end().end()
						.parentsUntil(<span class="hljs-string">".vakata-context"</span>, <span class="hljs-string">"li"</span>).addBack().addClass(<span class="hljs-string">"vakata-context-hover"</span>);
					$.vakata.context._show_submenu(<span class="hljs-keyword">this</span>);
				})</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p> -   ?</p></div></div><div class="code"><div class="wrapper">				.on(<span class="hljs-string">"mouseleave"</span>, <span class="hljs-string">"li"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					<span class="hljs-keyword">if</span>($.contains(<span class="hljs-keyword">this</span>, e.relatedTarget)) { <span class="hljs-keyword">return</span>; }
					$(<span class="hljs-keyword">this</span>).find(<span class="hljs-string">".vakata-context-hover"</span>).addBack().removeClass(<span class="hljs-string">"vakata-context-hover"</span>);
				})
				.on(<span class="hljs-string">"mouseleave"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					$(<span class="hljs-keyword">this</span>).find(<span class="hljs-string">".vakata-context-hover"</span>).removeClass(<span class="hljs-string">"vakata-context-hover"</span>);
					<span class="hljs-keyword">if</span>($.vakata.context.settings.hide_onmouseleave) {
						to = setTimeout(
							(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(t)</span> {</span>
								<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> $.vakata.context.hide(); };
							}(<span class="hljs-keyword">this</span>)), $.vakata.context.settings.hide_onmouseleave);
					}
				})
				.on(<span class="hljs-string">"click"</span>, <span class="hljs-string">"a"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					e.preventDefault();
				<span class="hljs-comment">//)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>.on(&quot;mouseup&quot;, &quot;a&quot;, function (e) {</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">if</span>(!$(<span class="hljs-keyword">this</span>).blur().parent().hasClass(<span class="hljs-string">"vakata-context-disabled"</span>) &amp;&amp; $.vakata.context._execute($(<span class="hljs-keyword">this</span>).attr(<span class="hljs-string">"rel"</span>)) !== <span class="hljs-literal">false</span>) {
						$.vakata.context.hide();
					}
				})
				.on(<span class="hljs-string">'keydown'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">var</span> o = <span class="hljs-literal">null</span>;
						<span class="hljs-keyword">switch</span>(e.which) {
							<span class="hljs-keyword">case</span> <span class="hljs-number">13</span>:
							<span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:
								e.type = <span class="hljs-string">"mouseup"</span>;
								e.preventDefault();
								$(e.currentTarget).trigger(e);
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">37</span>:
								<span class="hljs-keyword">if</span>(vakata_context.is_visible) {
									vakata_context.element.find(<span class="hljs-string">".vakata-context-hover"</span>).last().parents(<span class="hljs-string">"li:eq(0)"</span>).find(<span class="hljs-string">"ul"</span>).hide().find(<span class="hljs-string">".vakata-context-hover"</span>).removeClass(<span class="hljs-string">"vakata-context-hover"</span>).end().end().children(<span class="hljs-string">'a'</span>).focus();
									e.stopImmediatePropagation();
									e.preventDefault();
								}
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">38</span>:
								<span class="hljs-keyword">if</span>(vakata_context.is_visible) {
									o = vakata_context.element.find(<span class="hljs-string">"ul:visible"</span>).addBack().last().children(<span class="hljs-string">".vakata-context-hover"</span>).removeClass(<span class="hljs-string">"vakata-context-hover"</span>).prevAll(<span class="hljs-string">"li:not(.vakata-context-separator)"</span>).first();
									<span class="hljs-keyword">if</span>(!o.length) { o = vakata_context.element.find(<span class="hljs-string">"ul:visible"</span>).addBack().last().children(<span class="hljs-string">"li:not(.vakata-context-separator)"</span>).last(); }
									o.addClass(<span class="hljs-string">"vakata-context-hover"</span>).children(<span class="hljs-string">'a'</span>).focus();
									e.stopImmediatePropagation();
									e.preventDefault();
								}
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">39</span>:
								<span class="hljs-keyword">if</span>(vakata_context.is_visible) {
									vakata_context.element.find(<span class="hljs-string">".vakata-context-hover"</span>).last().children(<span class="hljs-string">"ul"</span>).show().children(<span class="hljs-string">"li:not(.vakata-context-separator)"</span>).removeClass(<span class="hljs-string">"vakata-context-hover"</span>).first().addClass(<span class="hljs-string">"vakata-context-hover"</span>).children(<span class="hljs-string">'a'</span>).focus();
									e.stopImmediatePropagation();
									e.preventDefault();
								}
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">40</span>:
								<span class="hljs-keyword">if</span>(vakata_context.is_visible) {
									o = vakata_context.element.find(<span class="hljs-string">"ul:visible"</span>).addBack().last().children(<span class="hljs-string">".vakata-context-hover"</span>).removeClass(<span class="hljs-string">"vakata-context-hover"</span>).nextAll(<span class="hljs-string">"li:not(.vakata-context-separator)"</span>).first();
									<span class="hljs-keyword">if</span>(!o.length) { o = vakata_context.element.find(<span class="hljs-string">"ul:visible"</span>).addBack().last().children(<span class="hljs-string">"li:not(.vakata-context-separator)"</span>).first(); }
									o.addClass(<span class="hljs-string">"vakata-context-hover"</span>).children(<span class="hljs-string">'a'</span>).focus();
									e.stopImmediatePropagation();
									e.preventDefault();
								}
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">case</span> <span class="hljs-number">27</span>:
								$.vakata.context.hide();
								e.preventDefault();
								<span class="hljs-keyword">break</span>;
							<span class="hljs-keyword">default</span>:</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>console.log(e.which);</p></div></div><div class="code"><div class="wrapper">								<span class="hljs-keyword">break</span>;
						}
					})
				.on(<span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					e.preventDefault();
					<span class="hljs-keyword">var</span> a = vakata_context.element.find(<span class="hljs-string">'.vakata-contextmenu-shortcut-'</span> + e.which).parent();
					<span class="hljs-keyword">if</span>(a.parent().not(<span class="hljs-string">'.vakata-context-disabled'</span>)) {
						a.mouseup();
					}
				})
				.appendTo(<span class="hljs-string">"body"</span>);

			$(document)
				.on(<span class="hljs-string">"mousedown"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					<span class="hljs-keyword">if</span>(vakata_context.is_visible &amp;&amp; !$.contains(vakata_context.element[<span class="hljs-number">0</span>], e.target)) { $.vakata.context.hide(); }
				})
				.on(<span class="hljs-string">"context_show.vakata"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
					vakata_context.element.find(<span class="hljs-string">"li:has(ul)"</span>).children(<span class="hljs-string">"a"</span>).addClass(<span class="hljs-string">"vakata-context-parent"</span>);
					<span class="hljs-keyword">if</span>(right_to_left) {
						vakata_context.element.addClass(<span class="hljs-string">"vakata-context-rtl"</span>).css(<span class="hljs-string">"direction"</span>, <span class="hljs-string">"rtl"</span>);
					}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>also apply a RTL class?</p></div></div><div class="code"><div class="wrapper">					vakata_context.element.find(<span class="hljs-string">"ul"</span>).hide().end();
				});
		});
	}($));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>$.jstree.defaults.plugins.push(&quot;contextmenu&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="drag39n39drop-plugin">Drag&#39;n&#39;drop plugin</h3>
<p>Enables dragging and dropping of nodes in the tree, resulting in a move or copy operations.</p></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd and plugin dnd</span></p>
<p>stores all defaults for the drag&#39;n&#39;drop plugin</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.dnd = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd.copy and plugin dnd</span></p>
<p>a boolean indicating if a copy should be possible while dragging (by pressint the meta key or Ctrl). Defaults to <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		copy : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd.open_timeout and plugin dnd</span></p>
<p>a number indicating how long a node should remain hovered while dragging to be opened. Defaults to <code>500</code>.</p></div></div><div class="code"><div class="wrapper">		open_timeout : <span class="hljs-number">500</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd.is_draggable and plugin dnd</span></p>
<p>a function invoked each time a node is about to be dragged, invoked in the tree&#39;s scope and receives the nodes about to be dragged as an argument (array) - return <code>false</code> to prevent dragging</p></div></div><div class="code"><div class="wrapper">		is_draggable : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd.check_while_dragging and plugin dnd</span></p>
<p>a boolean indicating if checks should constantly be made while the user is dragging the node (as opposed to checking only on drop), default is <code>true</code></p></div></div><div class="code"><div class="wrapper">		check_while_dragging : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd.always_copy and plugin dnd</span></p>
<p>a boolean indicating if nodes from this tree should only be copied with dnd (as opposed to moved), default is <code>false</code></p></div></div><div class="code"><div class="wrapper">		always_copy : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.dnd.inside_pos and plugin dnd</span></p>
<p>when dropping a node &quot;inside&quot;, this setting indicates the position the node should go to - it can be an integer or a string: &quot;first&quot; (same as 0) or &quot;last&quot;, default is <code>0</code></p></div></div><div class="code"><div class="wrapper">		inside_pos : <span class="hljs-number">0</span>
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>TODO: now check works by checking for each node individually, how about max_children, unique, etc?
TODO: drop somewhere else - maybe demo only?</p></div></div><div class="code"><div class="wrapper">	$.jstree.plugins.dnd = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);

			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">'mousedown.jstree touchstart.jstree'</span>, <span class="hljs-string">'.jstree-anchor'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
					<span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">this</span>.get_node(e.target),
						mlt = <span class="hljs-keyword">this</span>.is_selected(obj) ? <span class="hljs-keyword">this</span>.get_selected().length : <span class="hljs-number">1</span>;
					<span class="hljs-keyword">if</span>(obj &amp;&amp; obj.id &amp;&amp; obj.id !== <span class="hljs-string">"#"</span> &amp;&amp; (e.which === <span class="hljs-number">1</span> || e.type === <span class="hljs-string">"touchstart"</span>) &amp;&amp;
						(<span class="hljs-keyword">this</span>.settings.dnd.is_draggable === <span class="hljs-literal">true</span> || ($.isFunction(<span class="hljs-keyword">this</span>.settings.dnd.is_draggable) &amp;&amp; <span class="hljs-keyword">this</span>.settings.dnd.is_draggable.call(<span class="hljs-keyword">this</span>, (mlt &gt; <span class="hljs-number">1</span> ? <span class="hljs-keyword">this</span>.get_selected(<span class="hljs-literal">true</span>) : [obj]))))
					) {
						<span class="hljs-keyword">this</span>.element.trigger(<span class="hljs-string">'mousedown.jstree'</span>);
						<span class="hljs-keyword">return</span> $.vakata.dnd.start(e, { <span class="hljs-string">'jstree'</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">'origin'</span> : <span class="hljs-keyword">this</span>, <span class="hljs-string">'obj'</span> : <span class="hljs-keyword">this</span>.get_node(obj,<span class="hljs-literal">true</span>), <span class="hljs-string">'nodes'</span> : mlt &gt; <span class="hljs-number">1</span> ? <span class="hljs-keyword">this</span>.get_selected() : [obj.id] }, <span class="hljs-string">'&lt;div id="jstree-dnd" class="jstree-'</span> + <span class="hljs-keyword">this</span>.get_theme() + ( <span class="hljs-keyword">this</span>.settings.core.themes.responsive ? <span class="hljs-string">' jstree-dnd-responsive'</span> : <span class="hljs-string">''</span> ) + <span class="hljs-string">'"&gt;&lt;i class="jstree-icon jstree-er"&gt;&lt;/i&gt;'</span> + (mlt &gt; <span class="hljs-number">1</span> ? mlt + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.get_string(<span class="hljs-string">'nodes'</span>) : <span class="hljs-keyword">this</span>.get_text(e.currentTarget, <span class="hljs-literal">true</span>)) + <span class="hljs-string">'&lt;ins class="jstree-copy" style="display:none;"&gt;+&lt;/ins&gt;&lt;/div&gt;'</span>);
					}
				}, <span class="hljs-keyword">this</span>));
		};
	};

	$(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>bind only once for all instances</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">var</span> lastmv = <span class="hljs-literal">false</span>,
			laster = <span class="hljs-literal">false</span>,
			opento = <span class="hljs-literal">false</span>,
			marker = $(<span class="hljs-string">'&lt;div id="jstree-marker"&gt;&amp;#160;&lt;/div&gt;'</span>).hide().appendTo(<span class="hljs-string">'body'</span>);

		$(document)
			.bind(<span class="hljs-string">'dnd_start.vakata'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				lastmv = <span class="hljs-literal">false</span>;
			})
			.bind(<span class="hljs-string">'dnd_move.vakata'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				<span class="hljs-keyword">if</span>(opento) { clearTimeout(opento); }
				<span class="hljs-keyword">if</span>(!data.data.jstree) { <span class="hljs-keyword">return</span>; }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if we are hovering the marker image do nothing (can happen on &quot;inside&quot; drags)</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(data.event.target.id &amp;&amp; data.event.target.id === <span class="hljs-string">'jstree-marker'</span>) {
					<span class="hljs-keyword">return</span>;
				}

				<span class="hljs-keyword">var</span> ins = $.jstree.reference(data.event.target),
					ref = <span class="hljs-literal">false</span>,
					off = <span class="hljs-literal">false</span>,
					rel = <span class="hljs-literal">false</span>,
					l, t, h, p, i, o, ok, t1, t2, op, ps, pr, ip, tm;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if we are over an instance</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>(ins &amp;&amp; ins._data &amp;&amp; ins._data.dnd) {
					marker.attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'jstree-'</span> + ins.get_theme() + ( ins.settings.core.themes.responsive ? <span class="hljs-string">' jstree-dnd-responsive'</span> : <span class="hljs-string">''</span> ));
					data.helper
						.children().attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'jstree-'</span> + ins.get_theme() + ( ins.settings.core.themes.responsive ? <span class="hljs-string">' jstree-dnd-responsive'</span> : <span class="hljs-string">''</span> ))
						.find(<span class="hljs-string">'.jstree-copy:eq(0)'</span>)[ data.data.origin &amp;&amp; (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy &amp;&amp; (data.event.metaKey || data.event.ctrlKey))) ? <span class="hljs-string">'show'</span> : <span class="hljs-string">'hide'</span> ]();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if are hovering the container itself add a new root node</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">if</span>( (data.event.target === ins.element[<span class="hljs-number">0</span>] || data.event.target === ins.get_container_ul()[<span class="hljs-number">0</span>]) &amp;&amp; ins.get_container_ul().children().length === <span class="hljs-number">0</span>) {
						ok = <span class="hljs-literal">true</span>;
						<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = data.data.nodes.length; t1 &lt; t2; t1++) {
							ok = ok &amp;&amp; ins.check( (data.data.origin &amp;&amp; (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy &amp;&amp; (data.event.metaKey || data.event.ctrlKey)) ) ? <span class="hljs-string">"copy_node"</span> : <span class="hljs-string">"move_node"</span>), (data.data.origin &amp;&amp; data.data.origin !== ins ? data.data.origin.get_node(data.data.nodes[t1]) : data.data.nodes[t1]), <span class="hljs-string">'#'</span>, <span class="hljs-string">'last'</span>, { <span class="hljs-string">'dnd'</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">'ref'</span> : ins.get_node(<span class="hljs-string">'#'</span>), <span class="hljs-string">'pos'</span> : <span class="hljs-string">'i'</span>, <span class="hljs-string">'is_multi'</span> : (data.data.origin &amp;&amp; data.data.origin !== ins), <span class="hljs-string">'is_foreign'</span> : (!data.data.origin) });
							<span class="hljs-keyword">if</span>(!ok) { <span class="hljs-keyword">break</span>; }
						}
						<span class="hljs-keyword">if</span>(ok) {
							lastmv = { <span class="hljs-string">'ins'</span> : ins, <span class="hljs-string">'par'</span> : <span class="hljs-string">'#'</span>, <span class="hljs-string">'pos'</span> : <span class="hljs-string">'last'</span> };
							marker.hide();
							data.helper.find(<span class="hljs-string">'.jstree-icon:eq(0)'</span>).removeClass(<span class="hljs-string">'jstree-er'</span>).addClass(<span class="hljs-string">'jstree-ok'</span>);
							<span class="hljs-keyword">return</span>;
						}
					}
					<span class="hljs-keyword">else</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if we are hovering a tree node</p></div></div><div class="code"><div class="wrapper">						ref = $(data.event.target).closest(<span class="hljs-string">'.jstree-anchor'</span>);
						<span class="hljs-keyword">if</span>(ref &amp;&amp; ref.length &amp;&amp; ref.parent().is(<span class="hljs-string">'.jstree-closed, .jstree-open, .jstree-leaf'</span>)) {
							off = ref.offset();
							rel = data.event.pageY - off.top;
							h = ref.height();
							<span class="hljs-keyword">if</span>(rel &lt; h / <span class="hljs-number">3</span>) {
								o = [<span class="hljs-string">'b'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'a'</span>];
							}
							<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(rel &gt; h - h / <span class="hljs-number">3</span>) {
								o = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'b'</span>];
							}
							<span class="hljs-keyword">else</span> {
								o = rel &gt; h / <span class="hljs-number">2</span> ? [<span class="hljs-string">'i'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>] : [<span class="hljs-string">'i'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'a'</span>];
							}
							$.each(o, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(j, v)</span> {</span>
								<span class="hljs-keyword">switch</span>(v) {
									<span class="hljs-keyword">case</span> <span class="hljs-string">'b'</span>:
										l = off.left - <span class="hljs-number">6</span>;
										t = off.top;
										p = ins.get_parent(ref);
										i = ref.parent().index();
										<span class="hljs-keyword">break</span>;
									<span class="hljs-keyword">case</span> <span class="hljs-string">'i'</span>:
										ip = ins.settings.dnd.inside_pos;
										tm = ins.get_node(ref.parent());
										l = off.left - <span class="hljs-number">2</span>;
										t = off.top + h / <span class="hljs-number">2</span> + <span class="hljs-number">1</span>;
										p = tm.id;
										i = ip === <span class="hljs-string">'first'</span> ? <span class="hljs-number">0</span> : (ip === <span class="hljs-string">'last'</span> ? tm.children.length : <span class="hljs-built_in">Math</span>.min(ip, tm.children.length));
										<span class="hljs-keyword">break</span>;
									<span class="hljs-keyword">case</span> <span class="hljs-string">'a'</span>:
										l = off.left - <span class="hljs-number">6</span>;
										t = off.top + h;
										p = ins.get_parent(ref);
										i = ref.parent().index() + <span class="hljs-number">1</span>;
										<span class="hljs-keyword">break</span>;
								}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>!
// TODO: moving inside, but the node is not yet loaded?
// the check will work anyway, as when moving the node will be loaded first and checked again
if(v === &#39;i&#39; &amp;&amp; !ins.is_loaded(p)) { }</p></div></div><div class="code"><div class="wrapper">								ok = <span class="hljs-literal">true</span>;
								<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = data.data.nodes.length; t1 &lt; t2; t1++) {
									op = data.data.origin &amp;&amp; (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy &amp;&amp; (data.event.metaKey || data.event.ctrlKey))) ? <span class="hljs-string">"copy_node"</span> : <span class="hljs-string">"move_node"</span>;
									ps = i;
									<span class="hljs-keyword">if</span>(op === <span class="hljs-string">"move_node"</span> &amp;&amp; v === <span class="hljs-string">'a'</span> &amp;&amp; (data.data.origin &amp;&amp; data.data.origin === ins) &amp;&amp; p === ins.get_parent(data.data.nodes[t1])) {
										pr = ins.get_node(p);
										<span class="hljs-keyword">if</span>(ps &gt; $.inArray(data.data.nodes[t1], pr.children)) {
											ps -= <span class="hljs-number">1</span>;
										}
									}
									ok = ok &amp;&amp; ( (ins &amp;&amp; ins.settings &amp;&amp; ins.settings.dnd &amp;&amp; ins.settings.dnd.check_while_dragging === <span class="hljs-literal">false</span>) || ins.check(op, (data.data.origin &amp;&amp; data.data.origin !== ins ? data.data.origin.get_node(data.data.nodes[t1]) : data.data.nodes[t1]), p, ps, { <span class="hljs-string">'dnd'</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">'ref'</span> : ins.get_node(ref.parent()), <span class="hljs-string">'pos'</span> : v, <span class="hljs-string">'is_multi'</span> : (data.data.origin &amp;&amp; data.data.origin !== ins), <span class="hljs-string">'is_foreign'</span> : (!data.data.origin) }) );
									<span class="hljs-keyword">if</span>(!ok) {
										<span class="hljs-keyword">if</span>(ins &amp;&amp; ins.last_error) { laster = ins.last_error(); }
										<span class="hljs-keyword">break</span>;
									}
								}
								<span class="hljs-keyword">if</span>(ok) {
									<span class="hljs-keyword">if</span>(v === <span class="hljs-string">'i'</span> &amp;&amp; ref.parent().is(<span class="hljs-string">'.jstree-closed'</span>) &amp;&amp; ins.settings.dnd.open_timeout) {
										opento = setTimeout((<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(x, z)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> x.open_node(z); }; }(ins, ref)), ins.settings.dnd.open_timeout);
									}
									lastmv = { <span class="hljs-string">'ins'</span> : ins, <span class="hljs-string">'par'</span> : p, <span class="hljs-string">'pos'</span> : v === <span class="hljs-string">'i'</span> &amp;&amp; ip === <span class="hljs-string">'last'</span> &amp;&amp; i === <span class="hljs-number">0</span> &amp;&amp; !ins.is_loaded(tm) ? <span class="hljs-string">'last'</span> : i };
									marker.css({ <span class="hljs-string">'left'</span> : l + <span class="hljs-string">'px'</span>, <span class="hljs-string">'top'</span> : t + <span class="hljs-string">'px'</span> }).show();
									data.helper.find(<span class="hljs-string">'.jstree-icon:eq(0)'</span>).removeClass(<span class="hljs-string">'jstree-er'</span>).addClass(<span class="hljs-string">'jstree-ok'</span>);
									laster = {};
									o = <span class="hljs-literal">true</span>;
									<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
								}
							});
							<span class="hljs-keyword">if</span>(o === <span class="hljs-literal">true</span>) { <span class="hljs-keyword">return</span>; }
						}
					}
				}
				lastmv = <span class="hljs-literal">false</span>;
				data.helper.find(<span class="hljs-string">'.jstree-icon'</span>).removeClass(<span class="hljs-string">'jstree-ok'</span>).addClass(<span class="hljs-string">'jstree-er'</span>);
				marker.hide();
			})
			.bind(<span class="hljs-string">'dnd_scroll.vakata'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				<span class="hljs-keyword">if</span>(!data.data.jstree) { <span class="hljs-keyword">return</span>; }
				marker.hide();
				lastmv = <span class="hljs-literal">false</span>;
				data.helper.find(<span class="hljs-string">'.jstree-icon:eq(0)'</span>).removeClass(<span class="hljs-string">'jstree-ok'</span>).addClass(<span class="hljs-string">'jstree-er'</span>);
			})
			.bind(<span class="hljs-string">'dnd_stop.vakata'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				<span class="hljs-keyword">if</span>(opento) { clearTimeout(opento); }
				<span class="hljs-keyword">if</span>(!data.data.jstree) { <span class="hljs-keyword">return</span>; }
				marker.hide();
				<span class="hljs-keyword">var</span> i, j, nodes = [];
				<span class="hljs-keyword">if</span>(lastmv) {
					<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = data.data.nodes.length; i &lt; j; i++) {
						nodes[i] = data.data.origin ? data.data.origin.get_node(data.data.nodes[i]) : data.data.nodes[i];
						<span class="hljs-keyword">if</span>(data.data.origin) {
							nodes[i].instance = data.data.origin;
						}
					}
					lastmv.ins[ data.data.origin &amp;&amp; (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy &amp;&amp; (data.event.metaKey || data.event.ctrlKey))) ? <span class="hljs-string">'copy_node'</span> : <span class="hljs-string">'move_node'</span> ](nodes, lastmv.par, lastmv.pos);
				}
				<span class="hljs-keyword">else</span> {
					i = $(data.event.target).closest(<span class="hljs-string">'.jstree'</span>);
					<span class="hljs-keyword">if</span>(i.length &amp;&amp; laster &amp;&amp; laster.error &amp;&amp; laster.error === <span class="hljs-string">'check'</span>) {
						i = i.jstree(<span class="hljs-literal">true</span>);
						<span class="hljs-keyword">if</span>(i) {
							i.settings.core.error.call(<span class="hljs-keyword">this</span>, laster);
						}
					}
				}
			})
			.bind(<span class="hljs-string">'keyup keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				data = $.vakata.dnd._get();
				<span class="hljs-keyword">if</span>(data.data &amp;&amp; data.data.jstree) {
					data.helper.find(<span class="hljs-string">'.jstree-copy:eq(0)'</span>)[ data.data.origin &amp;&amp; (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy &amp;&amp; (e.metaKey || e.ctrlKey))) ? <span class="hljs-string">'show'</span> : <span class="hljs-string">'hide'</span> ]();
				}
			});
	});</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>helpers</p></div></div><div class="code"><div class="wrapper">	(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>private variable</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">var</span> vakata_dnd = {
			element	: <span class="hljs-literal">false</span>,
			target	: <span class="hljs-literal">false</span>,
			is_down	: <span class="hljs-literal">false</span>,
			is_drag	: <span class="hljs-literal">false</span>,
			helper	: <span class="hljs-literal">false</span>,
			helper_w: <span class="hljs-number">0</span>,
			data	: <span class="hljs-literal">false</span>,
			init_x	: <span class="hljs-number">0</span>,
			init_y	: <span class="hljs-number">0</span>,
			scroll_l: <span class="hljs-number">0</span>,
			scroll_t: <span class="hljs-number">0</span>,
			scroll_e: <span class="hljs-literal">false</span>,
			scroll_i: <span class="hljs-literal">false</span>,
			is_touch: <span class="hljs-literal">false</span>
		};
		$.vakata.dnd = {
			settings : {
				scroll_speed		: <span class="hljs-number">10</span>,
				scroll_proximity	: <span class="hljs-number">20</span>,
				helper_left			: <span class="hljs-number">5</span>,
				helper_top			: <span class="hljs-number">10</span>,
				threshold			: <span class="hljs-number">5</span>,
				threshold_touch		: <span class="hljs-number">50</span>
			},
			_trigger : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event_name, e)</span> {</span>
				<span class="hljs-keyword">var</span> data = $.vakata.dnd._get();
				data.event = e;
				$(document).triggerHandler(<span class="hljs-string">"dnd_"</span> + event_name + <span class="hljs-string">".vakata"</span>, data);
			},
			_get : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">return</span> {
					<span class="hljs-string">"data"</span>		: vakata_dnd.data,
					<span class="hljs-string">"element"</span>	: vakata_dnd.element,
					<span class="hljs-string">"helper"</span>	: vakata_dnd.helper
				};
			},
			_clean : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">if</span>(vakata_dnd.helper) { vakata_dnd.helper.remove(); }
				<span class="hljs-keyword">if</span>(vakata_dnd.scroll_i) { clearInterval(vakata_dnd.scroll_i); vakata_dnd.scroll_i = <span class="hljs-literal">false</span>; }
				vakata_dnd = {
					element	: <span class="hljs-literal">false</span>,
					target	: <span class="hljs-literal">false</span>,
					is_down	: <span class="hljs-literal">false</span>,
					is_drag	: <span class="hljs-literal">false</span>,
					helper	: <span class="hljs-literal">false</span>,
					helper_w: <span class="hljs-number">0</span>,
					data	: <span class="hljs-literal">false</span>,
					init_x	: <span class="hljs-number">0</span>,
					init_y	: <span class="hljs-number">0</span>,
					scroll_l: <span class="hljs-number">0</span>,
					scroll_t: <span class="hljs-number">0</span>,
					scroll_e: <span class="hljs-literal">false</span>,
					scroll_i: <span class="hljs-literal">false</span>,
					is_touch: <span class="hljs-literal">false</span>
				};
				$(document).off(<span class="hljs-string">"mousemove touchmove"</span>, $.vakata.dnd.drag);
				$(document).off(<span class="hljs-string">"mouseup touchend"</span>, $.vakata.dnd.stop);
			},
			_scroll : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(init_only)</span> {</span>
				<span class="hljs-keyword">if</span>(!vakata_dnd.scroll_e || (!vakata_dnd.scroll_l &amp;&amp; !vakata_dnd.scroll_t)) {
					<span class="hljs-keyword">if</span>(vakata_dnd.scroll_i) { clearInterval(vakata_dnd.scroll_i); vakata_dnd.scroll_i = <span class="hljs-literal">false</span>; }
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">if</span>(!vakata_dnd.scroll_i) {
					vakata_dnd.scroll_i = setInterval($.vakata.dnd._scroll, <span class="hljs-number">100</span>);
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">if</span>(init_only === <span class="hljs-literal">true</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }

				<span class="hljs-keyword">var</span> i = vakata_dnd.scroll_e.scrollTop(),
					j = vakata_dnd.scroll_e.scrollLeft();
				vakata_dnd.scroll_e.scrollTop(i + vakata_dnd.scroll_t * $.vakata.dnd.settings.scroll_speed);
				vakata_dnd.scroll_e.scrollLeft(j + vakata_dnd.scroll_l * $.vakata.dnd.settings.scroll_speed);
				<span class="hljs-keyword">if</span>(i !== vakata_dnd.scroll_e.scrollTop() || j !== vakata_dnd.scroll_e.scrollLeft()) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin dnd, and name dnd_scroll.vakata</span></p>
<p>triggered on the document when a drag causes an element to scroll</p>
<p>Parameters:</p>
<ul>
<li><p><strong>data can be of any type.</strong><br/>(any data supplied with the call to $.vakata.dnd.start)</p>
</li>
<li><p><strong>element must be a DOM.</strong><br/>(the DOM element being dragged)</p>
</li>
<li><p><strong>helper must be a jQuery.</strong><br/>(the helper shown next to the mouse)</p>
</li>
<li><p><strong>event must be a jQuery.</strong><br/>(the element that is scrolling)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">					$.vakata.dnd._trigger(<span class="hljs-string">"scroll"</span>, vakata_dnd.scroll_e);
				}
			},
			start : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data, html)</span> {</span>
				<span class="hljs-keyword">if</span>(e.type === <span class="hljs-string">"touchstart"</span> &amp;&amp; e.originalEvent &amp;&amp; e.originalEvent.changedTouches &amp;&amp; e.originalEvent.changedTouches[<span class="hljs-number">0</span>]) {
					e.pageX = e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageX;
					e.pageY = e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageY;
					e.target = document.elementFromPoint(e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageX - window.pageXOffset, e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageY - window.pageYOffset);
				}
				<span class="hljs-keyword">if</span>(vakata_dnd.is_drag) { $.vakata.dnd.stop({}); }
				<span class="hljs-keyword">try</span> {
					e.currentTarget.unselectable = <span class="hljs-string">"on"</span>;
					e.currentTarget.onselectstart = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; };
					<span class="hljs-keyword">if</span>(e.currentTarget.style) { e.currentTarget.style.MozUserSelect = <span class="hljs-string">"none"</span>; }
				} <span class="hljs-keyword">catch</span>(ignore) { }
				vakata_dnd.init_x	= e.pageX;
				vakata_dnd.init_y	= e.pageY;
				vakata_dnd.data		= data;
				vakata_dnd.is_down	= <span class="hljs-literal">true</span>;
				vakata_dnd.element	= e.currentTarget;
				vakata_dnd.target	= e.target;
				vakata_dnd.is_touch	= e.type === <span class="hljs-string">"touchstart"</span>;
				<span class="hljs-keyword">if</span>(html !== <span class="hljs-literal">false</span>) {
					vakata_dnd.helper = $(<span class="hljs-string">"&lt;div id='vakata-dnd'&gt;&lt;/div&gt;"</span>).html(html).css({
						<span class="hljs-string">"display"</span>		: <span class="hljs-string">"block"</span>,
						<span class="hljs-string">"margin"</span>		: <span class="hljs-string">"0"</span>,
						<span class="hljs-string">"padding"</span>		: <span class="hljs-string">"0"</span>,
						<span class="hljs-string">"position"</span>		: <span class="hljs-string">"absolute"</span>,
						<span class="hljs-string">"top"</span>			: <span class="hljs-string">"-2000px"</span>,
						<span class="hljs-string">"lineHeight"</span>	: <span class="hljs-string">"16px"</span>,
						<span class="hljs-string">"zIndex"</span>		: <span class="hljs-string">"10000"</span>
					});
				}
				$(document).bind(<span class="hljs-string">"mousemove touchmove"</span>, $.vakata.dnd.drag);
				$(document).bind(<span class="hljs-string">"mouseup touchend"</span>, $.vakata.dnd.stop);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			},
			drag : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
				<span class="hljs-keyword">if</span>(e.type === <span class="hljs-string">"touchmove"</span> &amp;&amp; e.originalEvent &amp;&amp; e.originalEvent.changedTouches &amp;&amp; e.originalEvent.changedTouches[<span class="hljs-number">0</span>]) {
					e.pageX = e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageX;
					e.pageY = e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageY;
					e.target = document.elementFromPoint(e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageX - window.pageXOffset, e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageY - window.pageYOffset);
				}
				<span class="hljs-keyword">if</span>(!vakata_dnd.is_down) { <span class="hljs-keyword">return</span>; }
				<span class="hljs-keyword">if</span>(!vakata_dnd.is_drag) {
					<span class="hljs-keyword">if</span>(
						<span class="hljs-built_in">Math</span>.abs(e.pageX - vakata_dnd.init_x) &gt; (vakata_dnd.is_touch ? $.vakata.dnd.settings.threshold_touch : $.vakata.dnd.settings.threshold) ||
						<span class="hljs-built_in">Math</span>.abs(e.pageY - vakata_dnd.init_y) &gt; (vakata_dnd.is_touch ? $.vakata.dnd.settings.threshold_touch : $.vakata.dnd.settings.threshold)
					) {
						<span class="hljs-keyword">if</span>(vakata_dnd.helper) {
							vakata_dnd.helper.appendTo(<span class="hljs-string">"body"</span>);
							vakata_dnd.helper_w = vakata_dnd.helper.outerWidth();
						}
						vakata_dnd.is_drag = <span class="hljs-literal">true</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin dnd, and name dnd_start.vakata</span></p>
<p>triggered on the document when a drag starts</p>
<p>Parameters:</p>
<ul>
<li><p><strong>data can be of any type.</strong><br/>(any data supplied with the call to $.vakata.dnd.start)</p>
</li>
<li><p><strong>element must be a DOM.</strong><br/>(the DOM element being dragged)</p>
</li>
<li><p><strong>helper must be a jQuery.</strong><br/>(the helper shown next to the mouse)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event that caused the start (probably mousemove))</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">						$.vakata.dnd._trigger(<span class="hljs-string">"start"</span>, e);
					}
					<span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span>; }
				}

				<span class="hljs-keyword">var</span> d  = <span class="hljs-literal">false</span>, w  = <span class="hljs-literal">false</span>,
					dh = <span class="hljs-literal">false</span>, wh = <span class="hljs-literal">false</span>,
					dw = <span class="hljs-literal">false</span>, ww = <span class="hljs-literal">false</span>,
					dt = <span class="hljs-literal">false</span>, dl = <span class="hljs-literal">false</span>,
					ht = <span class="hljs-literal">false</span>, hl = <span class="hljs-literal">false</span>;

				vakata_dnd.scroll_t = <span class="hljs-number">0</span>;
				vakata_dnd.scroll_l = <span class="hljs-number">0</span>;
				vakata_dnd.scroll_e = <span class="hljs-literal">false</span>;
				$($(e.target).parentsUntil(<span class="hljs-string">"body"</span>).addBack().get().reverse())
					.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">return</span>	(<span class="hljs-regexp">/^auto|scroll$/</span>).test($(<span class="hljs-keyword">this</span>).css(<span class="hljs-string">"overflow"</span>)) &amp;&amp;
								(<span class="hljs-keyword">this</span>.scrollHeight &gt; <span class="hljs-keyword">this</span>.offsetHeight || <span class="hljs-keyword">this</span>.scrollWidth &gt; <span class="hljs-keyword">this</span>.offsetWidth);
					})
					.each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">var</span> t = $(<span class="hljs-keyword">this</span>), o = t.offset();
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.scrollHeight &gt; <span class="hljs-keyword">this</span>.offsetHeight) {
							<span class="hljs-keyword">if</span>(o.top + t.height() - e.pageY &lt; $.vakata.dnd.settings.scroll_proximity)	{ vakata_dnd.scroll_t = <span class="hljs-number">1</span>; }
							<span class="hljs-keyword">if</span>(e.pageY - o.top &lt; $.vakata.dnd.settings.scroll_proximity)				{ vakata_dnd.scroll_t = -<span class="hljs-number">1</span>; }
						}
						<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.scrollWidth &gt; <span class="hljs-keyword">this</span>.offsetWidth) {
							<span class="hljs-keyword">if</span>(o.left + t.width() - e.pageX &lt; $.vakata.dnd.settings.scroll_proximity)	{ vakata_dnd.scroll_l = <span class="hljs-number">1</span>; }
							<span class="hljs-keyword">if</span>(e.pageX - o.left &lt; $.vakata.dnd.settings.scroll_proximity)				{ vakata_dnd.scroll_l = -<span class="hljs-number">1</span>; }
						}
						<span class="hljs-keyword">if</span>(vakata_dnd.scroll_t || vakata_dnd.scroll_l) {
							vakata_dnd.scroll_e = $(<span class="hljs-keyword">this</span>);
							<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
						}
					});

				<span class="hljs-keyword">if</span>(!vakata_dnd.scroll_e) {
					d  = $(document); w = $(window);
					dh = d.height(); wh = w.height();
					dw = d.width(); ww = w.width();
					dt = d.scrollTop(); dl = d.scrollLeft();
					<span class="hljs-keyword">if</span>(dh &gt; wh &amp;&amp; e.pageY - dt &lt; $.vakata.dnd.settings.scroll_proximity)		{ vakata_dnd.scroll_t = -<span class="hljs-number">1</span>;  }
					<span class="hljs-keyword">if</span>(dh &gt; wh &amp;&amp; wh - (e.pageY - dt) &lt; $.vakata.dnd.settings.scroll_proximity)	{ vakata_dnd.scroll_t = <span class="hljs-number">1</span>; }
					<span class="hljs-keyword">if</span>(dw &gt; ww &amp;&amp; e.pageX - dl &lt; $.vakata.dnd.settings.scroll_proximity)		{ vakata_dnd.scroll_l = -<span class="hljs-number">1</span>; }
					<span class="hljs-keyword">if</span>(dw &gt; ww &amp;&amp; ww - (e.pageX - dl) &lt; $.vakata.dnd.settings.scroll_proximity)	{ vakata_dnd.scroll_l = <span class="hljs-number">1</span>; }
					<span class="hljs-keyword">if</span>(vakata_dnd.scroll_t || vakata_dnd.scroll_l) {
						vakata_dnd.scroll_e = d;
					}
				}
				<span class="hljs-keyword">if</span>(vakata_dnd.scroll_e) { $.vakata.dnd._scroll(<span class="hljs-literal">true</span>); }

				<span class="hljs-keyword">if</span>(vakata_dnd.helper) {
					ht = <span class="hljs-built_in">parseInt</span>(e.pageY + $.vakata.dnd.settings.helper_top, <span class="hljs-number">10</span>);
					hl = <span class="hljs-built_in">parseInt</span>(e.pageX + $.vakata.dnd.settings.helper_left, <span class="hljs-number">10</span>);
					<span class="hljs-keyword">if</span>(dh &amp;&amp; ht + <span class="hljs-number">25</span> &gt; dh) { ht = dh - <span class="hljs-number">50</span>; }
					<span class="hljs-keyword">if</span>(dw &amp;&amp; hl + vakata_dnd.helper_w &gt; dw) { hl = dw - (vakata_dnd.helper_w + <span class="hljs-number">2</span>); }
					vakata_dnd.helper.css({
						left	: hl + <span class="hljs-string">"px"</span>,
						top		: ht + <span class="hljs-string">"px"</span>
					});
				}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin dnd, and name dnd_move.vakata</span></p>
<p>triggered on the document when a drag is in progress</p>
<p>Parameters:</p>
<ul>
<li><p><strong>data can be of any type.</strong><br/>(any data supplied with the call to $.vakata.dnd.start)</p>
</li>
<li><p><strong>element must be a DOM.</strong><br/>(the DOM element being dragged)</p>
</li>
<li><p><strong>helper must be a jQuery.</strong><br/>(the helper shown next to the mouse)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event that caused this to trigger (most likely mousemove))</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">				$.vakata.dnd._trigger(<span class="hljs-string">"move"</span>, e);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			},
			stop : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
				<span class="hljs-keyword">if</span>(e.type === <span class="hljs-string">"touchend"</span> &amp;&amp; e.originalEvent &amp;&amp; e.originalEvent.changedTouches &amp;&amp; e.originalEvent.changedTouches[<span class="hljs-number">0</span>]) {
					e.pageX = e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageX;
					e.pageY = e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageY;
					e.target = document.elementFromPoint(e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageX - window.pageXOffset, e.originalEvent.changedTouches[<span class="hljs-number">0</span>].pageY - window.pageYOffset);
				}
				<span class="hljs-keyword">if</span>(vakata_dnd.is_drag) {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, plugin dnd, and name dnd_stop.vakata</span></p>
<p>triggered on the document when a drag stops (the dragged element is dropped)</p>
<p>Parameters:</p>
<ul>
<li><p><strong>data can be of any type.</strong><br/>(any data supplied with the call to $.vakata.dnd.start)</p>
</li>
<li><p><strong>element must be a DOM.</strong><br/>(the DOM element being dragged)</p>
</li>
<li><p><strong>helper must be a jQuery.</strong><br/>(the helper shown next to the mouse)</p>
</li>
<li><p><strong>event must be an Object.</strong><br/>(the event that caused the stop)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">					$.vakata.dnd._trigger(<span class="hljs-string">"stop"</span>, e);
				}
				<span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">if</span>(e.type === <span class="hljs-string">"touchend"</span> &amp;&amp; e.target === vakata_dnd.target) {
						<span class="hljs-keyword">var</span> to = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> $(e.target).click(); }, <span class="hljs-number">100</span>);
						$(e.target).one(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">if</span>(to) { clearTimeout(to); } });
					}
				}
				$.vakata.dnd._clean();
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
			}
		};
	}($));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the dnd plugin by default
$.jstree.defaults.plugins.push(&quot;dnd&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="search-plugin">Search plugin</h3>
<p>Adds search functionality to jsTree.</p></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search and plugin search</span></p>
<p>stores all defaults for the search plugin</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.search = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.ajax and plugin search</span></p>
<p>a jQuery-like AJAX config, which jstree uses if a server should be queried for results. </p>
<p>A <code>str</code> (which is the search string) parameter will be added with the request. The expected result is a JSON array with nodes that need to be opened so that matching nodes will be revealed.
Leave this setting as <code>false</code> to not query the server. You can also set this to a function, which will be invoked in the instance&#39;s scope and receive 2 parameters - the search string and the callback to call with the array of nodes to load.</p></div></div><div class="code"><div class="wrapper">		ajax : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.fuzzy and plugin search</span></p>
<p>Indicates if the search should be fuzzy or not (should <code>chnd3</code> match <code>child node 3</code>). Default is <code>false</code>.</p></div></div><div class="code"><div class="wrapper">		fuzzy : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.case_sensitive and plugin search</span></p>
<p>Indicates if the search should be case sensitive. Default is <code>false</code>.</p></div></div><div class="code"><div class="wrapper">		case_sensitive : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.show_only_matches and plugin search</span></p>
<p>Indicates if the tree should be filtered to show only matching nodes (keep in mind this can be a heavy on large trees in old browsers). Default is <code>false</code>.</p></div></div><div class="code"><div class="wrapper">		show_only_matches : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.close_opened_onclear and plugin search</span></p>
<p>Indicates if all nodes opened to reveal the search result, should be closed when the search is cleared or a new search is performed. Default is <code>true</code>.</p></div></div><div class="code"><div class="wrapper">		close_opened_onclear : <span class="hljs-literal">true</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.search_leaves_only and plugin search</span></p>
<p>Indicates if only leaf nodes should be included in search results. Default is <code>false</code>.</p></div></div><div class="code"><div class="wrapper">		search_leaves_only : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.search.search_callback and plugin search</span></p>
<p>If set to a function it wil be called in the instance&#39;s scope with two arguments - search string and node (where node will be every node in the structure, so use with caution).
If the function returns a truthy value the node will be considered a match (it might not be displayed if search_only_leaves is set to true and the node is not a leaf). Default is <code>false</code>.</p></div></div><div class="code"><div class="wrapper">		search_callback : <span class="hljs-literal">false</span>
	};

	$.jstree.plugins.search = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);

			<span class="hljs-keyword">this</span>._data.search.str = <span class="hljs-string">""</span>;
			<span class="hljs-keyword">this</span>._data.search.dom = $();
			<span class="hljs-keyword">this</span>._data.search.res = [];
			<span class="hljs-keyword">this</span>._data.search.opn = [];

			<span class="hljs-keyword">this</span>.element.on(<span class="hljs-string">'before_open.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
				<span class="hljs-keyword">var</span> i, j, f, r = <span class="hljs-keyword">this</span>._data.search.res, s = [], o = $();
				<span class="hljs-keyword">if</span>(r &amp;&amp; r.length) {
					<span class="hljs-keyword">this</span>._data.search.dom = $(<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].querySelectorAll(<span class="hljs-string">'#'</span> + $.map(r, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(v)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-string">"0123456789"</span>.indexOf(v[<span class="hljs-number">0</span>]) !== -<span class="hljs-number">1</span> ? <span class="hljs-string">'\\3'</span> + v[<span class="hljs-number">0</span>] + <span class="hljs-string">' '</span> + v.substr(<span class="hljs-number">1</span>).replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>) : v.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>); }).join(<span class="hljs-string">', #'</span>)));
					<span class="hljs-keyword">this</span>._data.search.dom.children(<span class="hljs-string">".jstree-anchor"</span>).addClass(<span class="hljs-string">'jstree-search'</span>);
					<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.search.show_only_matches &amp;&amp; <span class="hljs-keyword">this</span>._data.search.res.length) {
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = r.length; i &lt; j; i++) {
							s = s.concat(<span class="hljs-keyword">this</span>.get_node(r[i]).parents);
						}
						s = $.vakata.array_remove_item($.vakata.array_unique(s),<span class="hljs-string">'#'</span>);
						o = s.length ? $(<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].querySelectorAll(<span class="hljs-string">'#'</span> + $.map(s, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(v)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-string">"0123456789"</span>.indexOf(v[<span class="hljs-number">0</span>]) !== -<span class="hljs-number">1</span> ? <span class="hljs-string">'\\3'</span> + v[<span class="hljs-number">0</span>] + <span class="hljs-string">' '</span> + v.substr(<span class="hljs-number">1</span>).replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>) : v.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>); }).join(<span class="hljs-string">', #'</span>))) : $();

						<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">".jstree-node"</span>).hide().filter(<span class="hljs-string">'.jstree-last'</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nextSibling; }).removeClass(<span class="hljs-string">'jstree-last'</span>);
						o = o.add(<span class="hljs-keyword">this</span>._data.search.dom);
						o.parentsUntil(<span class="hljs-string">".jstree"</span>).addBack().show()
							.filter(<span class="hljs-string">".jstree-children"</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> $(<span class="hljs-keyword">this</span>).children(<span class="hljs-string">".jstree-node:visible"</span>).eq(-<span class="hljs-number">1</span>).addClass(<span class="hljs-string">"jstree-last"</span>); });
					}
				}
			}, <span class="hljs-keyword">this</span>));
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.search.show_only_matches) {
				<span class="hljs-keyword">this</span>.element
					.on(<span class="hljs-string">"search.jstree"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">if</span>(data.nodes.length) {
							$(<span class="hljs-keyword">this</span>).find(<span class="hljs-string">".jstree-node"</span>).hide().filter(<span class="hljs-string">'.jstree-last'</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nextSibling; }).removeClass(<span class="hljs-string">'jstree-last'</span>);
							data.nodes.parentsUntil(<span class="hljs-string">".jstree"</span>).addBack().show()
								.filter(<span class="hljs-string">".jstree-children"</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> $(<span class="hljs-keyword">this</span>).children(<span class="hljs-string">".jstree-node:visible"</span>).eq(-<span class="hljs-number">1</span>).addClass(<span class="hljs-string">"jstree-last"</span>); });
						}
					})
					.on(<span class="hljs-string">"clear_search.jstree"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">if</span>(data.nodes.length) {
							$(<span class="hljs-keyword">this</span>).find(<span class="hljs-string">".jstree-node"</span>).css(<span class="hljs-string">"display"</span>,<span class="hljs-string">""</span>).filter(<span class="hljs-string">'.jstree-last'</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nextSibling; }).removeClass(<span class="hljs-string">'jstree-last'</span>);
						}
					});
			}
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name search(str [, skip_async]), plugin search, and trigger search.jstree</span></p>
<p>used to search the tree nodes for a given string</p>
<p>Parameters:</p>
<ul>
<li><p><strong>str must be a String.</strong><br/>(the search string)</p>
</li>
<li><p><strong>skip_async must be a Boolean.</strong><br/>(if set to true server will not be queried even if configured)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.search = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(str, skip_async)</span> {</span>
			<span class="hljs-keyword">if</span>(str === <span class="hljs-literal">false</span> || $.trim(str.toString()) === <span class="hljs-string">""</span>) {
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.clear_search();
			}
			str = str.toString();
			<span class="hljs-keyword">var</span> s = <span class="hljs-keyword">this</span>.settings.search,
				a = s.ajax ? s.ajax : <span class="hljs-literal">false</span>,
				f = <span class="hljs-literal">null</span>,
				r = [],
				p = [], i, j;
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._data.search.res.length) {
				<span class="hljs-keyword">this</span>.clear_search();
			}
			<span class="hljs-keyword">if</span>(!skip_async &amp;&amp; a !== <span class="hljs-literal">false</span>) {
				<span class="hljs-keyword">if</span>($.isFunction(a)) {
					<span class="hljs-keyword">return</span> a.call(<span class="hljs-keyword">this</span>, str, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> {</span>
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.d) { d = d.d; }
							<span class="hljs-keyword">this</span>._load_nodes(!$.isArray(d) ? [] : $.vakata.array_unique(d), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
								<span class="hljs-keyword">this</span>.search(str, <span class="hljs-literal">true</span>);
							}, <span class="hljs-literal">true</span>);
						}, <span class="hljs-keyword">this</span>));
				}
				<span class="hljs-keyword">else</span> {
					a = $.extend({}, a);
					<span class="hljs-keyword">if</span>(!a.data) { a.data = {}; }
					a.data.str = str;
					<span class="hljs-keyword">return</span> $.ajax(a)
						.fail($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
							<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'ajax'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'search'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'search_01'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Could not load search parents'</span>, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify(a) };
							<span class="hljs-keyword">this</span>.settings.core.error.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._data.core.last_error);
						}, <span class="hljs-keyword">this</span>))
						.done($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> {</span>
							<span class="hljs-keyword">if</span>(d &amp;&amp; d.d) { d = d.d; }
							<span class="hljs-keyword">this</span>._load_nodes(!$.isArray(d) ? [] : $.vakata.array_unique(d), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
								<span class="hljs-keyword">this</span>.search(str, <span class="hljs-literal">true</span>);
							}, <span class="hljs-literal">true</span>);
						}, <span class="hljs-keyword">this</span>));
				}
			}
			<span class="hljs-keyword">this</span>._data.search.str = str;
			<span class="hljs-keyword">this</span>._data.search.dom = $();
			<span class="hljs-keyword">this</span>._data.search.res = [];
			<span class="hljs-keyword">this</span>._data.search.opn = [];

			f = <span class="hljs-keyword">new</span> $.vakata.search(str, <span class="hljs-literal">true</span>, { caseSensitive : s.case_sensitive, fuzzy : s.fuzzy });

			$.each(<span class="hljs-keyword">this</span>._model.data, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
				<span class="hljs-keyword">if</span>(v.text &amp;&amp; ( (s.search_callback &amp;&amp; s.search_callback.call(<span class="hljs-keyword">this</span>, str, v)) || (!s.search_callback &amp;&amp; f.search(v.text).isMatch) ) &amp;&amp; (!s.search_leaves_only || (v.state.loaded &amp;&amp; v.children.length === <span class="hljs-number">0</span>)) ) {
					r.push(i);
					p = p.concat(v.parents);
				}
			});
			<span class="hljs-keyword">if</span>(r.length) {
				p = $.vakata.array_unique(p);
				<span class="hljs-keyword">this</span>._search_open(p);
				<span class="hljs-keyword">this</span>._data.search.dom = $(<span class="hljs-keyword">this</span>.element[<span class="hljs-number">0</span>].querySelectorAll(<span class="hljs-string">'#'</span> + $.map(r, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(v)</span> {</span> <span class="hljs-keyword">return</span> <span class="hljs-string">"0123456789"</span>.indexOf(v[<span class="hljs-number">0</span>]) !== -<span class="hljs-number">1</span> ? <span class="hljs-string">'\\3'</span> + v[<span class="hljs-number">0</span>] + <span class="hljs-string">' '</span> + v.substr(<span class="hljs-number">1</span>).replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>) : v.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>); }).join(<span class="hljs-string">', #'</span>)));
				<span class="hljs-keyword">this</span>._data.search.res = r;
				<span class="hljs-keyword">this</span>._data.search.dom.children(<span class="hljs-string">".jstree-anchor"</span>).addClass(<span class="hljs-string">'jstree-search'</span>);
			}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name search.jstree, and plugin search</span></p>
<p>triggered after search is complete</p>
<p>Parameters:</p>
<ul>
<li><p><strong>nodes must be a jQuery.</strong><br/>(a jQuery collection of matching nodes)</p>
</li>
<li><p><strong>str must be a String.</strong><br/>(the search string)</p>
</li>
<li><p><strong>res must be an Array.</strong><br/>(a collection of objects represeing the matching nodes)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'search'</span>, { nodes : <span class="hljs-keyword">this</span>._data.search.dom, str : str, res : <span class="hljs-keyword">this</span>._data.search.res });
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name clear_search(), plugin search, and trigger clear_search.jstree</span></p>
<p>used to clear the last search (removes classes and shows all nodes if filtering is on)</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.clear_search = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>._data.search.dom.children(<span class="hljs-string">".jstree-anchor"</span>).removeClass(<span class="hljs-string">"jstree-search"</span>);
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.search.close_opened_onclear) {
				<span class="hljs-keyword">this</span>.close_node(<span class="hljs-keyword">this</span>._data.search.opn, <span class="hljs-number">0</span>);
			}</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> event, name clear_search.jstree, and plugin search</span></p>
<p>triggered after search is complete</p>
<p>Parameters:</p>
<ul>
<li><p><strong>nodes must be a jQuery.</strong><br/>(a jQuery collection of matching nodes (the result from the last search))</p>
</li>
<li><p><strong>str must be a String.</strong><br/>(the search string (the last search string))</p>
</li>
<li><p><strong>res must be an Array.</strong><br/>(a collection of objects represeing the matching nodes (the result from the last search))</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'clear_search'</span>, { <span class="hljs-string">'nodes'</span> : <span class="hljs-keyword">this</span>._data.search.dom, str : <span class="hljs-keyword">this</span>._data.search.str, res : <span class="hljs-keyword">this</span>._data.search.res });
			<span class="hljs-keyword">this</span>._data.search.str = <span class="hljs-string">""</span>;
			<span class="hljs-keyword">this</span>._data.search.res = [];
			<span class="hljs-keyword">this</span>._data.search.opn = [];
			<span class="hljs-keyword">this</span>._data.search.dom = $();
		};</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name _search_open(d) and plugin search</span></p>
<p>opens nodes that need to be opened to reveal the search results. Used only internally.</p>
<p>Parameters:</p>
<ul>
<li><strong>d must be an Array.</strong><br/>(an array of node IDs)</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>._search_open = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> {</span>
			<span class="hljs-keyword">var</span> t = <span class="hljs-keyword">this</span>;
			$.each(d.concat([]), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, v)</span> {</span>
				<span class="hljs-keyword">if</span>(v === <span class="hljs-string">"#"</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
				<span class="hljs-keyword">try</span> { v = $(<span class="hljs-string">'#'</span> + v.replace($.jstree.idregex,<span class="hljs-string">'\\$&amp;'</span>), t.element); } <span class="hljs-keyword">catch</span>(ignore) { }
				<span class="hljs-keyword">if</span>(v &amp;&amp; v.length) {
					<span class="hljs-keyword">if</span>(t.is_closed(v)) {
						t._data.search.opn.push(v[<span class="hljs-number">0</span>].id);
						t.open_node(v, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> t._search_open(d); }, <span class="hljs-number">0</span>);
					}
				}
			});
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>helpers</p></div></div><div class="code"><div class="wrapper">	(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>from <a href="http://kiro.me/projects/fuse.html">http://kiro.me/projects/fuse.html</a></p></div></div><div class="code"><div class="wrapper">		$.vakata.search = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(pattern, txt, options)</span> {</span>
			options = options || {};
			<span class="hljs-keyword">if</span>(options.fuzzy !== <span class="hljs-literal">false</span>) {
				options.fuzzy = <span class="hljs-literal">true</span>;
			}
			pattern = options.caseSensitive ? pattern : pattern.toLowerCase();
			<span class="hljs-keyword">var</span> MATCH_LOCATION	= options.location || <span class="hljs-number">0</span>,
				MATCH_DISTANCE	= options.distance || <span class="hljs-number">100</span>,
				MATCH_THRESHOLD	= options.threshold || <span class="hljs-number">0.6</span>,
				patternLen = pattern.length,
				matchmask, pattern_alphabet, match_bitapScore, search;
			<span class="hljs-keyword">if</span>(patternLen &gt; <span class="hljs-number">32</span>) {
				options.fuzzy = <span class="hljs-literal">false</span>;
			}
			<span class="hljs-keyword">if</span>(options.fuzzy) {
				matchmask = <span class="hljs-number">1</span> &lt;&lt; (patternLen - <span class="hljs-number">1</span>);
				pattern_alphabet = (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">var</span> mask = {},
						i = <span class="hljs-number">0</span>;
					<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; patternLen; i++) {
						mask[pattern.charAt(i)] = <span class="hljs-number">0</span>;
					}
					<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; patternLen; i++) {
						mask[pattern.charAt(i)] |= <span class="hljs-number">1</span> &lt;&lt; (patternLen - i - <span class="hljs-number">1</span>);
					}
					<span class="hljs-keyword">return</span> mask;
				}());
				match_bitapScore = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, x)</span> {</span>
					<span class="hljs-keyword">var</span> accuracy = e / patternLen,
						proximity = <span class="hljs-built_in">Math</span>.abs(MATCH_LOCATION - x);
					<span class="hljs-keyword">if</span>(!MATCH_DISTANCE) {
						<span class="hljs-keyword">return</span> proximity ? <span class="hljs-number">1.0</span> : accuracy;
					}
					<span class="hljs-keyword">return</span> accuracy + (proximity / MATCH_DISTANCE);
				};
			}
			search = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(text)</span> {</span>
				text = options.caseSensitive ? text : text.toLowerCase();
				<span class="hljs-keyword">if</span>(pattern === text || text.indexOf(pattern) !== -<span class="hljs-number">1</span>) {
					<span class="hljs-keyword">return</span> {
						isMatch: <span class="hljs-literal">true</span>,
						score: <span class="hljs-number">0</span>
					};
				}
				<span class="hljs-keyword">if</span>(!options.fuzzy) {
					<span class="hljs-keyword">return</span> {
						isMatch: <span class="hljs-literal">false</span>,
						score: <span class="hljs-number">1</span>
					};
				}
				<span class="hljs-keyword">var</span> i, j,
					textLen = text.length,
					scoreThreshold = MATCH_THRESHOLD,
					bestLoc = text.indexOf(pattern, MATCH_LOCATION),
					binMin, binMid,
					binMax = patternLen + textLen,
					lastRd, start, finish, rd, charMatch,
					score = <span class="hljs-number">1</span>,
					locations = [];
				<span class="hljs-keyword">if</span> (bestLoc !== -<span class="hljs-number">1</span>) {
					scoreThreshold = <span class="hljs-built_in">Math</span>.min(match_bitapScore(<span class="hljs-number">0</span>, bestLoc), scoreThreshold);
					bestLoc = text.lastIndexOf(pattern, MATCH_LOCATION + patternLen);
					<span class="hljs-keyword">if</span> (bestLoc !== -<span class="hljs-number">1</span>) {
						scoreThreshold = <span class="hljs-built_in">Math</span>.min(match_bitapScore(<span class="hljs-number">0</span>, bestLoc), scoreThreshold);
					}
				}
				bestLoc = -<span class="hljs-number">1</span>;
				<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; patternLen; i++) {
					binMin = <span class="hljs-number">0</span>;
					binMid = binMax;
					<span class="hljs-keyword">while</span> (binMin &lt; binMid) {
						<span class="hljs-keyword">if</span> (match_bitapScore(i, MATCH_LOCATION + binMid) &lt;= scoreThreshold) {
							binMin = binMid;
						} <span class="hljs-keyword">else</span> {
							binMax = binMid;
						}
						binMid = <span class="hljs-built_in">Math</span>.floor((binMax - binMin) / <span class="hljs-number">2</span> + binMin);
					}
					binMax = binMid;
					start = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">1</span>, MATCH_LOCATION - binMid + <span class="hljs-number">1</span>);
					finish = <span class="hljs-built_in">Math</span>.min(MATCH_LOCATION + binMid, textLen) + patternLen;
					rd = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(finish + <span class="hljs-number">2</span>);
					rd[finish + <span class="hljs-number">1</span>] = (<span class="hljs-number">1</span> &lt;&lt; i) - <span class="hljs-number">1</span>;
					<span class="hljs-keyword">for</span> (j = finish; j &gt;= start; j--) {
						charMatch = pattern_alphabet[text.charAt(j - <span class="hljs-number">1</span>)];
						<span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) {
							rd[j] = ((rd[j + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-number">1</span>) &amp; charMatch;
						} <span class="hljs-keyword">else</span> {
							rd[j] = ((rd[j + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-number">1</span>) &amp; charMatch | (((lastRd[j + <span class="hljs-number">1</span>] | lastRd[j]) &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-number">1</span>) | lastRd[j + <span class="hljs-number">1</span>];
						}
						<span class="hljs-keyword">if</span> (rd[j] &amp; matchmask) {
							score = match_bitapScore(i, j - <span class="hljs-number">1</span>);
							<span class="hljs-keyword">if</span> (score &lt;= scoreThreshold) {
								scoreThreshold = score;
								bestLoc = j - <span class="hljs-number">1</span>;
								locations.push(bestLoc);
								<span class="hljs-keyword">if</span> (bestLoc &gt; MATCH_LOCATION) {
									start = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">1</span>, <span class="hljs-number">2</span> * MATCH_LOCATION - bestLoc);
								} <span class="hljs-keyword">else</span> {
									<span class="hljs-keyword">break</span>;
								}
							}
						}
					}
					<span class="hljs-keyword">if</span> (match_bitapScore(i + <span class="hljs-number">1</span>, MATCH_LOCATION) &gt; scoreThreshold) {
						<span class="hljs-keyword">break</span>;
					}
					lastRd = rd;
				}
				<span class="hljs-keyword">return</span> {
					isMatch: bestLoc &gt;= <span class="hljs-number">0</span>,
					score: score
				};
			};
			<span class="hljs-keyword">return</span> txt === <span class="hljs-literal">true</span> ? { <span class="hljs-string">'search'</span> : search } : search(txt);
		};
	}($));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the search plugin by default
$.jstree.defaults.plugins.push(&quot;search&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="sort-plugin">Sort plugin</h3>
<p>Autmatically sorts all siblings in the tree according to a sorting function.</p></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.sort and plugin sort</span></p>
<p>the settings function used to sort the nodes.
It is executed in the tree&#39;s context, accepts two nodes as arguments and should return <code>1</code> or <code>-1</code>.</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.sort = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(a, b)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>return this.get_type(a) === this.get_type(b) ? (this.get_text(a) &gt; this.get_text(b) ? 1 : -1) : this.get_type(a) &gt;= this.get_type(b);</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get_text(a) &gt; <span class="hljs-keyword">this</span>.get_text(b) ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;
	};
	$.jstree.plugins.sort = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);
			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">"model.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.sort(data.parent, <span class="hljs-literal">true</span>);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"rename_node.jstree create_node.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.sort(data.parent || data.node.parent, <span class="hljs-literal">false</span>);
						<span class="hljs-keyword">this</span>.redraw_node(data.parent || data.node.parent, <span class="hljs-literal">true</span>);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"move_node.jstree copy_node.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.sort(data.parent, <span class="hljs-literal">false</span>);
						<span class="hljs-keyword">this</span>.redraw_node(data.parent, <span class="hljs-literal">true</span>);
					}, <span class="hljs-keyword">this</span>));
		};</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private name sort(obj [, deep]), plugin sort, and trigger search.jstree</span></p>
<p>used to sort a node&#39;s children</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node)</p>
</li>
<li><p><strong>deep must be a Boolean.</strong><br/>(if set to <code>true</code> nodes are sorted recursively.)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.sort = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, deep)</span> {</span>
			<span class="hljs-keyword">var</span> i, j;
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(obj &amp;&amp; obj.children &amp;&amp; obj.children.length) {
				obj.children.sort($.proxy(<span class="hljs-keyword">this</span>.settings.sort, <span class="hljs-keyword">this</span>));
				<span class="hljs-keyword">if</span>(deep) {
					<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
						<span class="hljs-keyword">this</span>.sort(obj.children_d[i], <span class="hljs-literal">false</span>);
					}
				}
			}
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the sort plugin by default
$.jstree.defaults.plugins.push(&quot;sort&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="state-plugin">State plugin</h3>
<p>Saves the state of the tree (selected nodes, opened nodes) on the user&#39;s computer using available options (localStorage, cookies, etc)</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">var</span> to = <span class="hljs-literal">false</span>;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.state and plugin state</span></p>
<p>stores all defaults for the state plugin</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.state = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.state.key and plugin state</span></p>
<p>A string for the key to use when saving the current tree (change if using multiple trees in your project). Defaults to <code>jstree</code>.</p></div></div><div class="code"><div class="wrapper">		key		: <span class="hljs-string">'jstree'</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.state.events and plugin state</span></p>
<p>A space separated list of events that trigger a state save. Defaults to <code>changed.jstree open_node.jstree close_node.jstree</code>.</p></div></div><div class="code"><div class="wrapper">		events	: <span class="hljs-string">'changed.jstree open_node.jstree close_node.jstree'</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.state.ttl and plugin state</span></p>
<p>Time in milliseconds after which the state will expire. Defaults to &#39;false&#39; meaning - no expire.</p></div></div><div class="code"><div class="wrapper">		ttl		: <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.state.filter and plugin state</span></p>
<p>A function that will be executed prior to restoring state with one argument - the state object. Can be used to clear unwanted parts of the state.</p></div></div><div class="code"><div class="wrapper">		filter	: <span class="hljs-literal">false</span>
	};
	$.jstree.plugins.state = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);
			<span class="hljs-keyword">var</span> bind = $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
				<span class="hljs-keyword">this</span>.element.on(<span class="hljs-keyword">this</span>.settings.state.events, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
					<span class="hljs-keyword">if</span>(to) { clearTimeout(to); }
					to = setTimeout($.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.save_state(); }, <span class="hljs-keyword">this</span>), <span class="hljs-number">100</span>);
				}, <span class="hljs-keyword">this</span>));
			}, <span class="hljs-keyword">this</span>);
			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">"ready.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.element.one(<span class="hljs-string">"restore_state.jstree"</span>, bind);
						<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.restore_state()) { bind(); }
					}, <span class="hljs-keyword">this</span>));
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name save_state() and plugin state</span></p>
<p>save the state</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.save_state = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> st = { <span class="hljs-string">'state'</span> : <span class="hljs-keyword">this</span>.get_state(), <span class="hljs-string">'ttl'</span> : <span class="hljs-keyword">this</span>.settings.state.ttl, <span class="hljs-string">'sec'</span> : +(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()) };
			$.vakata.storage.set(<span class="hljs-keyword">this</span>.settings.state.key, <span class="hljs-built_in">JSON</span>.stringify(st));
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name restore_state() and plugin state</span></p>
<p>restore the state from the user&#39;s computer</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.restore_state = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">var</span> k = $.vakata.storage.get(<span class="hljs-keyword">this</span>.settings.state.key);
			<span class="hljs-keyword">if</span>(!!k) { <span class="hljs-keyword">try</span> { k = <span class="hljs-built_in">JSON</span>.parse(k); } <span class="hljs-keyword">catch</span>(ex) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; } }
			<span class="hljs-keyword">if</span>(!!k &amp;&amp; k.ttl &amp;&amp; k.sec &amp;&amp; +(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()) - k.sec &gt; k.ttl) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>(!!k &amp;&amp; k.state) { k = k.state; }
			<span class="hljs-keyword">if</span>(!!k &amp;&amp; $.isFunction(<span class="hljs-keyword">this</span>.settings.state.filter)) { k = <span class="hljs-keyword">this</span>.settings.state.filter.call(<span class="hljs-keyword">this</span>, k); }
			<span class="hljs-keyword">if</span>(!!k) {
				<span class="hljs-keyword">this</span>.element.one(<span class="hljs-string">"set_state.jstree"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span> data.instance.trigger(<span class="hljs-string">'restore_state'</span>, { <span class="hljs-string">'state'</span> : $.extend(<span class="hljs-literal">true</span>, {}, k) }); });
				<span class="hljs-keyword">this</span>.set_state(k);
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name clear_state() and plugin state</span></p>
<p>clear the state on the user&#39;s computer</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.clear_state = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">return</span> $.vakata.storage.del(<span class="hljs-keyword">this</span>.settings.state.key);
		};
	};

	(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($, undefined)</span> {</span>
		$.vakata.storage = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>simply specifying the functions in FF throws an error</p></div></div><div class="code"><div class="wrapper">			set : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key, val)</span> {</span> <span class="hljs-keyword">return</span> window.localStorage.setItem(key, val); },
			get : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> {</span> <span class="hljs-keyword">return</span> window.localStorage.getItem(key); },
			del : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> {</span> <span class="hljs-keyword">return</span> window.localStorage.removeItem(key); }
		};
	}($));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the state plugin by default
$.jstree.defaults.plugins.push(&quot;state&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="types-plugin">Types plugin</h3>
<p>Makes it possible to add predefined types for groups of nodes, which make it possible to easily control nesting rules and icon for each group.</p></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.types and plugin types</span></p>
<p>An object storing all types as key value pairs, where the key is the type name and the value is an object that could contain following keys (all optional).</p>
<ul>
<li><code>max_children</code> the maximum number of immediate children this node type can have. Do not specify or set to <code>-1</code> for unlimited.</li>
<li><code>max_depth</code> the maximum number of nesting this node type can have. A value of <code>1</code> would mean that the node can have children, but no grandchildren. Do not specify or set to <code>-1</code> for unlimited.</li>
<li><code>valid_children</code> an array of node type strings, that nodes of this type can have as children. Do not specify or set to <code>-1</code> for no limits.</li>
<li><code>icon</code> a string - can be a path to an icon or a className, if using an image that is in the current directory use a <code>./</code> prefix, otherwise it will be detected as a class. Omit to use the default icon from your theme.</li>
</ul>
<p>There are two predefined types:</p>
<ul>
<li><code>#</code> represents the root of the tree, for example <code>max_children</code> would control the maximum number of root nodes.</li>
<li><code>default</code> represents the default node - any settings here will be applied to all nodes that do not have a type specified.</li>
</ul></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.types = {
		<span class="hljs-string">'#'</span> : {},
		<span class="hljs-string">'default'</span> : {}
	};

	$.jstree.plugins.types = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.init = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(el, options)</span> {</span>
			<span class="hljs-keyword">var</span> i, j;
			<span class="hljs-keyword">if</span>(options &amp;&amp; options.types &amp;&amp; options.types[<span class="hljs-string">'default'</span>]) {
				<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> options.types) {
					<span class="hljs-keyword">if</span>(i !== <span class="hljs-string">"default"</span> &amp;&amp; i !== <span class="hljs-string">"#"</span> &amp;&amp; options.types.hasOwnProperty(i)) {
						<span class="hljs-keyword">for</span>(j <span class="hljs-keyword">in</span> options.types[<span class="hljs-string">'default'</span>]) {
							<span class="hljs-keyword">if</span>(options.types[<span class="hljs-string">'default'</span>].hasOwnProperty(j) &amp;&amp; options.types[i][j] === <span class="hljs-literal">undefined</span>) {
								options.types[i][j] = options.types[<span class="hljs-string">'default'</span>][j];
							}
						}
					}
				}
			}
			parent.init.call(<span class="hljs-keyword">this</span>, el, options);
			<span class="hljs-keyword">this</span>._model.data[<span class="hljs-string">'#'</span>].type = <span class="hljs-string">'#'</span>;
		};
		<span class="hljs-keyword">this</span>.refresh = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(skip_loading)</span> {</span>
			parent.refresh.call(<span class="hljs-keyword">this</span>, skip_loading);
			<span class="hljs-keyword">this</span>._model.data[<span class="hljs-string">'#'</span>].type = <span class="hljs-string">'#'</span>;
		};
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">'model.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">var</span> m = <span class="hljs-keyword">this</span>._model.data,
							dpc = data.nodes,
							t = <span class="hljs-keyword">this</span>.settings.types,
							i, j, c = <span class="hljs-string">'default'</span>;
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = dpc.length; i &lt; j; i++) {
							c = <span class="hljs-string">'default'</span>;
							<span class="hljs-keyword">if</span>(m[dpc[i]].original &amp;&amp; m[dpc[i]].original.type &amp;&amp; t[m[dpc[i]].original.type]) {
								c = m[dpc[i]].original.type;
							}
							<span class="hljs-keyword">if</span>(m[dpc[i]].data &amp;&amp; m[dpc[i]].data.jstree &amp;&amp; m[dpc[i]].data.jstree.type &amp;&amp; t[m[dpc[i]].data.jstree.type]) {
								c = m[dpc[i]].data.jstree.type;
							}
							m[dpc[i]].type = c;
							<span class="hljs-keyword">if</span>(m[dpc[i]].icon === <span class="hljs-literal">true</span> &amp;&amp; t[c].icon !== <span class="hljs-literal">undefined</span>) {
								m[dpc[i]].icon = t[c].icon;
							}
						}
						m[<span class="hljs-string">'#'</span>].type = <span class="hljs-string">'#'</span>;
					}, <span class="hljs-keyword">this</span>));
			parent.bind.call(<span class="hljs-keyword">this</span>);
		};
		<span class="hljs-keyword">this</span>.get_json = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, options, flat)</span> {</span>
			<span class="hljs-keyword">var</span> i, j,
				m = <span class="hljs-keyword">this</span>._model.data,
				opt = options ? $.extend(<span class="hljs-literal">true</span>, {}, options, {no_id:<span class="hljs-literal">false</span>}) : {},
				tmp = parent.get_json.call(<span class="hljs-keyword">this</span>, obj, opt, flat);
			<span class="hljs-keyword">if</span>(tmp === <span class="hljs-literal">false</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">if</span>($.isArray(tmp)) {
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
					tmp[i].type = tmp[i].id &amp;&amp; m[tmp[i].id] &amp;&amp; m[tmp[i].id].type ? m[tmp[i].id].type : <span class="hljs-string">"default"</span>;
					<span class="hljs-keyword">if</span>(options &amp;&amp; options.no_id) {
						<span class="hljs-keyword">delete</span> tmp[i].id;
						<span class="hljs-keyword">if</span>(tmp[i].li_attr &amp;&amp; tmp[i].li_attr.id) {
							<span class="hljs-keyword">delete</span> tmp[i].li_attr.id;
						}
					}
				}
			}
			<span class="hljs-keyword">else</span> {
				tmp.type = tmp.id &amp;&amp; m[tmp.id] &amp;&amp; m[tmp.id].type ? m[tmp.id].type : <span class="hljs-string">"default"</span>;
				<span class="hljs-keyword">if</span>(options &amp;&amp; options.no_id) {
					tmp = <span class="hljs-keyword">this</span>._delete_ids(tmp);
				}
			}
			<span class="hljs-keyword">return</span> tmp;
		};
		<span class="hljs-keyword">this</span>._delete_ids = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(tmp)</span> {</span>
			<span class="hljs-keyword">if</span>($.isArray(tmp)) {
				<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = tmp.length; i &lt; j; i++) {
					tmp[i] = <span class="hljs-keyword">this</span>._delete_ids(tmp[i]);
				}
				<span class="hljs-keyword">return</span> tmp;
			}
			<span class="hljs-keyword">delete</span> tmp.id;
			<span class="hljs-keyword">if</span>(tmp.li_attr &amp;&amp; tmp.li_attr.id) {
				<span class="hljs-keyword">delete</span> tmp.li_attr.id;
			}
			<span class="hljs-keyword">if</span>(tmp.children &amp;&amp; $.isArray(tmp.children)) {
				tmp.children = <span class="hljs-keyword">this</span>._delete_ids(tmp.children);
			}
			<span class="hljs-keyword">return</span> tmp;
		};
		<span class="hljs-keyword">this</span>.check = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(chk, obj, par, pos, more)</span> {</span>
			<span class="hljs-keyword">if</span>(parent.check.call(<span class="hljs-keyword">this</span>, chk, obj, par, pos, more) === <span class="hljs-literal">false</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			obj = obj &amp;&amp; obj.id ? obj : <span class="hljs-keyword">this</span>.get_node(obj);
			par = par &amp;&amp; par.id ? par : <span class="hljs-keyword">this</span>.get_node(par);
			<span class="hljs-keyword">var</span> m = obj &amp;&amp; obj.id ? $.jstree.reference(obj.id) : <span class="hljs-literal">null</span>, tmp, d, i, j;
			m = m &amp;&amp; m._model &amp;&amp; m._model.data ? m._model.data : <span class="hljs-literal">null</span>;
			<span class="hljs-keyword">switch</span>(chk) {
				<span class="hljs-keyword">case</span> <span class="hljs-string">"create_node"</span>:
				<span class="hljs-keyword">case</span> <span class="hljs-string">"move_node"</span>:
				<span class="hljs-keyword">case</span> <span class="hljs-string">"copy_node"</span>:
					<span class="hljs-keyword">if</span>(chk !== <span class="hljs-string">'move_node'</span> || $.inArray(obj.id, par.children) === -<span class="hljs-number">1</span>) {
						tmp = <span class="hljs-keyword">this</span>.get_rules(par);
						<span class="hljs-keyword">if</span>(tmp.max_children !== <span class="hljs-literal">undefined</span> &amp;&amp; tmp.max_children !== -<span class="hljs-number">1</span> &amp;&amp; tmp.max_children === par.children.length) {
							<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'types'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'types_01'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'max_children prevents function: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
							<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
						}
						<span class="hljs-keyword">if</span>(tmp.valid_children !== <span class="hljs-literal">undefined</span> &amp;&amp; tmp.valid_children !== -<span class="hljs-number">1</span> &amp;&amp; $.inArray(obj.type, tmp.valid_children) === -<span class="hljs-number">1</span>) {
							<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'types'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'types_02'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'valid_children prevents function: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
							<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
						}
						<span class="hljs-keyword">if</span>(m &amp;&amp; obj.children_d &amp;&amp; obj.parents) {
							d = <span class="hljs-number">0</span>;
							<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = obj.children_d.length; i &lt; j; i++) {
								d = <span class="hljs-built_in">Math</span>.max(d, m[obj.children_d[i]].parents.length);
							}
							d = d - obj.parents.length + <span class="hljs-number">1</span>;
						}
						<span class="hljs-keyword">if</span>(d &lt;= <span class="hljs-number">0</span> || d === <span class="hljs-literal">undefined</span>) { d = <span class="hljs-number">1</span>; }
						<span class="hljs-keyword">do</span> {
							<span class="hljs-keyword">if</span>(tmp.max_depth !== <span class="hljs-literal">undefined</span> &amp;&amp; tmp.max_depth !== -<span class="hljs-number">1</span> &amp;&amp; tmp.max_depth &lt; d) {
								<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'types'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'types_03'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'max_depth prevents function: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
								<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
							}
							par = <span class="hljs-keyword">this</span>.get_node(par.parent);
							tmp = <span class="hljs-keyword">this</span>.get_rules(par);
							d++;
						} <span class="hljs-keyword">while</span>(par);
					}
					<span class="hljs-keyword">break</span>;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_rules(obj) and plugin types</span></p>
<p>used to retrieve the type settings object for a node</p>
<p>Parameters:</p>
<ul>
<li><strong>obj must be a mixed.</strong><br/>(the node to find the rules for)</li>
</ul>
<p><strong>Returns an Object</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.get_rules = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			<span class="hljs-keyword">var</span> tmp = <span class="hljs-keyword">this</span>.get_type(obj, <span class="hljs-literal">true</span>);
			<span class="hljs-keyword">if</span>(tmp.max_depth === <span class="hljs-literal">undefined</span>) { tmp.max_depth = -<span class="hljs-number">1</span>; }
			<span class="hljs-keyword">if</span>(tmp.max_children === <span class="hljs-literal">undefined</span>) { tmp.max_children = -<span class="hljs-number">1</span>; }
			<span class="hljs-keyword">if</span>(tmp.valid_children === <span class="hljs-literal">undefined</span>) { tmp.valid_children = -<span class="hljs-number">1</span>; }
			<span class="hljs-keyword">return</span> tmp;
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name get_type(obj [, rules]) and plugin types</span></p>
<p>used to retrieve the type string or settings object for a node</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to find the rules for)</p>
</li>
<li><p><strong>rules must be a Boolean.</strong><br/>(if set to <code>true</code> instead of a string the settings object will be returned)</p>
</li>
</ul>
<p><strong>Returns a String or an Object</strong></p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.get_type = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, rules)</span> {</span>
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">return</span> (!obj) ? <span class="hljs-literal">false</span> : ( rules ? $.extend({ <span class="hljs-string">'type'</span> : obj.type }, <span class="hljs-keyword">this</span>.settings.types[obj.type]) : obj.type);
		};</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name set_type(obj, type) and plugin types</span></p>
<p>used to change a node&#39;s type</p>
<p>Parameters:</p>
<ul>
<li><p><strong>obj must be a mixed.</strong><br/>(the node to change)</p>
</li>
<li><p><strong>type must be a String.</strong><br/>(the new type)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">this</span>.set_type = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, type)</span> {</span>
			<span class="hljs-keyword">var</span> t, t1, t2, old_type, old_icon;
			<span class="hljs-keyword">if</span>($.isArray(obj)) {
				obj = obj.slice();
				<span class="hljs-keyword">for</span>(t1 = <span class="hljs-number">0</span>, t2 = obj.length; t1 &lt; t2; t1++) {
					<span class="hljs-keyword">this</span>.set_type(obj[t1], type);
				}
				<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
			}
			t = <span class="hljs-keyword">this</span>.settings.types;
			obj = <span class="hljs-keyword">this</span>.get_node(obj);
			<span class="hljs-keyword">if</span>(!t[type] || !obj) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			old_type = obj.type;
			old_icon = <span class="hljs-keyword">this</span>.get_icon(obj);
			obj.type = type;
			<span class="hljs-keyword">if</span>(old_icon === <span class="hljs-literal">true</span> || (t[old_type] &amp;&amp; t[old_type].icon &amp;&amp; old_icon === t[old_type].icon)) {
				<span class="hljs-keyword">this</span>.set_icon(obj, t[type].icon !== <span class="hljs-literal">undefined</span> ? t[type].icon : <span class="hljs-literal">true</span>);
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the types plugin by default
$.jstree.defaults.plugins.push(&quot;types&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="unique-plugin">Unique plugin</h3>
<p>Enforces that no nodes with the same name can coexist as siblings.</p></div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.unique and plugin unique</span></p>
<p>stores all defaults for the unique plugin</p></div></div><div class="code"><div class="wrapper">	$.jstree.defaults.unique = {</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.unique.case_sensitive and plugin unique</span></p>
<p>Indicates if the comparison should be case sensitive. Default is <code>false</code>.</p></div></div><div class="code"><div class="wrapper">		case_sensitive : <span class="hljs-literal">false</span>,</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'> name $.jstree.defaults.unique.duplicate and plugin unique</span></p>
<p>A callback executed in the instance&#39;s scope when a new node is created and the name is already taken, the two arguments are the conflicting name and the counter. The default will produce results like <code>New node (2)</code>.</p></div></div><div class="code"><div class="wrapper">		duplicate : <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(name, counter)</span> {</span>
			<span class="hljs-keyword">return</span> name + <span class="hljs-string">' ('</span> + counter + <span class="hljs-string">')'</span>;
		}
	};

	$.jstree.plugins.unique = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.check = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(chk, obj, par, pos, more)</span> {</span>
			<span class="hljs-keyword">if</span>(parent.check.call(<span class="hljs-keyword">this</span>, chk, obj, par, pos, more) === <span class="hljs-literal">false</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
			obj = obj &amp;&amp; obj.id ? obj : <span class="hljs-keyword">this</span>.get_node(obj);
			par = par &amp;&amp; par.id ? par : <span class="hljs-keyword">this</span>.get_node(par);
			<span class="hljs-keyword">if</span>(!par || !par.children) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
			<span class="hljs-keyword">var</span> n = chk === <span class="hljs-string">"rename_node"</span> ? pos : obj.text,
				c = [],
				s = <span class="hljs-keyword">this</span>.settings.unique.case_sensitive,
				m = <span class="hljs-keyword">this</span>._model.data, i, j;
			<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = par.children.length; i &lt; j; i++) {
				c.push(s ? m[par.children[i]].text : m[par.children[i]].text.toLowerCase());
			}
			<span class="hljs-keyword">if</span>(!s) { n = n.toLowerCase(); }
			<span class="hljs-keyword">switch</span>(chk) {
				<span class="hljs-keyword">case</span> <span class="hljs-string">"delete_node"</span>:
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"rename_node"</span>:
					i = ($.inArray(n, c) === -<span class="hljs-number">1</span> || (obj.text &amp;&amp; obj.text[ s ? <span class="hljs-string">'toString'</span> : <span class="hljs-string">'toLowerCase'</span>]() === n));
					<span class="hljs-keyword">if</span>(!i) {
						<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'unique'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'unique_01'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Child with name '</span> + n + <span class="hljs-string">' already exists. Preventing: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
					}
					<span class="hljs-keyword">return</span> i;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"create_node"</span>:
					i = ($.inArray(n, c) === -<span class="hljs-number">1</span>);
					<span class="hljs-keyword">if</span>(!i) {
						<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'unique'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'unique_04'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Child with name '</span> + n + <span class="hljs-string">' already exists. Preventing: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
					}
					<span class="hljs-keyword">return</span> i;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"copy_node"</span>:
					i = ($.inArray(n, c) === -<span class="hljs-number">1</span>);
					<span class="hljs-keyword">if</span>(!i) {
						<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'unique'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'unique_02'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Child with name '</span> + n + <span class="hljs-string">' already exists. Preventing: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
					}
					<span class="hljs-keyword">return</span> i;
				<span class="hljs-keyword">case</span> <span class="hljs-string">"move_node"</span>:
					i = (obj.parent === par.id || $.inArray(n, c) === -<span class="hljs-number">1</span>);
					<span class="hljs-keyword">if</span>(!i) {
						<span class="hljs-keyword">this</span>._data.core.last_error = { <span class="hljs-string">'error'</span> : <span class="hljs-string">'check'</span>, <span class="hljs-string">'plugin'</span> : <span class="hljs-string">'unique'</span>, <span class="hljs-string">'id'</span> : <span class="hljs-string">'unique_03'</span>, <span class="hljs-string">'reason'</span> : <span class="hljs-string">'Child with name '</span> + n + <span class="hljs-string">' already exists. Preventing: '</span> + chk, <span class="hljs-string">'data'</span> : <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-string">'chk'</span> : chk, <span class="hljs-string">'pos'</span> : pos, <span class="hljs-string">'obj'</span> : obj &amp;&amp; obj.id ? obj.id : <span class="hljs-literal">false</span>, <span class="hljs-string">'par'</span> : par &amp;&amp; par.id ? par.id : <span class="hljs-literal">false</span> }) };
					}
					<span class="hljs-keyword">return</span> i;
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
		};
		<span class="hljs-keyword">this</span>.create_node = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(par, node, pos, callback, is_loaded)</span> {</span>
			<span class="hljs-keyword">if</span>(!node || node.text === <span class="hljs-literal">undefined</span>) {
				<span class="hljs-keyword">if</span>(par === <span class="hljs-literal">null</span>) {
					par = <span class="hljs-string">"#"</span>;
				}
				par = <span class="hljs-keyword">this</span>.get_node(par);
				<span class="hljs-keyword">if</span>(!par) {
					<span class="hljs-keyword">return</span> parent.create_node.call(<span class="hljs-keyword">this</span>, par, node, pos, callback, is_loaded);
				}
				pos = pos === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">"last"</span> : pos;
				<span class="hljs-keyword">if</span>(!pos.toString().match(<span class="hljs-regexp">/^(before|after)$/</span>) &amp;&amp; !is_loaded &amp;&amp; !<span class="hljs-keyword">this</span>.is_loaded(par)) {
					<span class="hljs-keyword">return</span> parent.create_node.call(<span class="hljs-keyword">this</span>, par, node, pos, callback, is_loaded);
				}
				<span class="hljs-keyword">if</span>(!node) { node = {}; }
				<span class="hljs-keyword">var</span> tmp, n, dpc, i, j, m = <span class="hljs-keyword">this</span>._model.data, s = <span class="hljs-keyword">this</span>.settings.unique.case_sensitive, cb = <span class="hljs-keyword">this</span>.settings.unique.duplicate;
				n = tmp = <span class="hljs-keyword">this</span>.get_string(<span class="hljs-string">'New node'</span>);
				dpc = [];
				<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = par.children.length; i &lt; j; i++) {
					dpc.push(s ? m[par.children[i]].text : m[par.children[i]].text.toLowerCase());
				}
				i = <span class="hljs-number">1</span>;
				<span class="hljs-keyword">while</span>($.inArray(s ? n : n.toLowerCase(), dpc) !== -<span class="hljs-number">1</span>) {
					n = cb.call(<span class="hljs-keyword">this</span>, tmp, (++i)).toString();
				}
				node.text = n;
			}
			<span class="hljs-keyword">return</span> parent.create_node.call(<span class="hljs-keyword">this</span>, par, node, pos, callback, is_loaded);
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the unique plugin by default
$.jstree.defaults.plugins.push(&quot;unique&quot;);</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="wholerow-plugin">Wholerow plugin</h3>
<p>Makes each node appear block level. Making selection easier. May cause slow down for large trees in old browsers.</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">var</span> div = document.createElement(<span class="hljs-string">'DIV'</span>);
	div.setAttribute(<span class="hljs-string">'unselectable'</span>,<span class="hljs-string">'on'</span>);
	div.className = <span class="hljs-string">'jstree-wholerow'</span>;
	div.innerHTML = <span class="hljs-string">'&amp;#160;'</span>;
	$.jstree.plugins.wholerow = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options, parent)</span> {</span>
		<span class="hljs-keyword">this</span>.bind = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			parent.bind.call(<span class="hljs-keyword">this</span>);

			<span class="hljs-keyword">this</span>.element
				.on(<span class="hljs-string">'ready.jstree set_state.jstree'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
						<span class="hljs-keyword">this</span>.hide_dots();
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"init.jstree loading.jstree ready.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>div.style.height = this._data.core.li_height + &#39;px&#39;;</p></div></div><div class="code"><div class="wrapper">						<span class="hljs-keyword">this</span>.get_container_ul().addClass(<span class="hljs-string">'jstree-wholerow-ul'</span>);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"deselect_all.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-wholerow-clicked'</span>).removeClass(<span class="hljs-string">'jstree-wholerow-clicked'</span>);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"changed.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">'.jstree-wholerow-clicked'</span>).removeClass(<span class="hljs-string">'jstree-wholerow-clicked'</span>);
						<span class="hljs-keyword">var</span> tmp = <span class="hljs-literal">false</span>, i, j;
						<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = data.selected.length; i &lt; j; i++) {
							tmp = <span class="hljs-keyword">this</span>.get_node(data.selected[i], <span class="hljs-literal">true</span>);
							<span class="hljs-keyword">if</span>(tmp &amp;&amp; tmp.length) {
								tmp.children(<span class="hljs-string">'.jstree-wholerow'</span>).addClass(<span class="hljs-string">'jstree-wholerow-clicked'</span>);
							}
						}
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"open_node.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.get_node(data.node, <span class="hljs-literal">true</span>).find(<span class="hljs-string">'.jstree-clicked'</span>).parent().children(<span class="hljs-string">'.jstree-wholerow'</span>).addClass(<span class="hljs-string">'jstree-wholerow-clicked'</span>);
					}, <span class="hljs-keyword">this</span>))
	 			.on(<span class="hljs-string">"hover_node.jstree dehover_node.jstree"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, data)</span> {</span>
						<span class="hljs-keyword">this</span>.get_node(data.node, <span class="hljs-literal">true</span>).children(<span class="hljs-string">'.jstree-wholerow'</span>)[e.type === <span class="hljs-string">"hover_node"</span>?<span class="hljs-string">"addClass"</span>:<span class="hljs-string">"removeClass"</span>](<span class="hljs-string">'jstree-wholerow-hovered'</span>);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"contextmenu.jstree"</span>, <span class="hljs-string">".jstree-wholerow"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
		 				e.preventDefault();
						<span class="hljs-keyword">var</span> tmp = $.Event(<span class="hljs-string">'contextmenu'</span>, { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey, pageX : e.pageX, pageY : e.pageY });
						$(e.currentTarget).closest(<span class="hljs-string">".jstree-node"</span>).children(<span class="hljs-string">".jstree-anchor:eq(0)"</span>).trigger(tmp);
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"click.jstree"</span>, <span class="hljs-string">".jstree-wholerow"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						e.stopImmediatePropagation();
						<span class="hljs-keyword">var</span> tmp = $.Event(<span class="hljs-string">'click'</span>, { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });
						$(e.currentTarget).closest(<span class="hljs-string">".jstree-node"</span>).children(<span class="hljs-string">".jstree-anchor:eq(0)"</span>).trigger(tmp).focus();
					})
				.on(<span class="hljs-string">"click.jstree"</span>, <span class="hljs-string">".jstree-leaf &gt; .jstree-ocl"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						e.stopImmediatePropagation();
						<span class="hljs-keyword">var</span> tmp = $.Event(<span class="hljs-string">'click'</span>, { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });
						$(e.currentTarget).closest(<span class="hljs-string">".jstree-node"</span>).children(<span class="hljs-string">".jstree-anchor:eq(0)"</span>).trigger(tmp).focus();
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"mouseover.jstree"</span>, <span class="hljs-string">".jstree-wholerow, .jstree-icon"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						e.stopImmediatePropagation();
						<span class="hljs-keyword">this</span>.hover_node(e.currentTarget);
						<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
					}, <span class="hljs-keyword">this</span>))
				.on(<span class="hljs-string">"mouseleave.jstree"</span>, <span class="hljs-string">".jstree-node"</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> {</span>
						<span class="hljs-keyword">this</span>.dehover_node(e.currentTarget);
					}, <span class="hljs-keyword">this</span>));
		};
		<span class="hljs-keyword">this</span>.teardown = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.settings.wholerow) {
				<span class="hljs-keyword">this</span>.element.find(<span class="hljs-string">".jstree-wholerow"</span>).remove();
			}
			parent.teardown.call(<span class="hljs-keyword">this</span>);
		};
		<span class="hljs-keyword">this</span>.redraw_node = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, deep, callback)</span> {</span>
			obj = parent.redraw_node.call(<span class="hljs-keyword">this</span>, obj, deep, callback);
			<span class="hljs-keyword">if</span>(obj) {
				<span class="hljs-keyword">var</span> tmp = div.cloneNode(<span class="hljs-literal">true</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>tmp.style.height = this._data.core.li_height + &#39;px&#39;;</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span>($.inArray(obj.id, <span class="hljs-keyword">this</span>._data.core.selected) !== -<span class="hljs-number">1</span>) { tmp.className += <span class="hljs-string">' jstree-wholerow-clicked'</span>; }
				obj.insertBefore(tmp, obj.childNodes[<span class="hljs-number">0</span>]);
			}
			<span class="hljs-keyword">return</span> obj;
		};
	};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>include the wholerow plugin by default
$.jstree.defaults.plugins.push(&quot;wholerow&quot;);</p></div></div><div class="code"><div class="wrapper">}));</div></div></div></div></body></html>